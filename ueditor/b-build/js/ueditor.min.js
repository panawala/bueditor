UEDITOR_CONFIG=window.UEDITOR_CONFIG||{};var baidu=window.baidu||{};window.baidu=baidu,window.UE=baidu.editor=window.UE||{},UE.plugins={},UE.commands={},UE.instants={},UE.I18N={},UE._customizeUI={},UE.version="1.4.3";var dom=UE.dom={};
var browser=UE.browser=function(){var e=navigator.userAgent.toLowerCase(),o=window.opera,t={ie:/(msie\s|trident.*rv:)([\w.]+)/.test(e),opera:!!o&&o.version,webkit:e.indexOf(" applewebkit/")>-1,mac:e.indexOf("macintosh")>-1,quirks:"BackCompat"==document.compatMode};t.gecko="Gecko"==navigator.product&&!t.webkit&&!t.opera&&!t.ie;var i=0;if(t.ie){var r=e.match(/(?:msie\s([\w.]+))/),a=e.match(/(?:trident.*rv:([\w.]+))/);i=r&&a&&r[1]&&a[1]?Math.max(1*r[1],1*a[1]):r&&r[1]?1*r[1]:a&&a[1]?1*a[1]:0,t.ie11Compat=11==document.documentMode,t.ie9Compat=9==document.documentMode,t.ie8=!!document.documentMode,t.ie8Compat=8==document.documentMode,t.ie7Compat=7==i&&!document.documentMode||7==document.documentMode,t.ie6Compat=7>i||t.quirks,t.ie9above=i>8,t.ie9below=9>i,t.ie11above=i>10,t.ie11below=11>i}if(t.gecko){var d=e.match(/rv:([\d\.]+)/);d&&(d=d[1].split("."),i=1e4*d[0]+100*(d[1]||0)+1*(d[2]||0))}return/chrome\/(\d+\.\d)/i.test(e)&&(t.chrome=+RegExp.$1),/(\d+\.\d)?(?:\.\d)?\s+safari\/?(\d+\.\d+)?/i.test(e)&&!/chrome/i.test(e)&&(t.safari=+(RegExp.$1||RegExp.$2)),t.opera&&(i=parseFloat(o.version())),t.webkit&&(i=parseFloat(e.match(/ applewebkit\/(\d+)/)[1])),t.version=i,t.isCompatible=!t.mobile&&(t.ie&&i>=6||t.gecko&&i>=10801||t.opera&&i>=9.5||t.air&&i>=1||t.webkit&&i>=522||!1),t}(),ie=browser.ie,webkit=browser.webkit,gecko=browser.gecko,opera=browser.opera;
var utils=UE.utils={each:function(e,t,n){if(null!=e)if(e.length===+e.length){for(var r=0,o=e.length;o>r;r++)if(t.call(n,e[r],r,e)===!1)return!1}else for(var i in e)if(e.hasOwnProperty(i)&&t.call(n,e[i],i,e)===!1)return!1},makeInstance:function(e){var t=new Function;return t.prototype=e,e=new t,t.prototype=null,e},extend:function(e,t,n){if(t)for(var r in t)n&&e.hasOwnProperty(r)||(e[r]=t[r]);return e},extend2:function(e){for(var t=arguments,n=1;n<t.length;n++){var r=t[n];for(var o in r)e.hasOwnProperty(o)||(e[o]=r[o])}return e},inherits:function(e,t){var n=e.prototype,r=utils.makeInstance(t.prototype);return utils.extend(r,n,!0),e.prototype=r,r.constructor=e},bind:function(e,t){return function(){return e.apply(t,arguments)}},defer:function(e,t,n){var r;return function(){n&&clearTimeout(r),r=setTimeout(e,t)}},indexOf:function(e,t,n){var r=-1;return n=this.isNumber(n)?n:0,this.each(e,function(e,o){return o>=n&&e===t?(r=o,!1):void 0}),r},removeItem:function(e,t){for(var n=0,r=e.length;r>n;n++)e[n]===t&&(e.splice(n,1),n--)},trim:function(e){return e.replace(/(^[ \t\n\r]+)|([ \t\n\r]+$)/g,"")},listToMap:function(e){if(!e)return{};e=utils.isArray(e)?e:e.split(",");for(var t,n=0,r={};t=e[n++];)r[t.toUpperCase()]=r[t]=1;return r},unhtml:function(e,t){return e?e.replace(t||/[&<">'](?:(amp|lt|quot|gt|#39|nbsp|#\d+);)?/g,function(e,t){return t?e:{"<":"&lt;","&":"&amp;",'"':"&quot;",">":"&gt;","'":"&#39;"}[e]}):""},html:function(e){return e?e.replace(/&((g|l|quo)t|amp|#39|nbsp);/g,function(e){return{"&lt;":"<","&amp;":"&","&quot;":'"',"&gt;":">","&#39;":"'","&nbsp;":" "}[e]}):""},cssStyleToDomStyle:function(){var e=document.createElement("div").style,t={"float":void 0!=e.cssFloat?"cssFloat":void 0!=e.styleFloat?"styleFloat":"float"};return function(e){return t[e]||(t[e]=e.toLowerCase().replace(/-./g,function(e){return e.charAt(1).toUpperCase()}))}}(),loadFile:function(){function e(e,n){try{for(var r,o=0;r=t[o++];)if(r.doc===e&&r.url==(n.src||n.href))return r}catch(i){return null}}var t=[];return function(n,r,o){var i=e(n,r);if(i)return void(i.ready?o&&o():i.funs.push(o));if(t.push({doc:n,url:r.src||r.href,funs:[o]}),!n.body){var a=[];for(var u in r)"tag"!=u&&a.push(u+'="'+r[u]+'"');return void n.write("<"+r.tag+" "+a.join(" ")+" ></"+r.tag+">")}if(!r.id||!n.getElementById(r.id)){var s=n.createElement(r.tag);delete r.tag;for(var u in r)s.setAttribute(u,r[u]);s.onload=s.onreadystatechange=function(){if(!this.readyState||/loaded|complete/.test(this.readyState)){if(i=e(n,r),i.funs.length>0){i.ready=1;for(var t;t=i.funs.pop();)t()}s.onload=s.onreadystatechange=null}},s.onerror=function(){throw Error("The load "+(r.href||r.src)+" fails,check the url settings of file ueditor.config.js ")},n.getElementsByTagName("head")[0].appendChild(s)}}}(),isEmptyObject:function(e){if(null==e)return!0;if(this.isArray(e)||this.isString(e))return 0===e.length;for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},fixColor:function(e,t){if(/color/i.test(e)&&/rgba?/.test(t)){var n=t.split(",");if(n.length>3)return"";t="#";for(var r,o=0;r=n[o++];)r=parseInt(r.replace(/[^\d]/gi,""),10).toString(16),t+=1==r.length?"0"+r:r;t=t.toUpperCase()}return t},optCss:function(e){function t(e,t){if(!e)return"";var n=e.top,r=e.bottom,o=e.left,i=e.right,a="";if(n&&o&&r&&i)a+=";"+t+":"+(n==r&&r==o&&o==i?n:n==r&&o==i?n+" "+o:o==i?n+" "+o+" "+r:n+" "+i+" "+r+" "+o)+";";else for(var u in e)a+=";"+t+"-"+u+":"+e[u]+";";return a}var n,r;return e=e.replace(/(padding|margin|border)\-([^:]+):([^;]+);?/gi,function(e,t,o,i){if(1==i.split(" ").length)switch(t){case"padding":return!n&&(n={}),n[o]=i,"";case"margin":return!r&&(r={}),r[o]=i,"";case"border":return"initial"==i?"":e}return e}),e+=t(n,"padding")+t(r,"margin"),e.replace(/^[ \n\r\t;]*|[ \n\r\t]*$/,"").replace(/;([ \n\r\t]+)|\1;/g,";").replace(/(&((l|g)t|quot|#39))?;{2,}/g,function(e,t){return t?t+";;":";"})},clone:function(e,t){var n;t=t||{};for(var r in e)e.hasOwnProperty(r)&&(n=e[r],"object"==typeof n?(t[r]=utils.isArray(n)?[]:{},utils.clone(e[r],t[r])):t[r]=n);return t},transUnitToPx:function(e){if(!/(pt|cm)/.test(e))return e;var t;switch(e.replace(/([\d.]+)(\w+)/,function(n,r,o){e=r,t=o}),t){case"cm":e=25*parseFloat(e);break;case"pt":e=Math.round(96*parseFloat(e)/72)}return e+(e?"px":"")},domReady:function(){function e(e){e.isReady=!0;for(var n;n=t.pop();n());}var t=[];return function(n,r){r=r||window;var o=r.document;n&&t.push(n),"complete"===o.readyState?e(o):(o.isReady&&e(o),browser.ie&&11!=browser.version?(!function(){if(!o.isReady){try{o.documentElement.doScroll("left")}catch(t){return void setTimeout(arguments.callee,0)}e(o)}}(),r.attachEvent("onload",function(){e(o)})):(o.addEventListener("DOMContentLoaded",function(){o.removeEventListener("DOMContentLoaded",arguments.callee,!1),e(o)},!1),r.addEventListener("load",function(){e(o)},!1)))}}(),cssRule:browser.ie&&11!=browser.version?function(e,t,n){var r,o;return void 0===t||t&&t.nodeType&&9==t.nodeType?(n=t&&t.nodeType&&9==t.nodeType?t:n||document,r=n.indexList||(n.indexList={}),o=r[e],void 0!==o?n.styleSheets[o].cssText:void 0):(n=n||document,r=n.indexList||(n.indexList={}),o=r[e],""===t?void 0!==o?(n.styleSheets[o].cssText="",delete r[e],!0):!1:(void 0!==o?sheetStyle=n.styleSheets[o]:(sheetStyle=n.createStyleSheet("",o=n.styleSheets.length),r[e]=o),void(sheetStyle.cssText=t)))}:function(e,t,n){var r;return void 0===t||t&&t.nodeType&&9==t.nodeType?(n=t&&t.nodeType&&9==t.nodeType?t:n||document,r=n.getElementById(e),r?r.innerHTML:void 0):(n=n||document,r=n.getElementById(e),""===t?r?(r.parentNode.removeChild(r),!0):!1:void(r?r.innerHTML=t:(r=n.createElement("style"),r.id=e,r.innerHTML=t,n.getElementsByTagName("head")[0].appendChild(r))))},sort:function(e,t){t=t||function(e,t){return e.localeCompare(t)};for(var n=0,r=e.length;r>n;n++)for(var o=n,i=e.length;i>o;o++)if(t(e[n],e[o])>0){var a=e[n];e[n]=e[o],e[o]=a}return e},serializeParam:function(e){var t=[];for(var n in e)if("method"!=n&&"timeout"!=n&&"async"!=n)if("function"!=(typeof e[n]).toLowerCase()&&"object"!=(typeof e[n]).toLowerCase())t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));else if(utils.isArray(e[n]))for(var r=0;r<e[n].length;r++)t.push(encodeURIComponent(n)+"[]="+encodeURIComponent(e[n][r]));return t.join("&")},formatUrl:function(e){var t=e.replace(/&&/g,"&");return t=t.replace(/\?&/g,"?"),t=t.replace(/&$/g,""),t=t.replace(/&#/g,"#"),t=t.replace(/&+/g,"&")},isCrossDomainUrl:function(e){var t=document.createElement("a");return t.href=e,browser.ie&&(t.href=t.href),!(t.protocol==location.protocol&&t.hostname==location.hostname&&(t.port==location.port||"80"==t.port&&""==location.port||""==t.port&&"80"==location.port))},clearEmptyAttrs:function(e){for(var t in e)""===e[t]&&delete e[t];return e},str2json:function(e){return utils.isString(e)?window.JSON?JSON.parse(e):new Function("return "+utils.trim(e||""))():null},json2str:function(){function e(e){return/["\\\x00-\x1f]/.test(e)&&(e=e.replace(/["\\\x00-\x1f]/g,function(e){var t=o[e];return t?t:(t=e.charCodeAt(),"\\u00"+Math.floor(t/16).toString(16)+(t%16).toString(16))})),'"'+e+'"'}function t(e){var t,n,r,o=["["],i=e.length;for(n=0;i>n;n++)switch(r=e[n],typeof r){case"undefined":case"function":case"unknown":break;default:t&&o.push(","),o.push(utils.json2str(r)),t=1}return o.push("]"),o.join("")}function n(e){return 10>e?"0"+e:e}function r(e){return'"'+e.getFullYear()+"-"+n(e.getMonth()+1)+"-"+n(e.getDate())+"T"+n(e.getHours())+":"+n(e.getMinutes())+":"+n(e.getSeconds())+'"'}if(window.JSON)return JSON.stringify;var o={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};return function(n){switch(typeof n){case"undefined":return"undefined";case"number":return isFinite(n)?String(n):"null";case"string":return e(n);case"boolean":return String(n);default:if(null===n)return"null";if(utils.isArray(n))return t(n);if(utils.isDate(n))return r(n);var o,i,a=["{"],u=utils.json2str;for(var s in n)if(Object.prototype.hasOwnProperty.call(n,s))switch(i=n[s],typeof i){case"undefined":case"unknown":case"function":break;default:o&&a.push(","),o=1,a.push(u(s)+":"+u(i))}return a.push("}"),a.join("")}}}()};utils.each(["String","Function","Array","Number","RegExp","Object","Date"],function(e){UE.utils["is"+e]=function(t){return Object.prototype.toString.apply(t)=="[object "+e+"]"}});
function getListener(t,e,r){var i;return e=e.toLowerCase(),(i=t.__allListeners||r&&(t.__allListeners={}))&&(i[e]||r&&(i[e]=[]))}var EventBase=UE.EventBase=function(){};EventBase.prototype={addListener:function(t,e){t=utils.trim(t).split(/\s+/);for(var r,i=0;r=t[i++];)getListener(this,r,!0).push(e)},on:function(t,e){return this.addListener(t,e)},off:function(t,e){return this.removeListener(t,e)},trigger:function(){return this.fireEvent.apply(this,arguments)},removeListener:function(t,e){t=utils.trim(t).split(/\s+/);for(var r,i=0;r=t[i++];)utils.removeItem(getListener(this,r)||[],e)},fireEvent:function(){var t=arguments[0];t=utils.trim(t).split(" ");for(var e,r=0;e=t[r++];){var i,n,s,o=getListener(this,e);if(o)for(s=o.length;s--;)if(o[s]){if(n=o[s].apply(this,arguments),n===!0)return n;void 0!==n&&(i=n)}(n=this["on"+e.toLowerCase()])&&(i=n.apply(this,arguments))}return i}};
var dtd=dom.dtd=function(){function t(t){for(var e in t)t[e.toUpperCase()]=t[e];return t}var e=utils.extend2,a=t({isindex:1,fieldset:1}),o=t({input:1,button:1,select:1,textarea:1,label:1}),r=e(t({a:1}),o),i=e({iframe:1},r),d=t({hr:1,ul:1,menu:1,div:1,blockquote:1,noscript:1,table:1,center:1,address:1,dir:1,pre:1,h5:1,dl:1,h4:1,noframes:1,h6:1,ol:1,h1:1,h3:1,h2:1}),l=t({ins:1,del:1,script:1,style:1}),s=e(t({b:1,acronym:1,bdo:1,"var":1,"#":1,abbr:1,code:1,br:1,i:1,cite:1,kbd:1,u:1,strike:1,s:1,tt:1,strong:1,q:1,samp:1,em:1,dfn:1,span:1}),l),n=e(t({sub:1,img:1,embed:1,object:1,sup:1,basefont:1,map:1,applet:1,font:1,big:1,small:1}),s),b=e(t({p:1}),n),p=e(t({iframe:1}),n,o),m=t({img:1,embed:1,noscript:1,br:1,kbd:1,center:1,button:1,basefont:1,h5:1,h4:1,samp:1,h6:1,ol:1,h1:1,h3:1,h2:1,form:1,font:1,"#":1,select:1,menu:1,ins:1,abbr:1,label:1,code:1,table:1,script:1,cite:1,input:1,iframe:1,strong:1,textarea:1,noframes:1,big:1,small:1,span:1,hr:1,sub:1,bdo:1,"var":1,div:1,object:1,sup:1,strike:1,dir:1,map:1,dl:1,applet:1,del:1,isindex:1,fieldset:1,ul:1,b:1,acronym:1,a:1,blockquote:1,i:1,u:1,s:1,tt:1,address:1,q:1,pre:1,p:1,em:1,dfn:1}),c=e(t({a:0}),p),h=t({tr:1}),u=t({"#":1}),f=e(t({param:1}),m),y=e(t({form:1}),a,i,d,b),g=t({li:1,ol:1,ul:1}),k=t({style:1,script:1}),$=t({base:1,link:1,meta:1,title:1}),v=e($,k),x=t({head:1,body:1}),q=t({html:1}),C=t({address:1,blockquote:1,center:1,dir:1,div:1,dl:1,fieldset:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,hr:1,isindex:1,menu:1,noframes:1,ol:1,p:1,pre:1,table:1,ul:1}),j=t({area:1,base:1,basefont:1,br:1,col:1,command:1,dialog:1,embed:1,hr:1,img:1,input:1,isindex:1,keygen:1,link:1,meta:1,param:1,source:1,track:1,wbr:1});return t({$nonBodyContent:e(q,x,$),$block:C,$inline:c,$inlineWithA:e(t({a:1}),c),$body:e(t({script:1,style:1}),C),$cdata:t({script:1,style:1}),$empty:j,$nonChild:t({iframe:1,textarea:1}),$listItem:t({dd:1,dt:1,li:1}),$list:t({ul:1,ol:1,dl:1}),$isNotEmpty:t({table:1,ul:1,ol:1,dl:1,iframe:1,area:1,base:1,col:1,hr:1,img:1,embed:1,input:1,link:1,meta:1,param:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1}),$removeEmpty:t({a:1,abbr:1,acronym:1,address:1,b:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,q:1,s:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,tt:1,u:1,"var":1}),$removeEmptyBlock:t({p:1,div:1}),$tableContent:t({caption:1,col:1,colgroup:1,tbody:1,td:1,tfoot:1,th:1,thead:1,tr:1,table:1}),$notTransContent:t({pre:1,script:1,style:1,textarea:1}),html:x,head:v,style:u,script:u,body:y,base:{},link:{},meta:{},title:u,col:{},tr:t({td:1,th:1}),img:{},embed:{},colgroup:t({thead:1,col:1,tbody:1,tr:1,tfoot:1}),noscript:y,td:y,br:{},th:y,center:y,kbd:c,button:e(b,d),basefont:{},h5:c,h4:c,samp:c,h6:c,ol:g,h1:c,h3:c,option:u,h2:c,form:e(a,i,d,b),select:t({optgroup:1,option:1}),font:c,ins:c,menu:g,abbr:c,label:c,table:t({thead:1,col:1,tbody:1,tr:1,colgroup:1,caption:1,tfoot:1}),code:c,tfoot:h,cite:c,li:y,input:{},iframe:y,strong:c,textarea:u,noframes:y,big:c,small:c,span:t({"#":1,br:1,b:1,strong:1,u:1,i:1,em:1,sub:1,sup:1,strike:1,span:1}),hr:c,dt:c,sub:c,optgroup:t({option:1}),param:{},bdo:c,"var":c,div:y,object:f,sup:c,dd:y,strike:c,area:{},dir:g,map:e(t({area:1,form:1,p:1}),a,l,d),applet:f,dl:t({dt:1,dd:1}),del:c,isindex:{},fieldset:e(t({legend:1}),m),thead:h,ul:g,acronym:c,b:c,a:e(t({a:1}),p),blockquote:e(t({td:1,tr:1,tbody:1,li:1}),y),caption:c,i:c,u:c,tbody:h,s:c,address:e(i,b),tt:c,legend:c,q:c,pre:e(s,r),p:e(t({a:1}),c),em:c,dfn:c})}();
function getDomNode(e,t,r,i,n,o){var s,l=i&&e[t];for(!l&&(l=e[r]);!l&&(s=(s||e).parentNode);){if("BODY"==s.tagName||o&&!o(s))return null;l=s[r]}return l&&n&&!n(l)?getDomNode(l,t,r,!1,n):l}var attrFix=ie&&browser.version<9?{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder"}:{tabindex:"tabIndex",readonly:"readOnly"},styleBlock=utils.listToMap(["-webkit-box","-moz-box","block","list-item","table","table-row-group","table-header-group","table-footer-group","table-row","table-column-group","table-column","table-cell","table-caption"]),domUtils=dom.domUtils={NODE_ELEMENT:1,NODE_DOCUMENT:9,NODE_TEXT:3,NODE_COMMENT:8,NODE_DOCUMENT_FRAGMENT:11,POSITION_IDENTICAL:0,POSITION_DISCONNECTED:1,POSITION_FOLLOWING:2,POSITION_PRECEDING:4,POSITION_IS_CONTAINED:8,POSITION_CONTAINS:16,fillChar:ie&&"6"==browser.version?"\ufeff":"​",keys:{8:1,46:1,16:1,17:1,18:1,37:1,38:1,39:1,40:1,13:1},getPosition:function(e,t){if(e===t)return 0;var r,i=[e],n=[t];for(r=e;r=r.parentNode;){if(r===t)return 10;i.push(r)}for(r=t;r=r.parentNode;){if(r===e)return 20;n.push(r)}if(i.reverse(),n.reverse(),i[0]!==n[0])return 1;for(var o=-1;o++,i[o]===n[o];);for(e=i[o],t=n[o];e=e.nextSibling;)if(e===t)return 4;return 2},getNodeIndex:function(e,t){for(var r=e,i=0;r=r.previousSibling;)t&&3==r.nodeType?r.nodeType!=r.nextSibling.nodeType&&i++:i++;return i},inDoc:function(e,t){return 10==domUtils.getPosition(e,t)},findParent:function(e,t,r){if(e&&!domUtils.isBody(e))for(e=r?e:e.parentNode;e;){if(!t||t(e)||domUtils.isBody(e))return t&&!t(e)&&domUtils.isBody(e)?null:e;e=e.parentNode}return null},findParentByTagName:function(e,t,r,i){return t=utils.listToMap(utils.isArray(t)?t:[t]),domUtils.findParent(e,function(e){return t[e.tagName]&&!(i&&i(e))},r)},findParents:function(e,t,r,i){for(var n=t&&(r&&r(e)||!r)?[e]:[];e=domUtils.findParent(e,r);)n.push(e);return i?n:n.reverse()},insertAfter:function(e,t){return e.nextSibling?e.parentNode.insertBefore(t,e.nextSibling):e.parentNode.appendChild(t)},remove:function(e,t){var r,i=e.parentNode;if(i){if(t&&e.hasChildNodes())for(;r=e.firstChild;)i.insertBefore(r,e);i.removeChild(e)}return e},getNextDomNode:function(e,t,r,i){return getDomNode(e,"firstChild","nextSibling",t,r,i)},getPreDomNode:function(e,t,r,i){return getDomNode(e,"lastChild","previousSibling",t,r,i)},isBookmarkNode:function(e){return 1==e.nodeType&&e.id&&/^_baidu_bookmark_/i.test(e.id)},getWindow:function(e){var t=e.ownerDocument||e;return t.defaultView||t.parentWindow},getCommonAncestor:function(e,t){if(e===t)return e;for(var r=[e],i=[t],n=e,o=-1;n=n.parentNode;){if(n===t)return n;r.push(n)}for(n=t;n=n.parentNode;){if(n===e)return n;i.push(n)}for(r.reverse(),i.reverse();o++,r[o]===i[o];);return 0==o?null:r[o-1]},clearEmptySibling:function(e,t,r){function i(e,t){for(var r;e&&!domUtils.isBookmarkNode(e)&&(domUtils.isEmptyInlineElement(e)||!new RegExp("[^	\n\r"+domUtils.fillChar+"]").test(e.nodeValue));)r=e[t],domUtils.remove(e),e=r}!t&&i(e.nextSibling,"nextSibling"),!r&&i(e.previousSibling,"previousSibling")},split:function(e,t){var r=e.ownerDocument;if(browser.ie&&t==e.nodeValue.length){var i=r.createTextNode("");return domUtils.insertAfter(e,i)}var n=e.splitText(t);if(browser.ie8){var o=r.createTextNode("");domUtils.insertAfter(n,o),domUtils.remove(o)}return n},isWhitespace:function(e){return!new RegExp("[^ 	\n\r"+domUtils.fillChar+"]").test(e.nodeValue)},getXY:function(e){for(var t=0,r=0;e.offsetParent;)r+=e.offsetTop,t+=e.offsetLeft,e=e.offsetParent;return{x:t,y:r}},on:function(e,t,r){var i=utils.isArray(t)?t:utils.trim(t).split(/\s+/),n=i.length;if(n)for(;n--;)if(t=i[n],e.addEventListener)e.addEventListener(t,r,!1);else{r._d||(r._d={els:[]});var o=t+r.toString(),s=utils.indexOf(r._d.els,e);r._d[o]&&-1!=s||(-1==s&&r._d.els.push(e),r._d[o]||(r._d[o]=function(e){return r.call(e.srcElement,e||window.event)}),e.attachEvent("on"+t,r._d[o]))}e=null},un:function(e,t,r){var i=utils.isArray(t)?t:utils.trim(t).split(/\s+/),n=i.length;if(n)for(;n--;)if(t=i[n],e.removeEventListener)e.removeEventListener(t,r,!1);else{var o=t+r.toString();try{e.detachEvent("on"+t,r._d?r._d[o]:r)}catch(s){}if(r._d&&r._d[o]){var l=utils.indexOf(r._d.els,e);-1!=l&&r._d.els.splice(l,1),0==r._d.els.length&&delete r._d[o]}}},isSameElement:function(e,t){if(e.tagName!=t.tagName)return!1;var r=e.attributes,i=t.attributes;if(!ie&&r.length!=i.length)return!1;for(var n,o,s=0,l=0,a=0;n=r[a++];){if("style"==n.nodeName){if(n.specified&&s++,domUtils.isSameStyle(e,t))continue;return!1}if(ie){if(!n.specified)continue;s++,o=i.getNamedItem(n.nodeName)}else o=t.attributes[n.nodeName];if(!o.specified||n.nodeValue!=o.nodeValue)return!1}if(ie){for(a=0;o=i[a++];)o.specified&&l++;if(s!=l)return!1}return!0},isSameStyle:function(e,t){var r=e.style.cssText.replace(/( ?; ?)/g,";").replace(/( ?: ?)/g,":"),i=t.style.cssText.replace(/( ?; ?)/g,";").replace(/( ?: ?)/g,":");if(browser.opera){if(r=e.style,i=t.style,r.length!=i.length)return!1;for(var n in r)if(!/^(\d+|csstext)$/i.test(n)&&r[n]!=i[n])return!1;return!0}if(!r||!i)return r==i;if(r=r.split(";"),i=i.split(";"),r.length!=i.length)return!1;for(var o,s=0;o=r[s++];)if(-1==utils.indexOf(i,o))return!1;return!0},isBlockElm:function(e){return 1==e.nodeType&&(dtd.$block[e.tagName]||styleBlock[domUtils.getComputedStyle(e,"display")])&&!dtd.$nonChild[e.tagName]},isBody:function(e){return e&&1==e.nodeType&&"body"==e.tagName.toLowerCase()},breakParent:function(e,t){var r,i,n,o=e,s=e;do{for(o=o.parentNode,i?(r=o.cloneNode(!1),r.appendChild(i),i=r,r=o.cloneNode(!1),r.appendChild(n),n=r):(i=o.cloneNode(!1),n=i.cloneNode(!1));r=s.previousSibling;)i.insertBefore(r,i.firstChild);for(;r=s.nextSibling;)n.appendChild(r);s=o}while(t!==o);return r=t.parentNode,r.insertBefore(i,t),r.insertBefore(n,t),r.insertBefore(e,n),domUtils.remove(t),e},isEmptyInlineElement:function(e){if(1!=e.nodeType||!dtd.$removeEmpty[e.tagName])return 0;for(e=e.firstChild;e;){if(domUtils.isBookmarkNode(e))return 0;if(1==e.nodeType&&!domUtils.isEmptyInlineElement(e)||3==e.nodeType&&!domUtils.isWhitespace(e))return 0;e=e.nextSibling}return 1},trimWhiteTextNode:function(e){function t(t){for(var r;(r=e[t])&&3==r.nodeType&&domUtils.isWhitespace(r);)e.removeChild(r)}t("firstChild"),t("lastChild")},mergeChild:function(e,t,r){for(var i,n=domUtils.getElementsByTagName(e,e.tagName.toLowerCase()),o=0;i=n[o++];)if(i.parentNode&&!domUtils.isBookmarkNode(i))if("span"!=i.tagName.toLowerCase())domUtils.isSameElement(e,i)&&domUtils.remove(i,!0);else{if(e===i.parentNode&&(domUtils.trimWhiteTextNode(e),1==e.childNodes.length)){e.style.cssText=i.style.cssText+";"+e.style.cssText,domUtils.remove(i,!0);continue}if(i.style.cssText=e.style.cssText+";"+i.style.cssText,r){var s=r.style;if(s){s=s.split(";");for(var l,a=0;l=s[a++];)i.style[utils.cssStyleToDomStyle(l.split(":")[0])]=l.split(":")[1]}}domUtils.isSameStyle(i,e)&&domUtils.remove(i,!0)}},getElementsByTagName:function(e,t,r){if(r&&utils.isString(r)){var i=r;r=function(e){return domUtils.hasClass(e,i)}}t=utils.trim(t).replace(/[ ]{2,}/g," ").split(" ");for(var n,o=[],s=0;n=t[s++];)for(var l,a=e.getElementsByTagName(n),d=0;l=a[d++];)(!r||r(l))&&o.push(l);return o},mergeToParent:function(e){for(var t=e.parentNode;t&&dtd.$removeEmpty[t.tagName];){if(t.tagName==e.tagName||"A"==t.tagName){if(domUtils.trimWhiteTextNode(t),"SPAN"==t.tagName&&!domUtils.isSameStyle(t,e)||"A"==t.tagName&&"SPAN"==e.tagName){if(t.childNodes.length>1||t!==e.parentNode){e.style.cssText=t.style.cssText+";"+e.style.cssText,t=t.parentNode;continue}t.style.cssText+=";"+e.style.cssText,"A"==t.tagName&&(t.style.textDecoration="underline")}if("A"!=t.tagName){t===e.parentNode&&domUtils.remove(e,!0);break}}t=t.parentNode}},mergeSibling:function(e,t,r){function i(e,t,r){var i;if((i=r[e])&&!domUtils.isBookmarkNode(i)&&1==i.nodeType&&domUtils.isSameElement(r,i)){for(;i.firstChild;)"firstChild"==t?r.insertBefore(i.lastChild,r.firstChild):r.appendChild(i.firstChild);domUtils.remove(i)}}!t&&i("previousSibling","firstChild",e),!r&&i("nextSibling","lastChild",e)},unSelectable:ie&&browser.ie9below||browser.opera?function(e){e.onselectstart=function(){return!1},e.onclick=e.onkeyup=e.onkeydown=function(){return!1},e.unselectable="on",e.setAttribute("unselectable","on");for(var t,r=0;t=e.all[r++];)switch(t.tagName.toLowerCase()){case"iframe":case"textarea":case"input":case"select":break;default:t.unselectable="on",e.setAttribute("unselectable","on")}}:function(e){e.style.MozUserSelect=e.style.webkitUserSelect=e.style.msUserSelect=e.style.KhtmlUserSelect="none"},removeAttributes:function(e,t){t=utils.isArray(t)?t:utils.trim(t).replace(/[ ]{2,}/g," ").split(" ");for(var r,i=0;r=t[i++];){switch(r=attrFix[r]||r){case"className":e[r]="";break;case"style":e.style.cssText="";var n=e.getAttributeNode("style");!browser.ie&&n&&e.removeAttributeNode(n)}e.removeAttribute(r)}},createElement:function(e,t,r){return domUtils.setAttributes(e.createElement(t),r)},setAttributes:function(e,t){for(var r in t)if(t.hasOwnProperty(r)){var i=t[r];switch(r){case"class":e.className=i;break;case"style":e.style.cssText=e.style.cssText+";"+i;break;case"innerHTML":e[r]=i;break;case"value":e.value=i;break;default:e.setAttribute(attrFix[r]||r,i)}}return e},getComputedStyle:function(e,t){var r="width height top left";if(r.indexOf(t)>-1)return e["offset"+t.replace(/^\w/,function(e){return e.toUpperCase()})]+"px";if(3==e.nodeType&&(e=e.parentNode),browser.ie&&browser.version<9&&"font-size"==t&&!e.style.fontSize&&!dtd.$empty[e.tagName]&&!dtd.$nonChild[e.tagName]){var i=e.ownerDocument.createElement("span");i.style.cssText="padding:0;border:0;font-family:simsun;",i.innerHTML=".",e.appendChild(i);var n=i.offsetHeight;return e.removeChild(i),i=null,n+"px"}try{var o=domUtils.getStyle(e,t)||(window.getComputedStyle?domUtils.getWindow(e).getComputedStyle(e,"").getPropertyValue(t):(e.currentStyle||e.style)[utils.cssStyleToDomStyle(t)])}catch(s){return""}return utils.transUnitToPx(utils.fixColor(t,o))},removeClasses:function(e,t){t=utils.isArray(t)?t:utils.trim(t).replace(/[ ]{2,}/g," ").split(" ");for(var r,i=0,n=e.className;r=t[i++];)n=n.replace(new RegExp("\\b"+r+"\\b"),"");n=utils.trim(n).replace(/[ ]{2,}/g," "),n?e.className=n:domUtils.removeAttributes(e,["class"])},addClass:function(e,t){if(e){t=utils.trim(t).replace(/[ ]{2,}/g," ").split(" ");for(var r,i=0,n=e.className;r=t[i++];)new RegExp("\\b"+r+"\\b").test(n)||(n+=" "+r);e.className=utils.trim(n)}},hasClass:function(e,t){if(utils.isRegExp(t))return t.test(e.className);t=utils.trim(t).replace(/[ ]{2,}/g," ").split(" ");for(var r,i=0,n=e.className;r=t[i++];)if(!new RegExp("\\b"+r+"\\b","i").test(n))return!1;return i-1==t.length},preventDefault:function(e){e.preventDefault?e.preventDefault():e.returnValue=!1},removeStyle:function(e,t){browser.ie?("color"==t&&(t="(^|;)"+t),e.style.cssText=e.style.cssText.replace(new RegExp(t+"[^:]*:[^;]+;?","ig"),"")):e.style.removeProperty?e.style.removeProperty(t):e.style.removeAttribute(utils.cssStyleToDomStyle(t)),e.style.cssText||domUtils.removeAttributes(e,["style"])},getStyle:function(e,t){var r=e.style[utils.cssStyleToDomStyle(t)];return utils.fixColor(t,r)},setStyle:function(e,t,r){e.style[utils.cssStyleToDomStyle(t)]=r,utils.trim(e.style.cssText)||this.removeAttributes(e,"style")},setStyles:function(e,t){for(var r in t)t.hasOwnProperty(r)&&domUtils.setStyle(e,r,t[r])},removeDirtyAttr:function(e){for(var t,r=0,i=e.getElementsByTagName("*");t=i[r++];)t.removeAttribute("_moz_dirty");e.removeAttribute("_moz_dirty")},getChildCount:function(e,t){var r=0,i=e.firstChild;for(t=t||function(){return 1};i;)t(i)&&r++,i=i.nextSibling;return r},isEmptyNode:function(e){return!e.firstChild||0==domUtils.getChildCount(e,function(e){return!domUtils.isBr(e)&&!domUtils.isBookmarkNode(e)&&!domUtils.isWhitespace(e)})},clearSelectedArr:function(e){for(var t;t=e.pop();)domUtils.removeAttributes(t,["class"])},scrollToView:function(e,t,r){var i=function(){var e=t.document,r="CSS1Compat"==e.compatMode;return{width:(r?e.documentElement.clientWidth:e.body.clientWidth)||0,height:(r?e.documentElement.clientHeight:e.body.clientHeight)||0}},n=function(e){if("pageXOffset"in e)return{x:e.pageXOffset||0,y:e.pageYOffset||0};var t=e.document;return{x:t.documentElement.scrollLeft||t.body.scrollLeft||0,y:t.documentElement.scrollTop||t.body.scrollTop||0}},o=i().height,s=-1*o+r;s+=e.offsetHeight||0;var l=domUtils.getXY(e);s+=l.y;var a=n(t).y;(s>a||a-o>s)&&t.scrollTo(0,s+(0>s?-20:20))},isBr:function(e){return 1==e.nodeType&&"BR"==e.tagName},isFillChar:function(e,t){if(3!=e.nodeType)return!1;var r=e.nodeValue;return t?new RegExp("^"+domUtils.fillChar).test(r):!r.replace(new RegExp(domUtils.fillChar,"g"),"").length},isStartInblock:function(e){var t,r=e.cloneRange(),i=0,n=r.startContainer;if(1==n.nodeType&&n.childNodes[r.startOffset]){n=n.childNodes[r.startOffset];for(var o=n.previousSibling;o&&domUtils.isFillChar(o);)n=o,o=o.previousSibling}for(this.isFillChar(n,!0)&&1==r.startOffset&&(r.setStartBefore(n),n=r.startContainer);n&&domUtils.isFillChar(n);)t=n,n=n.previousSibling;for(t&&(r.setStartBefore(t),n=r.startContainer),1==n.nodeType&&domUtils.isEmptyNode(n)&&1==r.startOffset&&r.setStart(n,0).collapse(!0);!r.startOffset;){if(n=r.startContainer,domUtils.isBlockElm(n)||domUtils.isBody(n)){i=1;break}var s,o=r.startContainer.previousSibling;if(o){for(;o&&domUtils.isFillChar(o);)s=o,o=o.previousSibling;r.setStartBefore(s?s:r.startContainer)}else r.setStartBefore(r.startContainer)}return i&&!domUtils.isBody(r.startContainer)?1:0},isEmptyBlock:function(e,t){if(1!=e.nodeType)return 0;if(t=t||new RegExp("[  	\r\n"+domUtils.fillChar+"]","g"),e[browser.ie?"innerText":"textContent"].replace(t,"").length>0)return 0;for(var r in dtd.$isNotEmpty)if(e.getElementsByTagName(r).length)return 0;return 1},setViewportOffset:function(e,t){var r=0|parseInt(e.style.left),i=0|parseInt(e.style.top),n=e.getBoundingClientRect(),o=t.left-n.left,s=t.top-n.top;o&&(e.style.left=r+o+"px"),s&&(e.style.top=i+s+"px")},fillNode:function(e,t){var r=browser.ie?e.createTextNode(domUtils.fillChar):e.createElement("br");t.innerHTML="",t.appendChild(r)},moveChild:function(e,t,r){for(;e.firstChild;)r&&t.firstChild?t.insertBefore(e.lastChild,t.firstChild):t.appendChild(e.firstChild)},hasNoAttributes:function(e){return browser.ie?/^<\w+\s*?>/.test(e.outerHTML):0==e.attributes.length},isCustomeNode:function(e){return 1==e.nodeType&&e.getAttribute("_ue_custom_node_")},isTagNode:function(e,t){return 1==e.nodeType&&new RegExp("\\b"+e.tagName+"\\b","i").test(t)},filterNodeList:function(e,t,r){var i=[];if(!utils.isFunction(t)){var n=t;t=function(e){return-1!=utils.indexOf(utils.isArray(n)?n:n.split(" "),e.tagName.toLowerCase())}}return utils.each(e,function(e){t(e)&&i.push(e)}),0==i.length?null:1!=i.length&&r?i:i[0]},isInNodeEndBoundary:function(e,t){var r=e.startContainer;if(3==r.nodeType&&e.startOffset!=r.nodeValue.length)return 0;if(1==r.nodeType&&e.startOffset!=r.childNodes.length)return 0;for(;r!==t;){if(r.nextSibling)return 0;r=r.parentNode}return 1},isBoundaryNode:function(e,t){for(var r;!domUtils.isBody(e);)if(r=e,e=e.parentNode,r!==e[t])return!1;return!0},fillHtml:browser.ie11below?"&nbsp;":"<br/>"},fillCharReg=new RegExp(domUtils.fillChar,"g");
!function(){function e(e){e.collapsed=e.startContainer&&e.endContainer&&e.startContainer===e.endContainer&&e.startOffset==e.endOffset}function t(e){return!e.collapsed&&1==e.startContainer.nodeType&&e.startContainer===e.endContainer&&e.endOffset-e.startOffset==1}function n(t,n,o,s){return 1==n.nodeType&&(dtd.$empty[n.tagName]||dtd.$nonChild[n.tagName])&&(o=domUtils.getNodeIndex(n)+(t?0:1),n=n.parentNode),t?(s.startContainer=n,s.startOffset=o,s.endContainer||s.collapse(!0)):(s.endContainer=n,s.endOffset=o,s.startContainer||s.collapse(!1)),e(s),s}function o(e,t){var n,o,s=e.startContainer,r=e.endContainer,i=e.startOffset,d=e.endOffset,a=e.document,l=a.createDocumentFragment();if(1==s.nodeType&&(s=s.childNodes[i]||(n=s.appendChild(a.createTextNode("")))),1==r.nodeType&&(r=r.childNodes[d]||(o=r.appendChild(a.createTextNode("")))),s===r&&3==s.nodeType)return l.appendChild(a.createTextNode(s.substringData(i,d-i))),t&&(s.deleteData(i,d-i),e.collapse(!0)),l;for(var f,h,c=l,u=domUtils.findParents(s,!0),m=domUtils.findParents(r,!0),p=0;u[p]==m[p];)p++;for(var C,N=p;C=u[N];N++){for(f=C.nextSibling,C==s?n||(3==e.startContainer.nodeType?(c.appendChild(a.createTextNode(s.nodeValue.slice(i))),t&&s.deleteData(i,s.nodeValue.length-i)):c.appendChild(t?s:s.cloneNode(!0))):(h=C.cloneNode(!1),c.appendChild(h));f&&f!==r&&f!==m[N];)C=f.nextSibling,c.appendChild(t?f:f.cloneNode(!0)),f=C;c=h}c=l,u[p]||(c.appendChild(u[p-1].cloneNode(!1)),c=c.firstChild);for(var g,N=p;g=m[N];N++){if(f=g.previousSibling,g==r?o||3!=e.endContainer.nodeType||(c.appendChild(a.createTextNode(r.substringData(0,d))),t&&r.deleteData(0,d)):(h=g.cloneNode(!1),c.appendChild(h)),N!=p||!u[p])for(;f&&f!==s;)g=f.previousSibling,c.insertBefore(t?f:f.cloneNode(!0),c.firstChild),f=g;c=h}return t&&e.setStartBefore(m[p]?u[p]?m[p]:u[p-1]:m[p-1]).collapse(!0),n&&domUtils.remove(n),o&&domUtils.remove(o),l}function s(e,t){try{if(i&&domUtils.inDoc(i,e))if(i.nodeValue.replace(fillCharReg,"").length)i.nodeValue=i.nodeValue.replace(fillCharReg,"");else{var n=i.parentNode;for(domUtils.remove(i);n&&domUtils.isEmptyInlineElement(n)&&(browser.safari?!(domUtils.getPosition(n,t)&domUtils.POSITION_CONTAINS):!n.contains(t));)i=n.parentNode,domUtils.remove(n),n=i}}catch(o){}}function r(e,t){var n;for(e=e[t];e&&domUtils.isFillChar(e);)n=e[t],domUtils.remove(e),e=n}var i,d=0,a=domUtils.fillChar,l=dom.Range=function(e){var t=this;t.startContainer=t.startOffset=t.endContainer=t.endOffset=null,t.document=e,t.collapsed=!0};l.prototype={cloneContents:function(){return this.collapsed?null:o(this,0)},deleteContents:function(){var e;return this.collapsed||o(this,1),browser.webkit&&(e=this.startContainer,3!=e.nodeType||e.nodeValue.length||(this.setStartBefore(e).collapse(!0),domUtils.remove(e))),this},extractContents:function(){return this.collapsed?null:o(this,2)},setStart:function(e,t){return n(!0,e,t,this)},setEnd:function(e,t){return n(!1,e,t,this)},setStartAfter:function(e){return this.setStart(e.parentNode,domUtils.getNodeIndex(e)+1)},setStartBefore:function(e){return this.setStart(e.parentNode,domUtils.getNodeIndex(e))},setEndAfter:function(e){return this.setEnd(e.parentNode,domUtils.getNodeIndex(e)+1)},setEndBefore:function(e){return this.setEnd(e.parentNode,domUtils.getNodeIndex(e))},setStartAtFirst:function(e){return this.setStart(e,0)},setStartAtLast:function(e){return this.setStart(e,3==e.nodeType?e.nodeValue.length:e.childNodes.length)},setEndAtFirst:function(e){return this.setEnd(e,0)},setEndAtLast:function(e){return this.setEnd(e,3==e.nodeType?e.nodeValue.length:e.childNodes.length)},selectNode:function(e){return this.setStartBefore(e).setEndAfter(e)},selectNodeContents:function(e){return this.setStart(e,0).setEndAtLast(e)},cloneRange:function(){var e=this;return new l(e.document).setStart(e.startContainer,e.startOffset).setEnd(e.endContainer,e.endOffset)},collapse:function(e){var t=this;return e?(t.endContainer=t.startContainer,t.endOffset=t.startOffset):(t.startContainer=t.endContainer,t.startOffset=t.endOffset),t.collapsed=!0,t},shrinkBoundary:function(e){function t(e){return 1==e.nodeType&&!domUtils.isBookmarkNode(e)&&!dtd.$empty[e.tagName]&&!dtd.$nonChild[e.tagName]}for(var n,o=this,s=o.collapsed;1==o.startContainer.nodeType&&(n=o.startContainer.childNodes[o.startOffset])&&t(n);)o.setStart(n,0);if(s)return o.collapse(!0);if(!e)for(;1==o.endContainer.nodeType&&o.endOffset>0&&(n=o.endContainer.childNodes[o.endOffset-1])&&t(n);)o.setEnd(n,n.childNodes.length);return o},getCommonAncestor:function(e,n){var o=this,s=o.startContainer,r=o.endContainer;return s===r?e&&t(this)&&(s=s.childNodes[o.startOffset],1==s.nodeType)?s:n&&3==s.nodeType?s.parentNode:s:domUtils.getCommonAncestor(s,r)},trimBoundary:function(e){this.txtToElmBoundary();var t=this.startContainer,n=this.startOffset,o=this.collapsed,s=this.endContainer;if(3==t.nodeType){if(0==n)this.setStartBefore(t);else if(n>=t.nodeValue.length)this.setStartAfter(t);else{var r=domUtils.split(t,n);t===s?this.setEnd(r,this.endOffset-n):t.parentNode===s&&(this.endOffset+=1),this.setStartBefore(r)}if(o)return this.collapse(!0)}return e||(n=this.endOffset,s=this.endContainer,3==s.nodeType&&(0==n?this.setEndBefore(s):(n<s.nodeValue.length&&domUtils.split(s,n),this.setEndAfter(s)))),this},txtToElmBoundary:function(e){function t(e,t){var n=e[t+"Container"],o=e[t+"Offset"];3==n.nodeType&&(o?o>=n.nodeValue.length&&e["set"+t.replace(/(\w)/,function(e){return e.toUpperCase()})+"After"](n):e["set"+t.replace(/(\w)/,function(e){return e.toUpperCase()})+"Before"](n))}return(e||!this.collapsed)&&(t(this,"start"),t(this,"end")),this},insertNode:function(e){var t=e,n=1;11==e.nodeType&&(t=e.firstChild,n=e.childNodes.length),this.trimBoundary(!0);var o=this.startContainer,s=this.startOffset,r=o.childNodes[s];return r?o.insertBefore(e,r):o.appendChild(e),t.parentNode===this.endContainer&&(this.endOffset=this.endOffset+n),this.setStartBefore(t)},setCursor:function(e,t){return this.collapse(!e).select(t)},createBookmark:function(e,t){var n,o=this.document.createElement("span");return o.style.cssText="display:none;line-height:0px;",o.appendChild(this.document.createTextNode("‍")),o.id="_baidu_bookmark_start_"+(t?"":d++),this.collapsed||(n=o.cloneNode(!0),n.id="_baidu_bookmark_end_"+(t?"":d++)),this.insertNode(o),n&&this.collapse().insertNode(n).setEndBefore(n),this.setStartAfter(o),{start:e?o.id:o,end:n?e?n.id:n:null,id:e}},moveToBookmark:function(e){var t=e.id?this.document.getElementById(e.start):e.start,n=e.end&&e.id?this.document.getElementById(e.end):e.end;return this.setStartBefore(t),domUtils.remove(t),n?(this.setEndBefore(n),domUtils.remove(n)):this.collapse(!0),this},enlarge:function(e,t){var n,o,s=domUtils.isBody,r=this.document.createTextNode("");if(e){for(o=this.startContainer,1==o.nodeType?o.childNodes[this.startOffset]?n=o=o.childNodes[this.startOffset]:(o.appendChild(r),n=o=r):n=o;;){if(domUtils.isBlockElm(o)){for(o=n;(n=o.previousSibling)&&!domUtils.isBlockElm(n);)o=n;this.setStartBefore(o);break}n=o,o=o.parentNode}for(o=this.endContainer,1==o.nodeType?((n=o.childNodes[this.endOffset])?o.insertBefore(r,n):o.appendChild(r),n=o=r):n=o;;){if(domUtils.isBlockElm(o)){for(o=n;(n=o.nextSibling)&&!domUtils.isBlockElm(n);)o=n;this.setEndAfter(o);break}n=o,o=o.parentNode}r.parentNode===this.endContainer&&this.endOffset--,domUtils.remove(r)}if(!this.collapsed){for(;!(0!=this.startOffset||t&&t(this.startContainer)||s(this.startContainer));)this.setStartBefore(this.startContainer);for(;!(this.endOffset!=(1==this.endContainer.nodeType?this.endContainer.childNodes.length:this.endContainer.nodeValue.length)||t&&t(this.endContainer)||s(this.endContainer));)this.setEndAfter(this.endContainer)}return this},enlargeToBlockElm:function(e){for(;!domUtils.isBlockElm(this.startContainer);)this.setStartBefore(this.startContainer);if(!e)for(;!domUtils.isBlockElm(this.endContainer);)this.setEndAfter(this.endContainer);return this},adjustmentBoundary:function(){if(!this.collapsed){for(;!domUtils.isBody(this.startContainer)&&this.startOffset==this.startContainer[3==this.startContainer.nodeType?"nodeValue":"childNodes"].length&&this.startContainer[3==this.startContainer.nodeType?"nodeValue":"childNodes"].length;)this.setStartAfter(this.startContainer);for(;!domUtils.isBody(this.endContainer)&&!this.endOffset&&this.endContainer[3==this.endContainer.nodeType?"nodeValue":"childNodes"].length;)this.setEndBefore(this.endContainer)}return this},applyInlineStyle:function(e,t,n){if(this.collapsed)return this;this.trimBoundary().enlarge(!1,function(e){return 1==e.nodeType&&domUtils.isBlockElm(e)}).adjustmentBoundary();for(var o,s,r=this.createBookmark(),i=r.end,d=function(e){return 1==e.nodeType?"br"!=e.tagName.toLowerCase():!domUtils.isWhitespace(e)},a=domUtils.getNextDomNode(r.start,!1,d),l=this.cloneRange();a&&domUtils.getPosition(a,i)&domUtils.POSITION_PRECEDING;)if(3==a.nodeType||dtd[e][a.tagName]){for(l.setStartBefore(a),o=a;o&&(3==o.nodeType||dtd[e][o.tagName])&&o!==i;)s=o,o=domUtils.getNextDomNode(o,1==o.nodeType,null,function(t){return dtd[e][t.tagName]});var f,h=l.setEndAfter(s).extractContents();if(n&&n.length>0){var c,u;u=c=n[0].cloneNode(!1);for(var m,p=1;m=n[p++];)c.appendChild(m.cloneNode(!1)),c=c.firstChild;f=c}else f=l.document.createElement(e);t&&domUtils.setAttributes(f,t),f.appendChild(h),l.insertNode(n?u:f);var C;if("span"==e&&t.style&&/text\-decoration/.test(t.style)&&(C=domUtils.findParentByTagName(f,"a",!0))?(domUtils.setAttributes(C,t),domUtils.remove(f,!0),f=C):(domUtils.mergeSibling(f),domUtils.clearEmptySibling(f)),domUtils.mergeChild(f,t),a=domUtils.getNextDomNode(f,!1,d),domUtils.mergeToParent(f),o===i)break}else a=domUtils.getNextDomNode(a,!0,d);return this.moveToBookmark(r)},removeInlineStyle:function(e){if(this.collapsed)return this;e=utils.isArray(e)?e:[e],this.shrinkBoundary().adjustmentBoundary();for(var t=this.startContainer,n=this.endContainer;;){if(1==t.nodeType){if(utils.indexOf(e,t.tagName.toLowerCase())>-1)break;if("body"==t.tagName.toLowerCase()){t=null;break}}t=t.parentNode}for(;;){if(1==n.nodeType){if(utils.indexOf(e,n.tagName.toLowerCase())>-1)break;if("body"==n.tagName.toLowerCase()){n=null;break}}n=n.parentNode}var o,s,r=this.createBookmark();t&&(s=this.cloneRange().setEndBefore(r.start).setStartBefore(t),o=s.extractContents(),s.insertNode(o),domUtils.clearEmptySibling(t,!0),t.parentNode.insertBefore(r.start,t)),n&&(s=this.cloneRange().setStartAfter(r.end).setEndAfter(n),o=s.extractContents(),s.insertNode(o),domUtils.clearEmptySibling(n,!1,!0),n.parentNode.insertBefore(r.end,n.nextSibling));for(var i,d=domUtils.getNextDomNode(r.start,!1,function(e){return 1==e.nodeType});d&&d!==r.end;)i=domUtils.getNextDomNode(d,!0,function(e){return 1==e.nodeType}),utils.indexOf(e,d.tagName.toLowerCase())>-1&&domUtils.remove(d,!0),d=i;return this.moveToBookmark(r)},getClosedNode:function(){var e;if(!this.collapsed){var n=this.cloneRange().adjustmentBoundary().shrinkBoundary();if(t(n)){var o=n.startContainer.childNodes[n.startOffset];o&&1==o.nodeType&&(dtd.$empty[o.tagName]||dtd.$nonChild[o.tagName])&&(e=o)}}return e},select:browser.ie?function(e,t){var n;this.collapsed||this.shrinkBoundary();var o=this.getClosedNode();if(o&&!t){try{n=this.document.body.createControlRange(),n.addElement(o),n.select()}catch(d){}return this}var l,f=this.createBookmark(),h=f.start;if(n=this.document.body.createTextRange(),n.moveToElementText(h),n.moveStart("character",1),this.collapsed){if(!e&&3!=this.startContainer.nodeType){var c=this.document.createTextNode(a),u=this.document.createElement("span");u.appendChild(this.document.createTextNode(a)),h.parentNode.insertBefore(u,h),h.parentNode.insertBefore(c,h),s(this.document,c),i=c,r(u,"previousSibling"),r(h,"nextSibling"),n.moveStart("character",-1),n.collapse(!0)}}else{var m=this.document.body.createTextRange();l=f.end,m.moveToElementText(l),n.setEndPoint("EndToEnd",m)}this.moveToBookmark(f),u&&domUtils.remove(u);try{n.select()}catch(d){}return this}:function(e){function t(e){function t(t,n,o){3==t.nodeType&&t.nodeValue.length<n&&(e[o+"Offset"]=t.nodeValue.length)}t(e.startContainer,e.startOffset,"start"),t(e.endContainer,e.endOffset,"end")}var n,o=domUtils.getWindow(this.document),d=o.getSelection();if(browser.gecko?this.document.body.focus():o.focus(),d){if(d.removeAllRanges(),this.collapsed&&!e){var l=this.startContainer,f=l;1==l.nodeType&&(f=l.childNodes[this.startOffset]),3==l.nodeType&&this.startOffset||(f?f.previousSibling&&3==f.previousSibling.nodeType:l.lastChild&&3==l.lastChild.nodeType)||(n=this.document.createTextNode(a),this.insertNode(n),s(this.document,n),r(n,"previousSibling"),r(n,"nextSibling"),i=n,this.setStart(n,browser.webkit?1:0).collapse(!0))}var h=this.document.createRange();if(this.collapsed&&browser.opera&&1==this.startContainer.nodeType){var f=this.startContainer.childNodes[this.startOffset];if(f){for(;f&&domUtils.isBlockElm(f)&&1==f.nodeType&&f.childNodes[0];)f=f.childNodes[0];f&&this.setStartBefore(f).collapse(!0)}else f=this.startContainer.lastChild,f&&domUtils.isBr(f)&&this.setStartBefore(f).collapse(!0)}t(this),h.setStart(this.startContainer,this.startOffset),h.setEnd(this.endContainer,this.endOffset),d.addRange(h)}return this},scrollToView:function(e,t){e=e?window:domUtils.getWindow(this.document);var n=this,o=n.document.createElement("span");return o.innerHTML="&nbsp;",n.cloneRange().insertNode(o),domUtils.scrollToView(o,e,t),domUtils.remove(o),n},inFillChar:function(){var e=this.startContainer;return this.collapsed&&3==e.nodeType&&e.nodeValue.replace(new RegExp("^"+domUtils.fillChar),"").length+1==e.nodeValue.length?!0:!1},createAddress:function(e,t){function n(e){for(var n,o=e?s.startContainer:s.endContainer,r=domUtils.findParents(o,!0,function(e){return!domUtils.isBody(e)}),i=[],d=0;n=r[d++];)i.push(domUtils.getNodeIndex(n,t));var a=0;if(t)if(3==o.nodeType){for(var l=o.previousSibling;l&&3==l.nodeType;)a+=l.nodeValue.replace(fillCharReg,"").length,l=l.previousSibling;a+=e?s.startOffset:s.endOffset}else if(o=o.childNodes[e?s.startOffset:s.endOffset])a=domUtils.getNodeIndex(o,t);else{o=e?s.startContainer:s.endContainer;for(var f=o.firstChild;f;)if(domUtils.isFillChar(f))f=f.nextSibling;else if(a++,3==f.nodeType)for(;f&&3==f.nodeType;)f=f.nextSibling;else f=f.nextSibling}else a=e?domUtils.isFillChar(o)?0:s.startOffset:s.endOffset;return 0>a&&(a=0),i.push(a),i}var o={},s=this;return o.startAddress=n(!0),e||(o.endAddress=s.collapsed?[].concat(o.startAddress):n()),o},moveToAddress:function(e,t){function n(e,t){for(var n,s,r,i=o.document.body,d=0,a=e.length;a>d;d++)if(r=e[d],n=i,i=i.childNodes[r],!i){s=r;break}t?i?o.setStartBefore(i):o.setStart(n,s):i?o.setEndBefore(i):o.setEnd(n,s)}var o=this;return n(e.startAddress,!0),!t&&e.endAddress&&n(e.endAddress),o},equals:function(e){for(var t in this)if(this.hasOwnProperty(t)&&this[t]!==e[t])return!1;return!0},traversal:function(e,t){if(this.collapsed)return this;for(var n=this.createBookmark(),o=n.end,s=domUtils.getNextDomNode(n.start,!1,t);s&&s!==o&&domUtils.getPosition(s,o)&domUtils.POSITION_PRECEDING;){var r=domUtils.getNextDomNode(s,!1,t);e(s),s=r}return this.moveToBookmark(n)}}}();
!function(){function t(t,e){var n=domUtils.getNodeIndex;t=t.duplicate(),t.collapse(e);var r=t.parentElement();if(!r.hasChildNodes())return{container:r,offset:0};for(var a,i,o=r.children,s=t.duplicate(),l=0,c=o.length-1,d=-1;c>=l;){d=Math.floor((l+c)/2),a=o[d],s.moveToElementText(a);var h=s.compareEndPoints("StartToStart",t);if(h>0)c=d-1;else{if(!(0>h))return{container:r,offset:n(a)};l=d+1}}if(-1==d){if(s.moveToElementText(r),s.setEndPoint("StartToStart",t),i=s.text.replace(/(\r\n|\r)/g,"\n").length,o=r.childNodes,!i)return a=o[o.length-1],{container:a,offset:a.nodeValue.length};for(var u=o.length;i>0;)i-=o[--u].nodeValue.length;return{container:o[u],offset:-i}}if(s.collapse(h>0),s.setEndPoint(h>0?"StartToStart":"EndToStart",t),i=s.text.replace(/(\r\n|\r)/g,"\n").length,!i)return dtd.$empty[a.tagName]||dtd.$nonChild[a.tagName]?{container:r,offset:n(a)+(h>0?0:1)}:{container:a,offset:h>0?0:a.childNodes.length};for(;i>0;)try{var f=a;a=a[h>0?"previousSibling":"nextSibling"],i-=a.nodeValue.length}catch(g){return{container:r,offset:n(f)}}return{container:a,offset:h>0?-i:a.nodeValue.length+i}}function e(e,n){if(e.item)n.selectNode(e.item(0));else{var r=t(e,!0);n.setStart(r.container,r.offset),0!=e.compareEndPoints("StartToEnd",e)&&(r=t(e,!1),n.setEnd(r.container,r.offset))}return n}function n(t){var e;try{e=t.getNative().createRange()}catch(n){return null}var r=e.item?e.item(0):e.parentElement();return(r.ownerDocument||r)===t.document?e:null}var r=dom.Selection=function(t){var e,r=this;r.document=t,browser.ie9below&&(e=domUtils.getWindow(t).frameElement,domUtils.on(e,"beforedeactivate",function(){r._bakIERange=r.getIERange()}),domUtils.on(e,"activate",function(){try{!n(r)&&r._bakIERange&&r._bakIERange.select()}catch(t){}r._bakIERange=null})),e=t=null};r.prototype={rangeInBody:function(t,e){var n=browser.ie9below||e?t.item?t.item():t.parentElement():t.startContainer;return n===this.document.body||domUtils.inDoc(n,this.document)},getNative:function(){var t=this.document;try{return t?browser.ie9below?t.selection:domUtils.getWindow(t).getSelection():null}catch(e){return null}},getIERange:function(){var t=n(this);return!t&&this._bakIERange?this._bakIERange:t},cache:function(){this.clear(),this._cachedRange=this.getRange(),this._cachedStartElement=this.getStart(),this._cachedStartElementPath=this.getStartElementPath()},getStartElementPath:function(){if(this._cachedStartElementPath)return this._cachedStartElementPath;var t=this.getStart();return t?domUtils.findParents(t,!0,null,!0):[]},clear:function(){this._cachedStartElementPath=this._cachedRange=this._cachedStartElement=null},isFocus:function(){try{if(browser.ie9below){var t=n(this);return!(!t||!this.rangeInBody(t))}return!!this.getNative().rangeCount}catch(e){return!1}},getRange:function(){function t(t){for(var e=n.document.body.firstChild,r=t.collapsed;e&&e.firstChild;)t.setStart(e,0),e=e.firstChild;t.startContainer||t.setStart(n.document.body,0),r&&t.collapse(!0)}var n=this;if(null!=n._cachedRange)return this._cachedRange;var r=new baidu.editor.dom.Range(n.document);if(browser.ie9below){var a=n.getIERange();if(a)try{e(a,r)}catch(i){t(r)}else t(r)}else{var o=n.getNative();if(o&&o.rangeCount){var s=o.getRangeAt(0),l=o.getRangeAt(o.rangeCount-1);r.setStart(s.startContainer,s.startOffset).setEnd(l.endContainer,l.endOffset),r.collapsed&&domUtils.isBody(r.startContainer)&&!r.startOffset&&t(r)}else{if(this._bakRange&&domUtils.inDoc(this._bakRange.startContainer,this.document))return this._bakRange;t(r)}}return this._bakRange=r},getStart:function(){if(this._cachedStartElement)return this._cachedStartElement;var t,e,n,r,a=browser.ie9below?this.getIERange():this.getRange();if(browser.ie9below){if(!a)return this.document.body.firstChild;if(a.item)return a.item(0);for(t=a.duplicate(),t.text.length>0&&t.moveStart("character",1),t.collapse(1),e=t.parentElement(),r=n=a.parentElement();n=n.parentNode;)if(n==e){e=r;break}}else if(a.shrinkBoundary(),e=a.startContainer,1==e.nodeType&&e.hasChildNodes()&&(e=e.childNodes[Math.min(e.childNodes.length-1,a.startOffset)]),3==e.nodeType)return e.parentNode;return e},getText:function(){var t,e;return this.isFocus()&&(t=this.getNative())?(e=browser.ie9below?t.createRange():t.getRangeAt(0),browser.ie9below?e.text:e.toString()):""},clearRange:function(){this.getNative()[browser.ie9below?"empty":"removeAllRanges"]()}}}();
!function(){function e(e,t){var n;if(t.textarea)if(utils.isString(t.textarea)){for(var i,o=0,a=domUtils.getElementsByTagName(e,"textarea");i=a[o++];)if(i.id=="ueditor_textarea_"+t.options.textarea){n=i;break}}else n=t.textarea;n||(e.appendChild(n=domUtils.createElement(document,"textarea",{name:t.options.textarea,id:"ueditor_textarea_"+t.options.textarea,style:"display:none"})),t.textarea=n),!n.getAttribute("name")&&n.setAttribute("name",t.options.textarea),n.value=t.hasContents()?t.options.allHtmlEnabled?t.getAllHtml():t.getContent(null,null,!0):""}function t(e){for(var t in e)return t}function n(e){e.langIsReady=!0,e.fireEvent("langReady")}var i,o=0,a=UE.Editor=function(e){var i=this;i.uid=o++,EventBase.call(i),i.commands={},i.options=utils.extend(utils.clone(e||{}),UEDITOR_CONFIG,!0),i.shortcutkeys={},i.inputRules=[],i.outputRules=[],i.setOpt(a.defaultOptions(i)),i.loadServerConfig(),utils.isEmptyObject(UE.I18N)?utils.loadFile(document,{src:i.options.langPath+i.options.lang+"/"+i.options.lang+".js",tag:"script",type:"text/javascript",defer:"defer"},function(){UE.plugin.load(i),n(i)}):(i.options.lang=t(UE.I18N),UE.plugin.load(i),n(i)),UE.instants["ueditorInstant"+i.uid]=i};a.prototype={registerCommand:function(e,t){this.commands[e]=t},ready:function(e){var t=this;e&&(t.isReady?e.apply(t):t.addListener("ready",e))},setOpt:function(e,t){var n={};utils.isString(e)?n[e]=t:n=e,utils.extend(this.options,n,!0)},getOpt:function(e){return this.options[e]},destroy:function(){var e=this;e.fireEvent("destroy");var t=e.container.parentNode,n=e.textarea;n?n.style.display="":(n=document.createElement("textarea"),t.parentNode.insertBefore(n,t)),n.style.width=e.iframe.offsetWidth+"px",n.style.height=e.iframe.offsetHeight+"px",n.value=e.getContent(),n.id=e.key,t.innerHTML="",domUtils.remove(t);var i=e.key;for(var o in e)e.hasOwnProperty(o)&&delete this[o];UE.delEditor(i)},render:function(e){var t=this,n=t.options,i=function(t){return parseInt(domUtils.getComputedStyle(e,t))};if(utils.isString(e)&&(e=document.getElementById(e)),e){n.minFrameWidth=n.initialFrameWidth?n.initialFrameWidth:n.initialFrameWidth=e.offsetWidth,n.initialFrameHeight?n.minFrameHeight=n.initialFrameHeight:n.initialFrameHeight=n.minFrameHeight=e.offsetHeight,e.style.width=/%$/.test(n.initialFrameWidth)?"100%":n.initialFrameWidth-i("padding-left")-i("padding-right")+"px",e.style.height=/%$/.test(n.initialFrameHeight)?"100%":n.initialFrameHeight-i("padding-top")-i("padding-bottom")+"px",e.style.zIndex=n.zIndex;var o=(ie&&browser.version<9?"":"<!DOCTYPE html>")+"<html xmlns='http://www.w3.org/1999/xhtml' class='view' ><head><style type='text/css'>.view{padding:0;word-wrap:break-word;cursor:text;height:90%;}\nbody{margin:8px;font-family:sans-serif;font-size:16px;}p{margin:5px 0;}</style>"+(n.iframeCssUrl?"<link rel='stylesheet' type='text/css' href='"+utils.unhtml(n.iframeCssUrl)+"'/>":"")+(n.initialStyle?"<style>"+n.initialStyle+"</style>":"")+"</head><body class='view' ></body><script type='text/javascript' "+(ie?"defer='defer'":"")+" id='_initialScript'>setTimeout(function(){editor = window.parent.UE.instants['ueditorInstant"+t.uid+"'];editor._setup(document);},0);var _tmpScript = document.getElementById('_initialScript');_tmpScript.parentNode.removeChild(_tmpScript);</script></html>";e.appendChild(domUtils.createElement(document,"iframe",{id:"ueditor_"+t.uid,width:"100%",height:"100%",frameborder:"0",src:"javascript:void(function(){document.open();"+(n.customDomain&&document.domain!=location.hostname?'document.domain="'+document.domain+'";':"")+'document.write("'+o+'");document.close();}())'})),e.style.overflow="hidden",setTimeout(function(){/%$/.test(n.initialFrameWidth)&&(n.minFrameWidth=n.initialFrameWidth=e.offsetWidth),/%$/.test(n.initialFrameHeight)&&(n.minFrameHeight=n.initialFrameHeight=e.offsetHeight,e.style.height=n.initialFrameHeight+"px")})}},_setup:function(t){var n=this,i=n.options;ie?(t.body.disabled=!0,t.body.contentEditable=!0,t.body.disabled=!1):t.body.contentEditable=!0,t.body.spellcheck=!1,n.document=t,n.window=t.defaultView||t.parentWindow,n.iframe=n.window.frameElement,n.body=t.body,n.selection=new dom.Selection(t);var o;browser.gecko&&(o=this.selection.getNative())&&o.removeAllRanges(),this._initEvents();for(var a=this.iframe.parentNode;!domUtils.isBody(a);a=a.parentNode)if("FORM"==a.tagName){n.form=a,n.options.autoSyncData?domUtils.on(n.window,"blur",function(){e(a,n)}):domUtils.on(a,"submit",function(){e(this,n)});break}if(i.initialContent)if(i.autoClearinitialContent){var r=n.execCommand;n.execCommand=function(){return n.fireEvent("firstBeforeExecCommand"),r.apply(n,arguments)},this._setDefaultContent(i.initialContent)}else this.setContent(i.initialContent,!1,!0);domUtils.isEmptyNode(n.body)&&(n.body.innerHTML="<p>"+(browser.ie?"":"<br/>")+"</p>"),i.focus&&setTimeout(function(){n.focus(n.options.focusInEnd),!n.options.autoClearinitialContent&&n._selectionChange()},0),n.container||(n.container=this.iframe.parentNode),i.fullscreen&&n.ui&&n.ui.setFullScreen(!0);try{n.document.execCommand("2D-position",!1,!1)}catch(s){}try{n.document.execCommand("enableInlineTableEditing",!1,!1)}catch(s){}try{n.document.execCommand("enableObjectResizing",!1,!1)}catch(s){}n._bindshortcutKeys(),n.isReady=1,n.fireEvent("ready"),i.onready&&i.onready.call(n),browser.ie9below||domUtils.on(n.window,["blur","focus"],function(e){if("blur"==e.type){n._bakRange=n.selection.getRange();try{n._bakNativeRange=n.selection.getNative().getRangeAt(0),n.selection.getNative().removeAllRanges()}catch(e){n._bakNativeRange=null}}else try{n._bakRange&&n._bakRange.select()}catch(e){}}),browser.gecko&&browser.version<=10902&&(n.body.contentEditable=!1,setTimeout(function(){n.body.contentEditable=!0},100),setInterval(function(){n.body.style.height=n.iframe.offsetHeight-20+"px"},100)),!i.isShow&&n.setHide(),i.readonly&&n.setDisabled()},sync:function(t){var n=this,i=t?document.getElementById(t):domUtils.findParent(n.iframe.parentNode,function(e){return"FORM"==e.tagName},!0);i&&e(i,n)},setHeight:function(e,t){e!==parseInt(this.iframe.parentNode.style.height)&&(this.iframe.parentNode.style.height=e+"px"),!t&&(this.options.minFrameHeight=this.options.initialFrameHeight=e),this.body.style.height=e+"px",!t&&this.trigger("setHeight")},addshortcutkey:function(e,t){var n={};t?n[e]=t:n=e,utils.extend(this.shortcutkeys,n)},_bindshortcutKeys:function(){var e=this,t=this.shortcutkeys;e.addListener("keydown",function(n,i){var o=i.keyCode||i.which;for(var a in t)for(var r,s=t[a].split(","),l=0;r=s[l++];){r=r.split(":");var d=r[0],c=r[1];(/^(ctrl)(\+shift)?\+(\d+)$/.test(d.toLowerCase())||/^(\d+)$/.test(d))&&(("ctrl"==RegExp.$1?i.ctrlKey||i.metaKey:0)&&(""!=RegExp.$2?i[RegExp.$2.slice(1)+"Key"]:1)&&o==RegExp.$3||o==RegExp.$1)&&(-1!=e.queryCommandState(a,c)&&e.execCommand(a,c),domUtils.preventDefault(i))}})},getContent:function(e,t,n,i,o){var a=this;if(e&&utils.isFunction(e)&&(t=e,e=""),t?!t():!this.hasContents())return"";a.fireEvent("beforegetcontent");var r=UE.htmlparser(a.body.innerHTML,i);return a.filterOutputRule(r),a.fireEvent("aftergetcontent",e,r),r.toHtml(o)},getAllHtml:function(){var e=this,t=[];if(e.fireEvent("getAllHtml",t),browser.ie&&browser.version>8){var n="";utils.each(e.document.styleSheets,function(e){n+=e.href?'<link rel="stylesheet" type="text/css" href="'+e.href+'" />':"<style>"+e.cssText+"</style>"}),utils.each(e.document.getElementsByTagName("script"),function(e){n+=e.outerHTML})}return"<html><head>"+(e.options.charset?'<meta http-equiv="Content-Type" content="text/html; charset='+e.options.charset+'"/>':"")+(n||e.document.getElementsByTagName("head")[0].innerHTML)+t.join("\n")+"</head><body "+(ie&&browser.version<9?'class="view"':"")+">"+e.getContent(null,null,!0)+"</body></html>"},getPlainTxt:function(){var e=new RegExp(domUtils.fillChar,"g"),t=this.body.innerHTML.replace(/[\n\r]/g,"");return t=t.replace(/<(p|div)[^>]*>(<br\/?>|&nbsp;)<\/\1>/gi,"\n").replace(/<br\/?>/gi,"\n").replace(/<[^>/]+>/g,"").replace(/(\n)?<\/([^>]+)>/g,function(e,t,n){return dtd.$block[n]?"\n":t?t:""}),t.replace(e,"").replace(/\u00a0/g," ").replace(/&nbsp;/g," ")},getContentTxt:function(){var e=new RegExp(domUtils.fillChar,"g");return this.body[browser.ie?"innerText":"textContent"].replace(e,"").replace(/\u00a0/g," ")},setContent:function(t,n,i){function o(e){return"DIV"==e.tagName&&e.getAttribute("cdata_tag")}var a=this;a.fireEvent("beforesetcontent",t);var r=UE.htmlparser(t);if(a.filterInputRule(r),t=r.toHtml(),a.body.innerHTML=(n?a.body.innerHTML:"")+t,"p"==a.options.enterTag){var s,l=this.body.firstChild;if(!l||1==l.nodeType&&(dtd.$cdata[l.tagName]||o(l)||domUtils.isCustomeNode(l))&&l===this.body.lastChild)this.body.innerHTML="<p>"+(browser.ie?"&nbsp;":"<br/>")+"</p>"+this.body.innerHTML;else for(var d=a.document.createElement("p");l;){for(;l&&(3==l.nodeType||1==l.nodeType&&dtd.p[l.tagName]&&!dtd.$cdata[l.tagName]);)s=l.nextSibling,d.appendChild(l),l=s;if(d.firstChild){if(!l){a.body.appendChild(d);break}l.parentNode.insertBefore(d,l),d=a.document.createElement("p")}l=l.nextSibling}}a.fireEvent("aftersetcontent"),a.fireEvent("contentchange"),!i&&a._selectionChange(),a._bakRange=a._bakIERange=a._bakNativeRange=null;var c;browser.gecko&&(c=this.selection.getNative())&&c.removeAllRanges(),a.options.autoSyncData&&a.form&&e(a.form,a)},focus:function(e){try{var t=this,n=t.selection.getRange();if(e){var i=t.body.lastChild;i&&1==i.nodeType&&!dtd.$empty[i.tagName]&&(domUtils.isEmptyBlock(i)?n.setStartAtFirst(i):n.setStartAtLast(i),n.collapse(!0)),n.setCursor(!0)}else{if(!n.collapsed&&domUtils.isBody(n.startContainer)&&0==n.startOffset){var i=t.body.firstChild;i&&1==i.nodeType&&!dtd.$empty[i.tagName]&&n.setStartAtFirst(i).collapse(!0)}n.select(!0)}this.fireEvent("focus selectionchange")}catch(o){}},isFocus:function(){return this.selection.isFocus()},blur:function(){var e=this.selection.getNative();if(e.empty&&browser.ie){var t=document.body.createTextRange();t.moveToElementText(document.body),t.collapse(!0),t.select(),e.empty()}else e.removeAllRanges()},_initEvents:function(){var e=this,t=e.document,n=e.window;e._proxyDomEvent=utils.bind(e._proxyDomEvent,e),domUtils.on(t,["click","contextmenu","mousedown","keydown","keyup","keypress","mouseup","mouseover","mouseout","selectstart"],e._proxyDomEvent),domUtils.on(n,["focus","blur"],e._proxyDomEvent),domUtils.on(e.body,"drop",function(t){browser.gecko&&t.stopPropagation&&t.stopPropagation(),e.fireEvent("contentchange")}),domUtils.on(t,["mouseup","keydown"],function(t){"keydown"==t.type&&(t.ctrlKey||t.metaKey||t.shiftKey||t.altKey)||2!=t.button&&e._selectionChange(250,t)})},_proxyDomEvent:function(e){return this.fireEvent("before"+e.type.replace(/^on/,"").toLowerCase())===!1?!1:this.fireEvent(e.type.replace(/^on/,""),e)===!1?!1:this.fireEvent("after"+e.type.replace(/^on/,"").toLowerCase())},_selectionChange:function(e,t){var n,o,a=this,r=!1;if(browser.ie&&browser.version<9&&t&&"mouseup"==t.type){var s=this.selection.getRange();s.collapsed||(r=!0,n=t.clientX,o=t.clientY)}clearTimeout(i),i=setTimeout(function(){if(a.selection&&a.selection.getNative()){var e;if(r&&"None"==a.selection.getNative().type){e=a.document.body.createTextRange();try{e.moveToPoint(n,o)}catch(i){e=null}}var s;e&&(s=a.selection.getIERange,a.selection.getIERange=function(){return e}),a.selection.cache(),s&&(a.selection.getIERange=s),a.selection._cachedRange&&a.selection._cachedStartElement&&(a.fireEvent("beforeselectionchange"),a.fireEvent("selectionchange",!!t),a.fireEvent("afterselectionchange"),a.selection.clear())}},e||50)},_callCmdFn:function(e,t){var n,i,o=t[0].toLowerCase();return n=this.commands[o]||UE.commands[o],i=n&&n[e],n&&i||"queryCommandState"!=e?i?i.apply(this,t):void 0:0},execCommand:function(e){e=e.toLowerCase();var t,n=this,i=n.commands[e]||UE.commands[e];return i&&i.execCommand?(i.notNeedUndo||n.__hasEnterExecCommand?(t=this._callCmdFn("execCommand",arguments),!n.__hasEnterExecCommand&&!i.ignoreContentChange&&!n._ignoreContentChange&&n.fireEvent("contentchange")):(n.__hasEnterExecCommand=!0,-1!=n.queryCommandState.apply(n,arguments)&&(n.fireEvent("saveScene"),n.fireEvent.apply(n,["beforeexeccommand",e].concat(arguments)),t=this._callCmdFn("execCommand",arguments),n.fireEvent.apply(n,["afterexeccommand",e].concat(arguments)),n.fireEvent("saveScene")),n.__hasEnterExecCommand=!1),!n.__hasEnterExecCommand&&!i.ignoreContentChange&&!n._ignoreContentChange&&n._selectionChange(),t):null},queryCommandState:function(e){return this._callCmdFn("queryCommandState",arguments)},queryCommandValue:function(e){return this._callCmdFn("queryCommandValue",arguments)},hasContents:function(e){if(e)for(var t,n=0;t=e[n++];)if(this.document.getElementsByTagName(t).length>0)return!0;if(!domUtils.isEmptyBlock(this.body))return!0;for(e=["div"],n=0;t=e[n++];)for(var i,o=domUtils.getElementsByTagName(this.document,t),a=0;i=o[a++];)if(domUtils.isCustomeNode(i))return!0;return!1},reset:function(){this.fireEvent("reset")},setEnabled:function(){var e,t=this;if("false"==t.body.contentEditable){t.body.contentEditable=!0,e=t.selection.getRange();try{e.moveToBookmark(t.lastBk),delete t.lastBk}catch(n){e.setStartAtFirst(t.body).collapse(!0)}e.select(!0),t.bkqueryCommandState&&(t.queryCommandState=t.bkqueryCommandState,delete t.bkqueryCommandState),t.bkqueryCommandValue&&(t.queryCommandValue=t.bkqueryCommandValue,delete t.bkqueryCommandValue),t.fireEvent("selectionchange")}},enable:function(){return this.setEnabled()},setDisabled:function(e){var t=this;e=e?utils.isArray(e)?e:[e]:[],"true"==t.body.contentEditable&&(t.lastBk||(t.lastBk=t.selection.getRange().createBookmark(!0)),t.body.contentEditable=!1,t.bkqueryCommandState=t.queryCommandState,t.bkqueryCommandValue=t.queryCommandValue,t.queryCommandState=function(n){return-1!=utils.indexOf(e,n)?t.bkqueryCommandState.apply(t,arguments):-1},t.queryCommandValue=function(n){return-1!=utils.indexOf(e,n)?t.bkqueryCommandValue.apply(t,arguments):null},t.fireEvent("selectionchange"))},disable:function(e){return this.setDisabled(e)},_setDefaultContent:function(){function e(){var t=this;t.document.getElementById("initContent")&&(t.body.innerHTML="<p>"+(ie?"":"<br/>")+"</p>",t.removeListener("firstBeforeExecCommand focus",e),setTimeout(function(){t.focus(),t._selectionChange()},0))}return function(t){var n=this;n.body.innerHTML='<p id="initContent">'+t+"</p>",n.addListener("firstBeforeExecCommand focus",e)}}(),setShow:function(){var e=this,t=e.selection.getRange();if("none"==e.container.style.display){try{t.moveToBookmark(e.lastBk),delete e.lastBk}catch(n){t.setStartAtFirst(e.body).collapse(!0)}setTimeout(function(){t.select(!0)},100),e.container.style.display=""}},show:function(){return this.setShow()},setHide:function(){var e=this;e.lastBk||(e.lastBk=e.selection.getRange().createBookmark(!0)),e.container.style.display="none"},hide:function(){return this.setHide()},getLang:function(e){var t=UE.I18N[this.options.lang];if(!t)throw Error("not import language file");e=(e||"").split(".");for(var n,i=0;(n=e[i++])&&(t=t[n],t););return t},getContentLength:function(e,t){var n=this.getContent(!1,!1,!0).length;if(e){t=(t||[]).concat(["hr","img","iframe"]),n=this.getContentTxt().replace(/[\t\r\n]+/g,"").length;for(var i,o=0;i=t[o++];)n+=this.document.getElementsByTagName(i).length}return n},addInputRule:function(e){this.inputRules.push(e)},filterInputRule:function(e){for(var t,n=0;t=this.inputRules[n++];)t.call(this,e)},addOutputRule:function(e){this.outputRules.push(e)},filterOutputRule:function(e){for(var t,n=0;t=this.outputRules[n++];)t.call(this,e)},getActionUrl:function(e){var t=this.getOpt(e)||e,n=this.getOpt("imageUrl"),i=this.getOpt("serverUrl");return!i&&n&&(i=n.replace(/^(.*[\/]).+([\.].+)$/,"$1controller$2")),i?(i=i+(-1==i.indexOf("?")?"?":"&")+"action="+(t||""),utils.formatUrl(i)):""}},utils.inherits(a,EventBase)}();
UE.Editor.defaultOptions=function(e){var t=e.options.UEDITOR_HOME_URL;return{isShow:!0,initialContent:"",initialStyle:"",autoClearinitialContent:!1,iframeCssUrl:t+"themes/iframe.css",textarea:"editorValue",focus:!1,focusInEnd:!0,autoClearEmptyNode:!0,fullscreen:!1,readonly:!1,zIndex:999,imagePopup:!0,enterTag:"p",customDomain:!1,lang:"zh-cn",langPath:t+"lang/",theme:"default",themePath:t+"themes/",allHtmlEnabled:!1,scaleEnabled:!1,tableNativeEditInFF:!1,autoSyncData:!0,fileNameFormat:"{time}{rand:6}"}};
!function(){UE.Editor.prototype.loadServerConfig=function(){function showErrorMsg(o){console&&console.error(o)}var me=this;setTimeout(function(){try{me.options.imageUrl&&me.setOpt("serverUrl",me.options.imageUrl.replace(/^(.*[\/]).+([\.].+)$/,"$1controller$2"));var configUrl=me.getActionUrl("config"),isJsonp=utils.isCrossDomainUrl(configUrl);me._serverConfigLoaded=!1,configUrl&&UE.ajax.request(configUrl,{method:"GET",dataType:isJsonp?"jsonp":"",onsuccess:function(r){try{var config=isJsonp?r:eval("("+r.responseText+")");utils.extend(me.options,config),me.fireEvent("serverConfigLoaded"),me._serverConfigLoaded=!0}catch(e){showErrorMsg(me.getLang("loadconfigFormatError"))}},onerror:function(){showErrorMsg(me.getLang("loadconfigHttpError"))}})}catch(e){showErrorMsg(me.getLang("loadconfigError"))}})},UE.Editor.prototype.isServerConfigLoaded=function(){var o=this;return o._serverConfigLoaded||!1},UE.Editor.prototype.afterConfigReady=function(o){if(o&&utils.isFunction(o)){var r=this,e=function(){o.apply(r,arguments),r.removeListener("serverConfigLoaded",e)};r.isServerConfigLoaded()?o.call(r,"serverConfigLoaded"):r.addListener("serverConfigLoaded",e)}}}();
UE.ajax=function(){function e(e){var t=[];for(var n in e)if("method"!=n&&"timeout"!=n&&"async"!=n&&"dataType"!=n&&"callback"!=n&&void 0!=e[n]&&null!=e[n])if("function"!=(typeof e[n]).toLowerCase()&&"object"!=(typeof e[n]).toLowerCase())t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));else if(utils.isArray(e[n]))for(var o=0;o<e[n].length;o++)t.push(encodeURIComponent(n)+"[]="+encodeURIComponent(e[n][o]));return t.join("&")}function t(t,n){var o=a(),r=!1,c={method:"POST",timeout:5e3,async:!0,data:{},onsuccess:function(){},onerror:function(){}};if("object"==typeof t&&(n=t,t=n.url),o&&t){var i=n?utils.extend(c,n):c,s=e(i);utils.isEmptyObject(i.data)||(s+=(s?"&":"")+e(i.data));var u=setTimeout(function(){4!=o.readyState&&(r=!0,o.abort(),clearTimeout(u))},i.timeout),d=i.method.toUpperCase(),l=t+(-1==t.indexOf("?")?"?":"&")+("POST"==d?"":s+"&noCache="+ +new Date);o.open(d,l,i.async),o.onreadystatechange=function(){4==o.readyState&&(r||200!=o.status?i.onerror(o):i.onsuccess(o))},"POST"==d?(o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),o.send(s)):o.send(null)}}function n(t,n){function o(e,t,n){e.setAttribute("type","text/javascript"),e.setAttribute("defer","defer"),n&&e.setAttribute("charset",n),e.setAttribute("src",t),document.getElementsByTagName("head")[0].appendChild(e)}function r(e){return function(){try{if(e)d.onerror&&d.onerror();else try{clearTimeout(c),s.apply(window,arguments)}catch(t){}}catch(n){d.onerror&&d.onerror.call(window,n)}finally{d.oncomplete&&d.oncomplete.apply(window,arguments),u.parentNode&&u.parentNode.removeChild(u),window[a]=null;try{delete window[a]}catch(t){}}}}var a,c,i,s=n.onsuccess||function(){},u=document.createElement("SCRIPT"),d=n||{},l=d.charset,p=d.jsonp||"callback",f=d.timeOut||0,m=new RegExp("(\\?|&)"+p+"=([^&]*)");utils.isFunction(s)?(a="bd__editor__"+Math.floor(2147483648*Math.random()).toString(36),window[a]=r(0)):utils.isString(s)?a=s:(i=m.exec(t))&&(a=i[2]),t=t.replace(m,"$1"+p+"="+a),t.search(m)<0&&(t+=(t.indexOf("?")<0?"?":"&")+p+"="+a);var y=e(n);utils.isEmptyObject(n.data)||(y+=(y?"&":"")+e(n.data)),y&&(t=t.replace(/\?/,"?"+y+"&")),u.onerror=r(1),f&&(c=setTimeout(r(1),f)),o(u,t,l)}var o="XMLHttpRequest()";try{new ActiveXObject("Msxml2.XMLHTTP"),o="ActiveXObject('Msxml2.XMLHTTP')"}catch(r){try{new ActiveXObject("Microsoft.XMLHTTP"),o="ActiveXObject('Microsoft.XMLHTTP')"}catch(r){}}var a=new Function("return new "+o);return{request:function(e,o){o&&"jsonp"==o.dataType?n(e,o):t(e,o)},getJSONP:function(e,t,o){var r={data:t,oncomplete:o};n(e,r)}}}();
var filterWord=UE.filterWord=function(){function e(e){return/(class="?Mso|style="[^"]*\bmso\-|w:WordDocument|<(v|o):|lang=)/gi.test(e)}function t(e){return e=e.replace(/[\d.]+\w+/g,function(e){return utils.transUnitToPx(e)})}function a(e){return e.replace(/[\t\r\n]+/g," ").replace(/<!--[\s\S]*?-->/gi,"").replace(/<v:shape [^>]*>[\s\S]*?.<\/v:shape>/gi,function(e){if(browser.opera)return"";try{if(/Bitmap/i.test(e))return"";var a=e.match(/width:([ \d.]*p[tx])/i)[1],n=e.match(/height:([ \d.]*p[tx])/i)[1],s=e.match(/src=\s*"([^"]*)"/i)[1];return'<img width="'+t(a)+'" height="'+t(n)+'" src="'+s+'" />'}catch(i){return""}}).replace(/<\/?div[^>]*>/g,"").replace(/v:\w+=(["']?)[^'"]+\1/g,"").replace(/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|xml|meta|link|style|\w+:\w+)(?=[\s\/>]))[^>]*>/gi,"").replace(/<p [^>]*class="?MsoHeading"?[^>]*>(.*?)<\/p>/gi,"<p><strong>$1</strong></p>").replace(/\s+(class|lang|align)\s*=\s*(['"]?)([\w-]+)\2/gi,function(e,t,a,n){return"class"==t&&"MsoListParagraph"==n?e:""}).replace(/<(font|span)[^>]*>(\s*)<\/\1>/gi,function(e,t,a){return a.replace(/[\t\r\n ]+/g," ")}).replace(/(<[a-z][^>]*)\sstyle=(["'])([^\2]*?)\2/gi,function(e,a,n,s){for(var i,r=[],o=s.replace(/^\s+|\s+$/,"").replace(/&#39;/g,"'").replace(/&quot;/gi,"'").replace(/[\d.]+(cm|pt)/g,function(e){return utils.transUnitToPx(e)}).split(/;\s*/g),c=0;i=o[c];c++){var l,g,u=i.split(":");if(2==u.length){if(l=u[0].toLowerCase(),g=u[1].toLowerCase(),/^(background)\w*/.test(l)&&0==g.replace(/(initial|\s)/g,"").length||/^(margin)\w*/.test(l)&&/^0\w+$/.test(g))continue;switch(l){case"mso-padding-alt":case"mso-padding-top-alt":case"mso-padding-right-alt":case"mso-padding-bottom-alt":case"mso-padding-left-alt":case"mso-margin-alt":case"mso-margin-top-alt":case"mso-margin-right-alt":case"mso-margin-bottom-alt":case"mso-margin-left-alt":case"mso-height":case"mso-width":case"mso-vertical-align-alt":/<table/.test(a)||(r[c]=l.replace(/^mso-|-alt$/g,"")+":"+t(g));continue;case"horiz-align":r[c]="text-align:"+g;continue;case"vert-align":r[c]="vertical-align:"+g;continue;case"font-color":case"mso-foreground":r[c]="color:"+g;continue;case"mso-background":case"mso-highlight":r[c]="background:"+g;continue;case"mso-default-height":r[c]="min-height:"+t(g);continue;case"mso-default-width":r[c]="min-width:"+t(g);continue;case"mso-padding-between-alt":r[c]="border-collapse:separate;border-spacing:"+t(g);continue;case"text-line-through":("single"==g||"double"==g)&&(r[c]="text-decoration:line-through");continue;case"mso-zero-height":"yes"==g&&(r[c]="display:none");continue;case"margin":if(!/[1-9]/.test(g))continue}if(/^(mso|column|font-emph|lang|layout|line-break|list-image|nav|panose|punct|row|ruby|sep|size|src|tab-|table-border|text-(?:decor|trans)|top-bar|version|vnd|word-break)/.test(l)||/text\-indent|padding|margin/.test(l)&&/\-[\d.]+/.test(g))continue;r[c]=l+":"+u[1]}}return a+(r.length?' style="'+r.join(";").replace(/;{2,}/g,";")+'"':"")})}return function(t){return e(t)?a(t):t}}();
!function(){function t(t,e,i){return t.push(f),e+(i?1:-1)}function e(t,e){for(var i=0;e>i;i++)t.push(u)}function i(l,a,s,d){switch(l.type){case"root":for(var c,o=0;c=l.children[o++];)s&&"element"==c.type&&!dtd.$inlineWithA[c.tagName]&&o>1&&(t(a,d,!0),e(a,d)),i(c,a,s,d);break;case"text":r(l,a);break;case"element":n(l,a,s,d);break;case"comment":h(l,a,s)}return a}function r(t,e){e.push("pre"==t.parentNode.tagName?t.data:o[t.parentNode.tagName]?utils.html(t.data):t.data.replace(/[ ]{2}/g," &nbsp;"))}function n(r,n,h,l){var a="";if(r.attrs){a=[];var s=r.attrs;for(var d in s)a.push(d+(void 0!==s[d]?'="'+(c[d]?utils.html(s[d]).replace(/["]/g,function(t){return"&quot;"}):utils.unhtml(s[d]))+'"':""));a=a.join(" ")}if(n.push("<"+r.tagName+(a?" "+a:"")+(dtd.$empty[r.tagName]?"/":"")+">"),h&&!dtd.$inlineWithA[r.tagName]&&"pre"!=r.tagName&&r.children&&r.children.length&&(l=t(n,l,!0),e(n,l)),r.children&&r.children.length)for(var o,u=0;o=r.children[u++];)h&&"element"==o.type&&!dtd.$inlineWithA[o.tagName]&&u>1&&(t(n,l),e(n,l)),i(o,n,h,l);dtd.$empty[r.tagName]||(h&&!dtd.$inlineWithA[r.tagName]&&"pre"!=r.tagName&&r.children&&r.children.length&&(l=t(n,l),e(n,l)),n.push("</"+r.tagName+">"))}function h(t,e){e.push("<!--"+t.data+"-->")}function l(t,e){var i;if("element"==t.type&&t.getAttr("id")==e)return t;if(t.children&&t.children.length)for(var r,n=0;r=t.children[n++];)if(i=l(r,e))return i}function a(t,e,i){if("element"==t.type&&t.tagName==e&&i.push(t),t.children&&t.children.length)for(var r,n=0;r=t.children[n++];)a(r,e,i)}function s(t,e){if(t.children&&t.children.length)for(var i,r=0;i=t.children[r];)s(i,e),i.parentNode&&(i.children&&i.children.length&&e(i),i.parentNode&&r++);else e(t)}var d=UE.uNode=function(t){this.type=t.type,this.data=t.data,this.tagName=t.tagName,this.parentNode=t.parentNode,this.attrs=t.attrs||{},this.children=t.children},c={href:1,src:1,_src:1,_href:1,cdata_data:1},o={style:1,script:1},u="    ",f="\n";d.createElement=function(t){return/[<>]/.test(t)?UE.htmlparser(t).children[0]:new d({type:"element",children:[],tagName:t})},d.createText=function(t,e){return new UE.uNode({type:"text",data:e?t:utils.unhtml(t||"")})},d.prototype={toHtml:function(t){var e=[];return i(this,e,t,0),e.join("")},innerHTML:function(t){if("element"!=this.type||dtd.$empty[this.tagName])return this;if(utils.isString(t)){if(this.children)for(var e,i=0;e=this.children[i++];)e.parentNode=null;this.children=[];for(var e,r=UE.htmlparser(t),i=0;e=r.children[i++];)this.children.push(e),e.parentNode=this;return this}var r=new UE.uNode({type:"root",children:this.children});return r.toHtml()},innerText:function(t,e){if("element"!=this.type||dtd.$empty[this.tagName])return this;if(t){if(this.children)for(var i,r=0;i=this.children[r++];)i.parentNode=null;return this.children=[],this.appendChild(d.createText(t,e)),this}return this.toHtml().replace(/<[^>]+>/g,"")},getData:function(){return"element"==this.type?"":this.data},firstChild:function(){return this.children?this.children[0]:null},lastChild:function(){return this.children?this.children[this.children.length-1]:null},previousSibling:function(){for(var t,e=this.parentNode,i=0;t=e.children[i];i++)if(t===this)return 0==i?null:e.children[i-1]},nextSibling:function(){for(var t,e=this.parentNode,i=0;t=e.children[i++];)if(t===this)return e.children[i]},replaceChild:function(t,e){if(this.children){t.parentNode&&t.parentNode.removeChild(t);for(var i,r=0;i=this.children[r];r++)if(i===e)return this.children.splice(r,1,t),e.parentNode=null,t.parentNode=this,t}},appendChild:function(t){if("root"==this.type||"element"==this.type&&!dtd.$empty[this.tagName]){this.children||(this.children=[]),t.parentNode&&t.parentNode.removeChild(t);for(var e,i=0;e=this.children[i];i++)if(e===t){this.children.splice(i,1);break}return this.children.push(t),t.parentNode=this,t}},insertBefore:function(t,e){if(this.children){t.parentNode&&t.parentNode.removeChild(t);for(var i,r=0;i=this.children[r];r++)if(i===e)return this.children.splice(r,0,t),t.parentNode=this,t}},insertAfter:function(t,e){if(this.children){t.parentNode&&t.parentNode.removeChild(t);for(var i,r=0;i=this.children[r];r++)if(i===e)return this.children.splice(r+1,0,t),t.parentNode=this,t}},removeChild:function(t,e){if(this.children)for(var i,r=0;i=this.children[r];r++)if(i===t){if(this.children.splice(r,1),i.parentNode=null,e&&i.children&&i.children.length)for(var n,h=0;n=i.children[h];h++)this.children.splice(r+h,0,n),n.parentNode=this;return i}},getAttr:function(t){return this.attrs&&this.attrs[t.toLowerCase()]},setAttr:function(t,e){if(!t)return void delete this.attrs;if(this.attrs||(this.attrs={}),utils.isObject(t))for(var i in t)t[i]?this.attrs[i.toLowerCase()]=t[i]:delete this.attrs[i];else e?this.attrs[t.toLowerCase()]=e:delete this.attrs[t]},getIndex:function(){for(var t,e=this.parentNode,i=0;t=e.children[i];i++)if(t===this)return i;return-1},getNodeById:function(t){var e;if(this.children&&this.children.length)for(var i,r=0;i=this.children[r++];)if(e=l(i,t))return e},getNodesByTagName:function(t){t=utils.trim(t).replace(/[ ]{2,}/g," ").split(" ");var e=[],i=this;return utils.each(t,function(t){if(i.children&&i.children.length)for(var r,n=0;r=i.children[n++];)a(r,t,e)}),e},getStyle:function(t){var e=this.getAttr("style");if(!e)return"";var i=new RegExp("(^|;)\\s*"+t+":([^;]+)","i"),r=e.match(i);return r&&r[0]?r[2]:""},setStyle:function(t,e){function i(t,e){var i=new RegExp("(^|;)\\s*"+t+":([^;]+;?)","gi");r=r.replace(i,"$1"),e&&(r=t+":"+utils.unhtml(e)+";"+r)}var r=this.getAttr("style");if(r||(r=""),utils.isObject(t))for(var n in t)i(n,t[n]);else i(t,e);this.setAttr("style",utils.trim(r))},traversal:function(t){return this.children&&this.children.length&&s(this,t),this}}}();
var htmlparser=UE.htmlparser=function(e,t){function a(e,t){if(f[e.tagName]){var a=p.createElement(f[e.tagName]);e.appendChild(a),a.appendChild(p.createText(t)),e=a}else e.appendChild(p.createText(t))}function r(e,t,a){var n;if(n=c[t]){for(var o,d=e;"root"!=d.type;){if(utils.isArray(n)?-1!=utils.indexOf(n,d.tagName):n==d.tagName){e=d,o=!0;break}d=d.parentNode}o||(e=r(e,utils.isArray(n)?n[0]:n))}var i=new p({parentNode:e,type:"element",tagName:t.toLowerCase(),children:dtd.$empty[t]?null:[]});if(a){for(var f,m={};f=l.exec(a);)m[f[1].toLowerCase()]=s[f[1].toLowerCase()]?f[2]||f[3]||f[4]:utils.unhtml(f[2]||f[3]||f[4]);i.attrs=m}return e.children.push(i),dtd.$empty[t]?e:i}function n(e,t){e.children.push(new p({type:"comment",data:t,parentNode:e}))}var o=/<(?:(?:\/([^>]+)>)|(?:!--([\S|\s]*?)-->)|(?:([^\s\/<>]+)\s*((?:(?:"[^"]*")|(?:'[^']*')|[^"'<>])*)\/?>))/g,l=/([\w\-:.]+)(?:(?:\s*=\s*(?:(?:"([^"]*)")|(?:'([^']*)')|([^\s>]+)))|(?=\s|$))/g,d={b:1,code:1,i:1,u:1,strike:1,s:1,tt:1,strong:1,q:1,samp:1,em:1,span:1,sub:1,img:1,sup:1,font:1,big:1,small:1,iframe:1,a:1,br:1,pre:1};e=e.replace(new RegExp(domUtils.fillChar,"g"),""),t||(e=e.replace(new RegExp("[\\r\\t\\n"+(t?"":" ")+"]*</?(\\w+)\\s*(?:[^>]*)>[\\r\\t\\n"+(t?"":" ")+"]*","g"),function(e,a){return a&&d[a.toLowerCase()]?e.replace(/(^[\n\r]+)|([\n\r]+$)/g,""):e.replace(new RegExp("^[\\r\\n"+(t?"":" ")+"]+"),"").replace(new RegExp("[\\r\\n"+(t?"":" ")+"]+$"),"")}));for(var i,s={href:1,src:1},p=UE.uNode,c={td:"tr",tr:["tbody","thead","tfoot"],tbody:"table",th:"tr",thead:"table",tfoot:"table",caption:"table",li:["ul","ol"],dt:"dl",dd:"dl",option:"select"},f={ol:"li",ul:"li"},m=0,u=0,g=new p({type:"root",children:[]}),h=g;i=o.exec(e);){m=i.index;try{if(m>u&&a(h,e.slice(u,m)),i[3])dtd.$cdata[h.tagName]?a(h,i[0]):h=r(h,i[3].toLowerCase(),i[4]);else if(i[1]){if("root"!=h.type)if(dtd.$cdata[h.tagName]&&!dtd.$cdata[i[1]])a(h,i[0]);else{for(var w=h;"element"==h.type&&h.tagName!=i[1].toLowerCase();)if(h=h.parentNode,"root"==h.type)throw h=w,"break";h=h.parentNode}}else i[2]&&n(h,i[2])}catch(y){}u=o.lastIndex}return u<e.length&&a(h,e.slice(u)),g};
var filterNode=UE.filterNode=function(){function e(r,t){switch(r.type){case"text":break;case"element":var a;if(a=t[r.tagName])if("-"===a)r.parentNode.removeChild(r);else if(utils.isFunction(a)){var i=r.parentNode,n=r.getIndex();if(a(r),r.parentNode){if(r.children)for(var o,d=0;o=r.children[d];)e(o,t),o.parentNode&&d++}else for(var o,d=n;o=i.children[d];)e(o,t),o.parentNode&&d++}else{var l=a.$;if(l&&r.attrs){var f,c={};for(var s in l){if(f=r.getAttr(s),"style"==s&&utils.isArray(l[s])){var v=[];utils.each(l[s],function(e){var t;(t=r.getStyle(e))&&v.push(e+":"+t)}),f=v.join(";")}f&&(c[s]=f)}r.attrs=c}if(r.children)for(var o,d=0;o=r.children[d];)e(o,t),o.parentNode&&d++}else if(dtd.$cdata[r.tagName])r.parentNode.removeChild(r);else{var i=r.parentNode,n=r.getIndex();r.parentNode.removeChild(r,!0);for(var o,d=n;o=i.children[d];)e(o,t),o.parentNode&&d++}break;case"comment":r.parentNode.removeChild(r)}}return function(r,t){if(utils.isEmptyObject(t))return r;var a;(a=t["-"])&&utils.each(a.split(" "),function(e){t[e]="-"});for(var i,n=0;i=r.children[n];)e(i,t),i.parentNode&&n++;return r}}();
UE.plugin=function(){var e={};return{register:function(t,a,n,i){n&&utils.isFunction(n)&&(i=n,n=null),e[t]={optionName:n||t,execFn:a,afterDisabled:i}},load:function(t){utils.each(e,function(e){var a=e.execFn.call(t);t.options[e.optionName]!==!1?a&&utils.each(a,function(e,a){switch(a.toLowerCase()){case"shortcutkey":t.addshortcutkey(e);break;case"bindevents":utils.each(e,function(e,a){t.addListener(a,e)});break;case"bindmultievents":utils.each(utils.isArray(e)?e:[e],function(e){var a=utils.trim(e.type).split(/\s+/);utils.each(a,function(a){t.addListener(a,e.handler)})});break;case"commands":utils.each(e,function(e,a){t.commands[a]=e});break;case"outputrule":t.addOutputRule(e);break;case"inputrule":t.addInputRule(e);break;case"defaultoptions":t.setOpt(e)}}):e.afterDisabled&&e.afterDisabled.call(t)}),utils.each(UE.plugins,function(e){e.call(t)})},run:function(t,a){var n=e[t];n&&n.exeFn.call(a)}}}();
var keymap=UE.keymap={Backspace:8,Tab:9,Enter:13,Shift:16,Control:17,Alt:18,CapsLock:20,Esc:27,Spacebar:32,PageUp:33,PageDown:34,End:35,Home:36,Left:37,Up:38,Right:39,Down:40,Insert:45,Del:46,NumLock:144,Cmd:91,"=":187,"-":189,b:66,i:73,z:90,y:89,v:86,x:88,s:83,n:78};
var LocalStorage=UE.LocalStorage=function(){function e(){var e=document.createElement("div");return e.style.display="none",e.addBehavior?(e.addBehavior("#default#userdata"),{getItem:function(t){var a=null;try{document.body.appendChild(e),e.load(o),a=e.getAttribute(t),document.body.removeChild(e)}catch(r){}return a},setItem:function(t,a){document.body.appendChild(e),e.setAttribute(t,a),e.save(o),document.body.removeChild(e)},removeItem:function(t){document.body.appendChild(e),e.removeAttribute(t),e.save(o),document.body.removeChild(e)}}):null}var t=window.localStorage||e()||null,o="localStorage";return{saveLocalData:function(e,o){return t&&o?(t.setItem(e,o),!0):!1},getLocalData:function(e){return t?t.getItem(e):null},removeItem:function(e){t&&t.removeItem(e)}}}();!function(){var e="ueditor_preference";UE.Editor.prototype.setPreferences=function(t,o){var a={};utils.isString(t)?a[t]=o:a=t;var r=LocalStorage.getLocalData(e);r&&(r=utils.str2json(r))?utils.extend(r,a):r=a,r&&LocalStorage.saveLocalData(e,utils.json2str(r))},UE.Editor.prototype.getPreferences=function(t){var o=LocalStorage.getLocalData(e);return o&&(o=utils.str2json(o))?t?o[t]:o:null},UE.Editor.prototype.removePreferences=function(t){var o=LocalStorage.getLocalData(e);o&&(o=utils.str2json(o))&&(o[t]=void 0,delete o[t]),o&&LocalStorage.saveLocalData(e,utils.json2str(o))}}();
UE.plugins.defaultfilter=function(){var e=this;e.setOpt({allowDivTransToP:!0,disabledTableInTable:!0}),e.addInputRule(function(t){function a(e){for(;e&&"element"==e.type;){if("td"==e.tagName)return!0;e=e.parentNode}return!1}var r,i=this.options.allowDivTransToP;t.traversal(function(t){if("element"==t.type){if(!dtd.$cdata[t.tagName]&&e.options.autoClearEmptyNode&&dtd.$inline[t.tagName]&&!dtd.$empty[t.tagName]&&(!t.attrs||utils.isEmptyObject(t.attrs)))return void(t.firstChild()?"span"!=t.tagName||t.attrs&&!utils.isEmptyObject(t.attrs)||t.parentNode.removeChild(t,!0):t.parentNode.removeChild(t));switch(t.tagName){case"style":case"script":t.setAttr({cdata_tag:t.tagName,cdata_data:t.innerHTML()||"",_ue_custom_node_:"true"}),t.tagName="div",t.innerHTML("");break;case"a":(r=t.getAttr("href"))&&t.setAttr("_href",r);break;case"img":if((r=t.getAttr("src"))&&/^data:/.test(r)){t.parentNode.removeChild(t);break}t.setAttr("_src",t.getAttr("src"));break;case"span":browser.webkit&&(r=t.getStyle("white-space"))&&/nowrap|normal/.test(r)&&(t.setStyle("white-space",""),e.options.autoClearEmptyNode&&utils.isEmptyObject(t.attrs)&&t.parentNode.removeChild(t,!0)),r=t.getAttr("id"),r&&/^_baidu_bookmark_/i.test(r)&&t.parentNode.removeChild(t);break;case"p":(r=t.getAttr("align"))&&(t.setAttr("align"),t.setStyle("text-align",r)),utils.each(t.children,function(e){if("element"==e.type&&"p"==e.tagName){var a=e.nextSibling();t.parentNode.insertAfter(e,t);for(var r=e;a;){var i=a.nextSibling();t.parentNode.insertAfter(a,r),r=a,a=i}return!1}}),t.firstChild()||t.innerHTML(browser.ie?"&nbsp;":"<br/>");break;case"div":if(t.getAttr("cdata_tag"))break;if(r=t.getAttr("class"),r&&/^line number\d+/.test(r))break;if(!i)break;for(var s,d=UE.uNode.createElement("p");s=t.firstChild();)"text"!=s.type&&UE.dom.dtd.$block[s.tagName]?d.firstChild()?(t.parentNode.insertBefore(d,t),d=UE.uNode.createElement("p")):t.parentNode.insertBefore(s,t):d.appendChild(s);d.firstChild()&&t.parentNode.insertBefore(d,t),t.parentNode.removeChild(t);break;case"dl":t.tagName="ul";break;case"dt":case"dd":t.tagName="li";break;case"li":var n=t.getAttr("class");n&&/list\-/.test(n)||t.setAttr();var o=t.getNodesByTagName("ol ul");UE.utils.each(o,function(e){t.parentNode.insertAfter(e,t)});break;case"td":case"th":case"caption":t.children&&t.children.length||t.appendChild(browser.ie11below?UE.uNode.createText(" "):UE.uNode.createElement("br"));break;case"table":e.options.disabledTableInTable&&a(t)&&(t.parentNode.insertBefore(UE.uNode.createText(t.innerText()),t),t.parentNode.removeChild(t))}}})}),e.addOutputRule(function(t){var a;t.traversal(function(t){if("element"==t.type){if(e.options.autoClearEmptyNode&&dtd.$inline[t.tagName]&&!dtd.$empty[t.tagName]&&(!t.attrs||utils.isEmptyObject(t.attrs)))return void(t.firstChild()?"span"!=t.tagName||t.attrs&&!utils.isEmptyObject(t.attrs)||t.parentNode.removeChild(t,!0):t.parentNode.removeChild(t));switch(t.tagName){case"div":(a=t.getAttr("cdata_tag"))&&(t.tagName=a,t.appendChild(UE.uNode.createText(t.getAttr("cdata_data"))),t.setAttr({cdata_tag:"",cdata_data:"",_ue_custom_node_:""}));break;case"a":(a=t.getAttr("_href"))&&t.setAttr({href:utils.html(a),_href:""});break;case"span":a=t.getAttr("id"),a&&/^_baidu_bookmark_/i.test(a)&&t.parentNode.removeChild(t);break;case"img":(a=t.getAttr("_src"))&&t.setAttr({src:t.getAttr("_src"),_src:""})}}})})};
UE.commands.inserthtml={execCommand:function(e,t,i){var l,o,s=this;if(t&&s.fireEvent("beforeinserthtml",t)!==!0){if(l=s.selection.getRange(),o=l.document.createElement("div"),o.style.display="inline",!i){var r=UE.htmlparser(t);s.options.filterRules&&UE.filterNode(r,s.options.filterRules),s.filterInputRule(r),t=r.toHtml()}if(o.innerHTML=utils.trim(t),!l.collapsed){var n=l.startContainer;if(domUtils.isFillChar(n)&&l.setStartBefore(n),n=l.endContainer,domUtils.isFillChar(n)&&l.setEndAfter(n),l.txtToElmBoundary(),l.endContainer&&1==l.endContainer.nodeType&&(n=l.endContainer.childNodes[l.endOffset],n&&domUtils.isBr(n)&&l.setEndAfter(n)),0==l.startOffset&&(n=l.startContainer,domUtils.isBoundaryNode(n,"firstChild")&&(n=l.endContainer,l.endOffset==(3==n.nodeType?n.nodeValue.length:n.childNodes.length)&&domUtils.isBoundaryNode(n,"lastChild")&&(s.body.innerHTML="<p>"+(browser.ie?"":"<br/>")+"</p>",l.setStart(s.body.firstChild,0).collapse(!0)))),!l.collapsed&&l.deleteContents(),1==l.startContainer.nodeType){var d,a=l.startContainer.childNodes[l.startOffset];if(a&&domUtils.isBlockElm(a)&&(d=a.previousSibling)&&domUtils.isBlockElm(d)){for(l.setEnd(d,d.childNodes.length).collapse();a.firstChild;)d.appendChild(a.firstChild);domUtils.remove(a)}}}var a,m,d,f,c,h=0;l.inFillChar()&&(a=l.startContainer,domUtils.isFillChar(a)?(l.setStartBefore(a).collapse(!0),domUtils.remove(a)):domUtils.isFillChar(a,!0)&&(a.nodeValue=a.nodeValue.replace(fillCharReg,""),l.startOffset--,l.collapsed&&l.collapse(!0)));var p=domUtils.findParentByTagName(l.startContainer,"li",!0);if(p){for(var C,U;a=o.firstChild;){for(;a&&(3==a.nodeType||!domUtils.isBlockElm(a)||"HR"==a.tagName);)C=a.nextSibling,l.insertNode(a).collapse(),U=a,a=C;if(a)if(/^(ol|ul)$/i.test(a.tagName)){for(;a.firstChild;)U=a.firstChild,domUtils.insertAfter(p,a.firstChild),p=p.nextSibling;domUtils.remove(a)}else{var g;C=a.nextSibling,g=s.document.createElement("li"),domUtils.insertAfter(p,g),g.appendChild(a),U=a,a=C,p=g}}p=domUtils.findParentByTagName(l.startContainer,"li",!0),domUtils.isEmptyBlock(p)&&domUtils.remove(p),U&&l.setStartAfter(U).collapse(!0).select(!0)}else{for(;a=o.firstChild;){if(h){for(var E=s.document.createElement("p");a&&(3==a.nodeType||!dtd.$block[a.tagName]);)c=a.nextSibling,E.appendChild(a),a=c;E.firstChild&&(a=E)}if(l.insertNode(a),c=a.nextSibling,!h&&a.nodeType==domUtils.NODE_ELEMENT&&domUtils.isBlockElm(a)&&(m=domUtils.findParent(a,function(e){return domUtils.isBlockElm(e)}),m&&"body"!=m.tagName.toLowerCase()&&(!dtd[m.tagName][a.nodeName]||a.parentNode!==m))){if(dtd[m.tagName][a.nodeName])for(f=a.parentNode;f!==m;)d=f,f=f.parentNode;else d=m;domUtils.breakParent(a,d||f);var d=a.previousSibling;domUtils.trimWhiteTextNode(d),d.childNodes.length||domUtils.remove(d),!browser.ie&&(C=a.nextSibling)&&domUtils.isBlockElm(C)&&C.lastChild&&!domUtils.isBr(C.lastChild)&&C.appendChild(s.document.createElement("br")),h=1}var C=a.nextSibling;if(!o.firstChild&&C&&domUtils.isBlockElm(C)){l.setStart(C,0).collapse(!0);break}l.setEndAfter(a).collapse()}if(a=l.startContainer,c&&domUtils.isBr(c)&&domUtils.remove(c),domUtils.isBlockElm(a)&&domUtils.isEmptyNode(a))if(c=a.nextSibling)domUtils.remove(a),1==c.nodeType&&dtd.$block[c.tagName]&&l.setStart(c,0).collapse(!0).shrinkBoundary();else try{a.innerHTML=browser.ie?domUtils.fillChar:"<br/>"}catch(N){l.setStartBefore(a),domUtils.remove(a)}try{l.select(!0)}catch(N){}}setTimeout(function(){l=s.selection.getRange(),l.scrollToView(s.autoHeightEnabled,s.autoHeightEnabled?domUtils.getXY(s.iframe).y:0),s.fireEvent("afterinserthtml",t)},200)}}};
UE.plugins.autotypeset=function(){function e(e,t){return e&&3!=e.nodeType?domUtils.isBr(e)?1:e&&e.parentNode&&c[e.tagName.toLowerCase()]?r&&r.contains(e)||e.getAttribute("pagebreak")?0:t?!domUtils.isEmptyBlock(e):domUtils.isEmptyBlock(e,new RegExp("[\\s"+domUtils.fillChar+"]","g")):void 0:0}function t(e){e.style.cssText||(domUtils.removeAttributes(e,["style"]),"span"==e.tagName.toLowerCase()&&domUtils.hasNoAttributes(e)&&domUtils.remove(e,!0))}function i(i,n){var s,c=this;if(n){if(!l.pasteFilter)return;s=c.document.createElement("div"),s.innerHTML=n.html}else s=c.document.body;for(var f,g=domUtils.getElementsByTagName(s,"*"),p=0;f=g[p++];)if(c.fireEvent("excludeNodeinautotype",f)!==!0){if(l.clearFontSize&&f.style.fontSize&&(domUtils.removeStyle(f,"font-size"),t(f)),l.clearFontFamily&&f.style.fontFamily&&(domUtils.removeStyle(f,"font-family"),t(f)),e(f)){if(l.mergeEmptyline)for(var u,h=f.nextSibling,y=domUtils.isBr(f);e(h)&&(u=h,h=u.nextSibling,!y||h&&(!h||domUtils.isBr(h)));)domUtils.remove(u);if(l.removeEmptyline&&domUtils.inDoc(f,s)&&!d[f.parentNode.tagName.toLowerCase()]){if(domUtils.isBr(f)&&(h=f.nextSibling,h&&!domUtils.isBr(h)))continue;domUtils.remove(f);continue}}if(e(f,!0)&&"SPAN"!=f.tagName&&(l.indent&&(f.style.textIndent=l.indentValue),l.textAlign&&(f.style.textAlign=l.textAlign)),l.removeClass&&f.className&&!m[f.className.toLowerCase()]){if(r&&r.contains(f))continue;domUtils.removeAttributes(f,["class"])}if(l.imageBlockLine&&"img"==f.tagName.toLowerCase()&&!f.getAttribute("emotion"))if(n){var v=f;switch(l.imageBlockLine){case"left":case"right":case"none":for(var u,U,h,C=v.parentNode;dtd.$inline[C.tagName]||"A"==C.tagName;)C=C.parentNode;if(u=C,"P"==u.tagName&&"center"==domUtils.getStyle(u,"text-align")&&!domUtils.isBody(u)&&1==domUtils.getChildCount(u,function(e){return!domUtils.isBr(e)&&!domUtils.isWhitespace(e)}))if(U=u.previousSibling,h=u.nextSibling,U&&h&&1==U.nodeType&&1==h.nodeType&&U.tagName==h.tagName&&domUtils.isBlockElm(U)){for(U.appendChild(u.firstChild);h.firstChild;)U.appendChild(h.firstChild);domUtils.remove(u),domUtils.remove(h)}else domUtils.setStyle(u,"text-align","");domUtils.setStyle(v,"float",l.imageBlockLine);break;case"center":if("center"!=c.queryCommandValue("imagefloat")){for(C=v.parentNode,domUtils.setStyle(v,"float","none"),u=v;C&&1==domUtils.getChildCount(C,function(e){return!domUtils.isBr(e)&&!domUtils.isWhitespace(e)})&&(dtd.$inline[C.tagName]||"A"==C.tagName);)u=C,C=C.parentNode;var N=c.document.createElement("p");domUtils.setAttributes(N,{style:"text-align:center"}),u.parentNode.insertBefore(N,u),N.appendChild(u),domUtils.setStyle(u,"float","")}}}else{var b=c.selection.getRange();b.selectNode(f).select(),c.execCommand("imagefloat",l.imageBlockLine)}l.removeEmptyNode&&l.removeTagNames[f.tagName.toLowerCase()]&&domUtils.hasNoAttributes(f)&&domUtils.isEmptyBlock(f)&&domUtils.remove(f)}if(l.tobdc){var A=UE.htmlparser(s.innerHTML);A.traversal(function(e){"text"==e.type&&(e.data=a(e.data))}),s.innerHTML=A.toHtml()}if(l.bdc2sb){var A=UE.htmlparser(s.innerHTML);A.traversal(function(e){"text"==e.type&&(e.data=o(e.data))}),s.innerHTML=A.toHtml()}n&&(n.html=s.innerHTML)}function o(e){for(var t="",i=0;i<e.length;i++){var o=e.charCodeAt(i);t+=o>=65281&&65373>=o?String.fromCharCode(e.charCodeAt(i)-65248):12288==o?String.fromCharCode(e.charCodeAt(i)-12288+32):e.charAt(i)}return t}function a(e){e=utils.html(e);for(var t="",i=0;i<e.length;i++)t+=32==e.charCodeAt(i)?String.fromCharCode(12288):e.charCodeAt(i)<127?String.fromCharCode(e.charCodeAt(i)+65248):e.charAt(i);return t}function n(){var e=s.getPreferences("autotypeset");utils.extend(s.options.autotypeset,e)}this.setOpt({autotypeset:{mergeEmptyline:!0,removeClass:!0,removeEmptyline:!1,textAlign:"left",imageBlockLine:"center",pasteFilter:!1,clearFontSize:!1,clearFontFamily:!1,removeEmptyNode:!1,removeTagNames:utils.extend({div:1},dtd.$removeEmpty),indent:!1,indentValue:"2em",bdc2sb:!1,tobdc:!1}});var r,s=this,l=s.options.autotypeset,m={selectTdClass:1,pagebreak:1,anchorclass:1},d={li:1},c={div:1,p:1,blockquote:1,center:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,span:1};l&&(n(),l.pasteFilter&&s.addListener("beforepaste",i),s.commands.autotypeset={execCommand:function(){s.removeListener("beforepaste",i),l.pasteFilter&&s.addListener("beforepaste",i),i.call(s)}})};
UE.plugin.register("autosubmit",function(){return{shortcutkey:{autosubmit:"ctrl+13"},commands:{autosubmit:{execCommand:function(){var t=this,i=domUtils.findParentByTagName(t.iframe,"form",!1);if(i){if(t.fireEvent("beforesubmit")===!1)return;t.sync(),i.submit()}}}}}});
UE.commands.imagefloat={execCommand:function(e,t){var i=this,l=i.selection.getRange();if(!l.collapsed){var a=l.getClosedNode();if(a&&"IMG"==a.tagName)switch(t){case"left":case"right":case"none":for(var o,s,n,r=a.parentNode;dtd.$inline[r.tagName]||"A"==r.tagName;)r=r.parentNode;if(o=r,"P"==o.tagName&&"center"==domUtils.getStyle(o,"text-align")){if(!domUtils.isBody(o)&&1==domUtils.getChildCount(o,function(e){return!domUtils.isBr(e)&&!domUtils.isWhitespace(e)}))if(s=o.previousSibling,n=o.nextSibling,s&&n&&1==s.nodeType&&1==n.nodeType&&s.tagName==n.tagName&&domUtils.isBlockElm(s)){for(s.appendChild(o.firstChild);n.firstChild;)s.appendChild(n.firstChild);domUtils.remove(o),domUtils.remove(n)}else domUtils.setStyle(o,"text-align","");l.selectNode(a).select()}domUtils.setStyle(a,"float","none"==t?"":t),"none"==t&&domUtils.removeAttributes(a,"align");break;case"center":if("center"!=i.queryCommandValue("imagefloat")){for(r=a.parentNode,domUtils.setStyle(a,"float",""),domUtils.removeAttributes(a,"align"),o=a;r&&1==domUtils.getChildCount(r,function(e){return!domUtils.isBr(e)&&!domUtils.isWhitespace(e)})&&(dtd.$inline[r.tagName]||"A"==r.tagName);)o=r,r=r.parentNode;l.setStartBefore(o).setCursor(!1),r=i.document.createElement("div"),r.appendChild(o),domUtils.setStyle(o,"float",""),i.execCommand("insertHtml",'<p id="_img_parent_tmp" style="text-align:center">'+r.innerHTML+"</p>"),o=i.document.getElementById("_img_parent_tmp"),o.removeAttribute("id"),o=o.firstChild,l.selectNode(o).select(),n=o.parentNode.nextSibling,n&&domUtils.isEmptyNode(n)&&domUtils.remove(n)}}}},queryCommandValue:function(){var e,t,i=this.selection.getRange();return i.collapsed?"none":(e=i.getClosedNode(),e&&1==e.nodeType&&"IMG"==e.tagName?(t=domUtils.getComputedStyle(e,"float")||e.getAttribute("align"),"none"==t&&(t="center"==domUtils.getComputedStyle(e.parentNode,"text-align")?"center":t),{left:1,right:1,center:1}[t]?t:"none"):"none")},queryCommandState:function(){var e,t=this.selection.getRange();return t.collapsed?-1:(e=t.getClosedNode(),e&&1==e.nodeType&&"IMG"==e.tagName?0:-1)}},UE.commands.insertimage={execCommand:function(e,t){if(t=utils.isArray(t)?t:[t],t.length){var i=this,l=i.selection.getRange(),a=l.getClosedNode();if(i.fireEvent("beforeinsertimage",t)!==!0){if(!a||!/img/i.test(a.tagName)||"edui-faked-video"==a.className&&-1==a.className.indexOf("edui-upload-video")||a.getAttribute("word_img")){var o,s=[],n="";if(o=t[0],1==t.length)n='<img src="'+o.src+'" '+(o._src?' _src="'+o._src+'" ':"")+(o.width?'width="'+o.width+'" ':"")+(o.height?' height="'+o.height+'" ':"")+("left"==o.floatStyle||"right"==o.floatStyle?' style="float:'+o.floatStyle+';"':"")+(o.title&&""!=o.title?' title="'+o.title+'"':"")+(o.border&&"0"!=o.border?' border="'+o.border+'"':"")+(o.alt&&""!=o.alt?' alt="'+o.alt+'"':"")+(o.hspace&&"0"!=o.hspace?' hspace = "'+o.hspace+'"':"")+(o.vspace&&"0"!=o.vspace?' vspace = "'+o.vspace+'"':"")+"/>","center"==o.floatStyle&&(n='<p style="text-align: center">'+n+"</p>"),s.push(n);else for(var r=0;o=t[r++];)n="<p "+("center"==o.floatStyle?'style="text-align: center" ':"")+'><img src="'+o.src+'" '+(o.width?'width="'+o.width+'" ':"")+(o._src?' _src="'+o._src+'" ':"")+(o.height?' height="'+o.height+'" ':"")+' style="'+(o.floatStyle&&"center"!=o.floatStyle?"float:"+o.floatStyle+";":"")+(o.border||"")+'" '+(o.title?' title="'+o.title+'"':"")+" /></p>",s.push(n);i.execCommand("insertHtml",s.join(""))}else{var d=t.shift(),m=d.floatStyle;delete d.floatStyle,domUtils.setAttributes(a,d),i.execCommand("imagefloat",m),t.length>0&&(l.setStartAfter(a).setCursor(!1,!0),i.execCommand("insertimage",t))}i.fireEvent("afterinsertimage",t)}}}};
UE.plugins.justify=function(){var t=domUtils.isBlockElm,e={left:1,right:1,center:1,justify:1},o=function(e,o){var n=e.createBookmark(),i=function(t){return 1==t.nodeType?"br"!=t.tagName.toLowerCase()&&!domUtils.isBookmarkNode(t):!domUtils.isWhitespace(t)};e.enlarge(!0);for(var r,s=e.createBookmark(),a=domUtils.getNextDomNode(s.start,!1,i),l=e.cloneRange();a&&!(domUtils.getPosition(a,s.end)&domUtils.POSITION_FOLLOWING);)if(3!=a.nodeType&&t(a))a=domUtils.getNextDomNode(a,!0,i);else{for(l.setStartBefore(a);a&&a!==s.end&&!t(a);)r=a,a=domUtils.getNextDomNode(a,!1,null,function(e){return!t(e)});l.setEndAfter(r);var m=l.getCommonAncestor();if(!domUtils.isBody(m)&&t(m))domUtils.setStyles(m,utils.isString(o)?{"text-align":o}:o),a=m;else{var d=e.document.createElement("p");domUtils.setStyles(d,utils.isString(o)?{"text-align":o}:o);var c=l.extractContents();d.appendChild(c),l.insertNode(d),a=d}a=domUtils.getNextDomNode(a,!1,i)}return e.moveToBookmark(s).moveToBookmark(n)};UE.commands.justify={execCommand:function(t,e){var n,i=this.selection.getRange();return i.collapsed&&(n=this.document.createTextNode("p"),i.insertNode(n)),o(i,e),n&&(i.setStartBefore(n).collapse(!0),domUtils.remove(n)),i.select(),!0},queryCommandValue:function(){var t=this.selection.getStart(),o=domUtils.getComputedStyle(t,"text-align");return e[o]?o:"left"},queryCommandState:function(){var t=this.selection.getStart(),e=t&&domUtils.findParentByTagName(t,["td","th","caption"],!0);return e?-1:0}}};
UE.plugins.font=function(){function e(e){for(var t;(t=e.parentNode)&&"SPAN"==t.tagName&&1==domUtils.getChildCount(t,function(e){return!domUtils.isBookmarkNode(e)&&!domUtils.isBr(e)});)t.style.cssText+=e.style.cssText,domUtils.remove(e,!0),e=t}function t(e,t,o){if(n[t]&&(e.adjustmentBoundary(),!e.collapsed&&1==e.startContainer.nodeType)){var s=e.startContainer.childNodes[e.startOffset];if(s&&domUtils.isTagNode(s,"span")){var r=e.createBookmark();utils.each(domUtils.getElementsByTagName(s,"span"),function(e){e.parentNode&&!domUtils.isBookmarkNode(e)&&("backcolor"!=t||domUtils.getComputedStyle(e,"background-color").toLowerCase()!==o)&&(domUtils.removeStyle(e,n[t]),0==e.style.cssText.replace(/^\s+$/,"").length&&domUtils.remove(e,!0))}),e.moveToBookmark(r)}}}function o(o,s,r){var a,n=o.collapsed,i=o.createBookmark();if(n)for(a=i.start.parentNode;dtd.$inline[a.tagName];)a=a.parentNode;else a=domUtils.getCommonAncestor(i.start,i.end);utils.each(domUtils.getElementsByTagName(a,"span"),function(t){if(t.parentNode&&!domUtils.isBookmarkNode(t)){if(/\s*border\s*:\s*none;?\s*/i.test(t.style.cssText))return void(/^\s*border\s*:\s*none;?\s*$/.test(t.style.cssText)?domUtils.remove(t,!0):domUtils.removeStyle(t,"border"));if(/border/i.test(t.style.cssText)&&"SPAN"==t.parentNode.tagName&&/border/i.test(t.parentNode.style.cssText)&&(t.style.cssText=t.style.cssText.replace(/border[^:]*:[^;]+;?/gi,"")),"fontborder"!=s||"none"!=r)for(var o=t.nextSibling;o&&1==o.nodeType&&"SPAN"==o.tagName;)if(domUtils.isBookmarkNode(o)&&"fontborder"==s)t.appendChild(o),o=t.nextSibling;else{if(o.style.cssText==t.style.cssText&&(domUtils.moveChild(o,t),domUtils.remove(o)),t.nextSibling===o)break;o=t.nextSibling}if(e(t),browser.ie&&browser.version>8){var a=domUtils.findParent(t,function(e){return"SPAN"==e.tagName&&/background-color/.test(e.style.cssText)});a&&!/background-color/.test(t.style.cssText)&&(t.style.backgroundColor=a.style.backgroundColor)}}}),o.moveToBookmark(i),t(o,s,r)}var s=this,r={forecolor:"color",backcolor:"background-color",fontsize:"font-size",fontfamily:"font-family",underline:"text-decoration",strikethrough:"text-decoration",fontborder:"border"},a={underline:1,strikethrough:1,fontborder:1},n={forecolor:"color",backcolor:"background-color",fontsize:"font-size",fontfamily:"font-family"};s.setOpt({fontfamily:[{name:"songti",val:"宋体,SimSun"},{name:"yahei",val:"微软雅黑,Microsoft YaHei"},{name:"kaiti",val:"楷体,楷体_GB2312, SimKai"},{name:"heiti",val:"黑体, SimHei"},{name:"lishu",val:"隶书, SimLi"},{name:"andaleMono",val:"andale mono"},{name:"arial",val:"arial, helvetica,sans-serif"},{name:"arialBlack",val:"arial black,avant garde"},{name:"comicSansMs",val:"comic sans ms"},{name:"impact",val:"impact,chicago"},{name:"timesNewRoman",val:"times new roman"}],fontsize:[10,11,12,14,16,18,20,24,36]}),s.addInputRule(function(e){utils.each(e.getNodesByTagName("u s del font strike"),function(e){if("font"==e.tagName){var t=[];for(var o in e.attrs)switch(o){case"size":t.push("font-size:"+({1:"10",2:"12",3:"16",4:"18",5:"24",6:"32",7:"48"}[e.attrs[o]]||e.attrs[o])+"px");break;case"color":t.push("color:"+e.attrs[o]);break;case"face":t.push("font-family:"+e.attrs[o]);break;case"style":t.push(e.attrs[o])}e.attrs={style:t.join(";")}}else{var s="u"==e.tagName?"underline":"line-through";e.attrs={style:(e.getAttr("style")||"")+"text-decoration:"+s+";"}}e.tagName="span"})});for(var i in r)!function(e,t){UE.commands[e]={execCommand:function(s,r){r=r||(this.queryCommandState(s)?"none":"underline"==s?"underline":"fontborder"==s?"1px solid #000":"line-through");var n,i=this,l=this.selection.getRange();if("default"==r)l.collapsed&&(n=i.document.createTextNode("font"),l.insertNode(n).select()),i.execCommand("removeFormat","span,a",t),n&&(l.setStartBefore(n).collapse(!0),domUtils.remove(n)),o(l,s,r),l.select();else if(l.collapsed){var d=domUtils.findParentByTagName(l.startContainer,"span",!0);if(n=i.document.createTextNode("font"),!d||d.children.length||d[browser.ie?"innerText":"textContent"].replace(fillCharReg,"").length){if(l.insertNode(n),l.selectNode(n).select(),d=l.document.createElement("span"),a[e]){if(domUtils.findParentByTagName(n,"a",!0))return l.setStartBefore(n).setCursor(),void domUtils.remove(n);i.execCommand("removeFormat","span,a",t)}if(d.style.cssText=t+":"+r,n.parentNode.insertBefore(d,n),!browser.ie||browser.ie&&9==browser.version)for(var m=d.parentNode;!domUtils.isBlockElm(m);)"SPAN"==m.tagName&&(d.style.cssText=m.style.cssText+";"+d.style.cssText),m=m.parentNode;opera?setTimeout(function(){l.setStart(d,0).collapse(!0),o(l,s,r),l.select()}):(l.setStart(d,0).collapse(!0),o(l,s,r),l.select())}else l.insertNode(n),a[e]&&(l.selectNode(n).select(),i.execCommand("removeFormat","span,a",t,null),d=domUtils.findParentByTagName(n,"span",!0),l.setStartBefore(n)),d&&(d.style.cssText+=";"+t+":"+r),l.collapse(!0).select();domUtils.remove(n)}else a[e]&&i.queryCommandValue(e)&&i.execCommand("removeFormat","span,a",t),l=i.selection.getRange(),l.applyInlineStyle("span",{style:t+":"+r}),o(l,s,r),l.select();return!0},queryCommandValue:function(e){var o=this.selection.getStart();if("underline"==e||"strikethrough"==e){for(var s,r=o;r&&!domUtils.isBlockElm(r)&&!domUtils.isBody(r);){if(1==r.nodeType&&(s=domUtils.getComputedStyle(r,t),"none"!=s))return s;r=r.parentNode}return"none"}if("fontborder"==e){for(var a,n=o;n&&dtd.$inline[n.tagName];){if((a=domUtils.getComputedStyle(n,"border"))&&/1px/.test(a)&&/solid/.test(a))return a;n=n.parentNode}return""}if("FontSize"==e){var i=domUtils.getComputedStyle(o,t),n=/^([\d\.]+)(\w+)$/.exec(i);return n?Math.floor(n[1])+n[2]:i}return domUtils.getComputedStyle(o,t)},queryCommandState:function(e){if(!a[e])return 0;var t=this.queryCommandValue(e);return"fontborder"==e?/1px/.test(t)&&/solid/.test(t):"underline"==e?/underline/.test(t):/line\-through/.test(t)}}}(i,r[i])};
UE.plugins.link=function(){function e(e){var t=e.startContainer,n=e.endContainer;(t=domUtils.findParentByTagName(t,"a",!0))&&e.setStartBefore(t),(n=domUtils.findParentByTagName(n,"a",!0))&&e.setEndAfter(n)}function t(t,n,a){var o=t.cloneRange(),i=a.queryCommandValue("link");e(t=t.adjustmentBoundary());var r=t.startContainer;if(1==r.nodeType&&i&&(r=r.childNodes[t.startOffset],r&&1==r.nodeType&&"A"==r.tagName&&/^(?:https?|ftp|file)\s*:\s*\/\//.test(r[browser.ie?"innerText":"textContent"])&&(r[browser.ie?"innerText":"textContent"]=utils.html(n.textValue||n.href))),(!o.collapsed||i)&&(t.removeInlineStyle("a"),o=t.cloneRange()),o.collapsed){var s=t.document.createElement("a"),l="";n.textValue?(l=utils.html(n.textValue),delete n.textValue):l=utils.html(n.href),domUtils.setAttributes(s,n),r=domUtils.findParentByTagName(o.startContainer,"a",!0),r&&domUtils.isInNodeEndBoundary(o,r)&&t.setStartAfter(r).collapse(!0),s[browser.ie?"innerText":"textContent"]=l,t.insertNode(s).selectNode(s)}else t.applyInlineStyle("a",n)}UE.commands.unlink={execCommand:function(){var t,n=this.selection.getRange();(!n.collapsed||domUtils.findParentByTagName(n.startContainer,"a",!0))&&(t=n.createBookmark(),e(n),n.removeInlineStyle("a").moveToBookmark(t).select())},queryCommandState:function(){return!this.highlight&&this.queryCommandValue("link")?0:-1}},UE.commands.link={execCommand:function(e,n){var a;n._href&&(n._href=utils.unhtml(n._href,/[<">]/g)),n.href&&(n.href=utils.unhtml(n.href,/[<">]/g)),n.textValue&&(n.textValue=utils.unhtml(n.textValue,/[<">]/g)),t(a=this.selection.getRange(),n,this),a.collapse().select(!0)},queryCommandValue:function(){var e,t=this.selection.getRange();if(!t.collapsed){t.shrinkBoundary();var n=3!=t.startContainer.nodeType&&t.startContainer.childNodes[t.startOffset]?t.startContainer.childNodes[t.startOffset]:t.startContainer,a=3==t.endContainer.nodeType||0==t.endOffset?t.endContainer:t.endContainer.childNodes[t.endOffset-1],o=t.getCommonAncestor();if(e=domUtils.findParentByTagName(o,"a",!0),!e&&1==o.nodeType)for(var i,r,s,l=o.getElementsByTagName("a"),d=0;s=l[d++];)if(i=domUtils.getPosition(s,n),r=domUtils.getPosition(s,a),(i&domUtils.POSITION_FOLLOWING||i&domUtils.POSITION_CONTAINS)&&(r&domUtils.POSITION_PRECEDING||r&domUtils.POSITION_CONTAINS)){e=s;break}return e}return e=t.startContainer,e=1==e.nodeType?e:e.parentNode,e&&(e=domUtils.findParentByTagName(e,"a",!0))&&!domUtils.isInNodeEndBoundary(t,e)?e:void 0},queryCommandState:function(){var e=this.selection.getRange().getClosedNode(),t=e&&("edui-faked-video"==e.className||-1!=e.className.indexOf("edui-upload-video"));return t?-1:0}}};
UE.plugins.insertframe=function(){function e(){n._iframe&&delete n._iframe}var n=this;n.addListener("selectionchange",function(){e()})};
UE.plugins.removeformat=function(){var e=this;e.setOpt({removeFormatTags:"b,big,code,del,dfn,em,font,i,ins,kbd,q,samp,small,span,strike,strong,sub,sup,tt,u,var",removeFormatAttributes:"class,style,lang,width,height,align,hspace,valign"}),e.commands.removeformat={execCommand:function(e,t,o,a,r){function m(e){if(3==e.nodeType||"span"!=e.tagName.toLowerCase())return 0;if(browser.ie){var t=e.attributes;if(t.length){for(var o=0,a=t.length;a>o;o++)if(t[o].specified)return 0;return 1}}return!e.attributes.length}function i(e){var t=e.createBookmark();if(e.collapsed&&e.enlarge(!0),!r){var a=domUtils.findParentByTagName(e.startContainer,"a",!0);a&&e.setStartBefore(a),a=domUtils.findParentByTagName(e.endContainer,"a",!0),a&&e.setEndAfter(a)}for(n=e.createBookmark(),c=n.start;(s=c.parentNode)&&!domUtils.isBlockElm(s);)domUtils.breakParent(c,s),domUtils.clearEmptySibling(c);if(n.end){for(c=n.end;(s=c.parentNode)&&!domUtils.isBlockElm(s);)domUtils.breakParent(c,s),domUtils.clearEmptySibling(c);for(var i,g=domUtils.getNextDomNode(n.start,!1,p);g&&g!=n.end;)i=domUtils.getNextDomNode(g,!0,p),dtd.$empty[g.tagName.toLowerCase()]||domUtils.isBookmarkNode(g)||(d.test(g.tagName)?o?(domUtils.removeStyle(g,o),m(g)&&"text-decoration"!=o&&domUtils.remove(g,!0)):domUtils.remove(g,!0):dtd.$tableContent[g.tagName]||dtd.$list[g.tagName]||(domUtils.removeAttributes(g,l),m(g)&&domUtils.remove(g,!0))),g=i}var f=n.start.parentNode;!domUtils.isBlockElm(f)||dtd.$tableContent[f.tagName]||dtd.$list[f.tagName]||domUtils.removeAttributes(f,l),f=n.end.parentNode,n.end&&domUtils.isBlockElm(f)&&!dtd.$tableContent[f.tagName]&&!dtd.$list[f.tagName]&&domUtils.removeAttributes(f,l),e.moveToBookmark(n).moveToBookmark(t);for(var v,c=e.startContainer,N=e.collapsed;1==c.nodeType&&domUtils.isEmptyNode(c)&&dtd.$removeEmpty[c.tagName];)v=c.parentNode,e.setStartBefore(c),e.startContainer===e.endContainer&&e.endOffset--,domUtils.remove(c),c=v;if(!N)for(c=e.endContainer;1==c.nodeType&&domUtils.isEmptyNode(c)&&dtd.$removeEmpty[c.tagName];)v=c.parentNode,e.setEndBefore(c),domUtils.remove(c),c=v}var n,s,d=new RegExp("^(?:"+(t||this.options.removeFormatTags).replace(/,/g,"|")+")$","i"),l=o?[]:(a||this.options.removeFormatAttributes).split(","),g=new dom.Range(this.document),p=function(e){return 1==e.nodeType};g=this.selection.getRange(),i(g),g.select()}}};
UE.plugins.blockquote=function(){function e(e){return domUtils.filterNodeList(e.selection.getStartElementPath(),"blockquote")}var t=this;t.commands.blockquote={execCommand:function(t,o){var i=this.selection.getRange(),n=e(this),a=dtd.blockquote,s=i.createBookmark();if(n){var d=i.startContainer,r=domUtils.isBlockElm(d)?d:domUtils.findParent(d,function(e){return domUtils.isBlockElm(e)}),l=i.endContainer,m=domUtils.isBlockElm(l)?l:domUtils.findParent(l,function(e){return domUtils.isBlockElm(e)});r=domUtils.findParentByTagName(r,"li",!0)||r,m=domUtils.findParentByTagName(m,"li",!0)||m,"LI"==r.tagName||"TD"==r.tagName||r===n||domUtils.isBody(r)?domUtils.remove(n,!0):domUtils.breakParent(r,n),r!==m&&(n=domUtils.findParentByTagName(m,"blockquote"),n&&("LI"==m.tagName||"TD"==m.tagName||domUtils.isBody(m)?n.parentNode&&domUtils.remove(n,!0):domUtils.breakParent(m,n)));for(var c,U=domUtils.getElementsByTagName(this.document,"blockquote"),N=0;c=U[N++];)c.childNodes.length?domUtils.getPosition(c,r)&domUtils.POSITION_FOLLOWING&&domUtils.getPosition(c,m)&domUtils.POSITION_PRECEDING&&domUtils.remove(c,!0):domUtils.remove(c)}else{for(var f=i.cloneRange(),u=1==f.startContainer.nodeType?f.startContainer:f.startContainer.parentNode,g=u,k=1;;){if(domUtils.isBody(u)){g!==u?i.collapsed?(f.selectNode(g),k=0):f.setStartBefore(g):f.setStart(u,0);break}if(!a[u.tagName]){i.collapsed?f.selectNode(g):f.setStartBefore(g);break}g=u,u=u.parentNode}if(k)for(g=u=u=1==f.endContainer.nodeType?f.endContainer:f.endContainer.parentNode;;){if(domUtils.isBody(u)){g!==u?f.setEndAfter(g):f.setEnd(u,u.childNodes.length);break}if(!a[u.tagName]){f.setEndAfter(g);break}g=u,u=u.parentNode}u=i.document.createElement("blockquote"),domUtils.setAttributes(u,o),u.appendChild(f.extractContents()),f.insertNode(u);for(var B,b=domUtils.getElementsByTagName(u,"blockquote"),N=0;B=b[N++];)B.parentNode&&domUtils.remove(B,!0)}i.moveToBookmark(s).select()},queryCommandState:function(){return e(this)?1:0}}};
UE.commands.indent={execCommand:function(){var t=this,e=t.queryCommandState("indent")?"0em":t.options.indentValue||"2em";t.execCommand("Paragraph","p",{style:"text-indent:"+e})},queryCommandState:function(){var t=domUtils.filterNodeList(this.selection.getStartElementPath(),"p h1 h2 h3 h4 h5 h6");return t&&t.style.textIndent&&parseInt(t.style.textIndent)?1:0}};
UE.commands.preview={execCommand:function(){var t=window.open("","_blank",""),e=t.document;e.open(),e.write('<!DOCTYPE html><html><head><meta charset="utf-8"/><script src="'+this.options.UEDITOR_HOME_URL+"ueditor.parse.js\"></script><script>setTimeout(function(){uParse('div',{rootPath: '"+this.options.UEDITOR_HOME_URL+"'})},300)</script></head><body><div>"+this.getContent(null,null,!0)+"</div></body></html>"),e.close()},notNeedUndo:1};
UE.plugins.selectall=function(){var e=this;e.commands.selectall={execCommand:function(){var e=this,t=e.body,l=e.selection.getRange();l.selectNodeContents(t),domUtils.isEmptyBlock(t)&&(browser.opera&&t.firstChild&&1==t.firstChild.nodeType&&l.setStartAtFirst(t.firstChild),l.collapse(!0)),l.select(!0)},notNeedUndo:1},e.addshortcutkey({selectAll:"ctrl+65"})};
UE.plugins.paragraph=function(){var t=this,e=domUtils.isBlockElm,s=["TD","LI","PRE"],o=function(t,o,i,l){var r,d=t.createBookmark(),a=function(t){return 1==t.nodeType?"br"!=t.tagName.toLowerCase()&&!domUtils.isBookmarkNode(t):!domUtils.isWhitespace(t)};t.enlarge(!0);for(var n,m=t.createBookmark(),c=domUtils.getNextDomNode(m.start,!1,a),p=t.cloneRange();c&&!(domUtils.getPosition(c,m.end)&domUtils.POSITION_FOLLOWING);)if(3!=c.nodeType&&e(c))c=domUtils.getNextDomNode(c,!0,a);else{for(p.setStartBefore(c);c&&c!==m.end&&!e(c);)n=c,c=domUtils.getNextDomNode(c,!1,null,function(t){return!e(t)});p.setEndAfter(n),r=t.document.createElement(o),i&&(domUtils.setAttributes(r,i),l&&"customstyle"==l&&i.style&&(r.style.cssText=i.style)),r.appendChild(p.extractContents()),domUtils.isEmptyNode(r)&&domUtils.fillChar(t.document,r),p.insertNode(r);var g=r.parentNode;e(g)&&!domUtils.isBody(r.parentNode)&&-1==utils.indexOf(s,g.tagName)&&(l&&"customstyle"==l||(g.getAttribute("dir")&&r.setAttribute("dir",g.getAttribute("dir")),g.style.cssText&&(r.style.cssText=g.style.cssText+";"+r.style.cssText),g.style.textAlign&&!r.style.textAlign&&(r.style.textAlign=g.style.textAlign),g.style.textIndent&&!r.style.textIndent&&(r.style.textIndent=g.style.textIndent),g.style.padding&&!r.style.padding&&(r.style.padding=g.style.padding)),i&&/h\d/i.test(g.tagName)&&!/h\d/i.test(r.tagName)?(domUtils.setAttributes(g,i),l&&"customstyle"==l&&i.style&&(g.style.cssText=i.style),domUtils.remove(r,!0),r=g):domUtils.remove(r.parentNode,!0)),c=-1!=utils.indexOf(s,g.tagName)?g:r,c=domUtils.getNextDomNode(c,!1,a)}return t.moveToBookmark(m).moveToBookmark(d)};t.setOpt("paragraph",{p:"",h1:"",h2:"",h3:"",h4:"",h5:"",h6:""}),t.commands.paragraph={execCommand:function(t,e,s,i){var l=this.selection.getRange();if(l.collapsed){var r=this.document.createTextNode("p");if(l.insertNode(r),browser.ie){var d=r.previousSibling;d&&domUtils.isWhitespace(d)&&domUtils.remove(d),d=r.nextSibling,d&&domUtils.isWhitespace(d)&&domUtils.remove(d)}}if(l=o(l,e,s,i),r&&(l.setStartBefore(r).collapse(!0),pN=r.parentNode,domUtils.remove(r),domUtils.isBlockElm(pN)&&domUtils.isEmptyNode(pN)&&domUtils.fillNode(this.document,pN)),browser.gecko&&l.collapsed&&1==l.startContainer.nodeType){var a=l.startContainer.childNodes[l.startOffset];a&&1==a.nodeType&&a.tagName.toLowerCase()==e&&l.setStart(a,0).collapse(!0)}return l.select(),!0},queryCommandValue:function(){var t=domUtils.filterNodeList(this.selection.getStartElementPath(),"p h1 h2 h3 h4 h5 h6");return t?t.tagName.toLowerCase():""}}};
UE.plugins.rowspacing=function(){var t=this;t.setOpt({rowspacingtop:["5","10","15","20","25"],rowspacingbottom:["5","10","15","20","25"]}),t.commands.rowspacing={execCommand:function(t,n,e){return this.execCommand("paragraph","p",{style:"margin-"+e+":"+n+"px"}),!0},queryCommandValue:function(t,n){var e,o=domUtils.filterNodeList(this.selection.getStartElementPath(),function(t){return domUtils.isBlockElm(t)});return o?(e=domUtils.getComputedStyle(o,"margin-"+n).replace(/[^\d]/g,""),e?e:0):0}}};
UE.plugins.lineheight=function(){var e=this;e.setOpt({lineheight:["1","1.5","1.75","2","3","4","5"]}),e.commands.lineheight={execCommand:function(e,t){return this.execCommand("paragraph","p",{style:"line-height:"+("1"==t?"normal":t+"em")}),!0},queryCommandValue:function(){var e=domUtils.filterNodeList(this.selection.getStartElementPath(),function(e){return domUtils.isBlockElm(e)});if(e){var t=domUtils.getComputedStyle(e,"line-height");return"normal"==t?1:t.replace(/[^\d.]*/gi,"")}}}};
UE.plugin.register("anchor",function(){return{bindEvents:{ready:function(){utils.cssRule("anchor",".anchorclass{background: url('"+this.options.themePath+this.options.theme+"/images/anchor.gif') no-repeat scroll left center transparent;cursor: auto;display: inline-block;height: 16px;width: 15px;}",this.document)}},outputRule:function(t){utils.each(t.getNodesByTagName("img"),function(t){var e;(e=t.getAttr("anchorname"))&&(t.tagName="a",t.setAttr({anchorname:"",name:e,"class":""}))})},inputRule:function(t){utils.each(t.getNodesByTagName("a"),function(t){var e;(e=t.getAttr("name"))&&!t.getAttr("href")&&(t.tagName="img",t.setAttr({anchorname:t.getAttr("name"),"class":"anchorclass"}),t.setAttr("name"))})},commands:{anchor:{execCommand:function(t,e){var a=this.selection.getRange(),n=a.getClosedNode();if(n&&n.getAttribute("anchorname"))e?n.setAttribute("anchorname",e):(a.setStartBefore(n).setCursor(),domUtils.remove(n));else if(e){var r=this.document.createElement("img");a.collapse(!0),domUtils.setAttributes(r,{anchorname:e,"class":"anchorclass"}),a.insertNode(r).setStartAfter(r).setCursor(!1,!0)}}}}}});
UE.plugins.wordcount=function(){var n=this;n.setOpt("wordCount",!0),n.addListener("contentchange",function(){n.fireEvent("wordcount")});var t;n.addListener("ready",function(){var n=this;domUtils.on(n.body,"keyup",function(o){var e=o.keyCode||o.which,i={16:1,18:1,20:1,37:1,38:1,39:1,40:1};e in i||(clearTimeout(t),t=setTimeout(function(){n.fireEvent("wordcount")},200))})})};
UE.plugins.dragdrop=function(){var e=this;e.ready(function(){domUtils.on(this.body,"dragend",function(){var t=e.selection.getRange(),i=t.getClosedNode()||e.selection.getStart();if(i&&"IMG"==i.tagName){for(var o,l=i.previousSibling;(o=i.nextSibling)&&1==o.nodeType&&"SPAN"==o.tagName&&!o.firstChild;)domUtils.remove(o);(!l||1!=l.nodeType||domUtils.isEmptyBlock(l))&&l||o&&(!o||domUtils.isEmptyBlock(o))||(l&&"P"==l.tagName&&!domUtils.isEmptyBlock(l)?(l.appendChild(i),domUtils.moveChild(o,l),domUtils.remove(o)):o&&"P"==o.tagName&&!domUtils.isEmptyBlock(o)&&o.insertBefore(i,o.firstChild),l&&"P"==l.tagName&&domUtils.isEmptyBlock(l)&&domUtils.remove(l),o&&"P"==o.tagName&&domUtils.isEmptyBlock(o)&&domUtils.remove(o),t.selectNode(i).select(),e.fireEvent("saveScene"))}})}),e.addListener("keyup",function(t,i){var o=i.keyCode||i.which;if(13==o){var l,s=e.selection.getRange();(l=domUtils.findParentByTagName(s.startContainer,"p",!0))&&"center"==domUtils.getComputedStyle(l,"text-align")&&domUtils.removeStyle(l,"text-align")}})};
UE.plugins.undo=function(){function t(t,e){if(t.length!=e.length)return 0;for(var n=0,i=t.length;i>n;n++)if(t[n]!=e[n])return 0;return 1}function e(e,n){return e.collapsed!=n.collapsed?0:t(e.startAddress,n.startAddress)&&t(e.endAddress,n.endAddress)?1:0}function n(){this.list=[],this.index=0,this.hasUndo=!1,this.hasRedo=!1,this.undo=function(){if(this.hasUndo){if(!this.list[this.index-1]&&1==this.list.length)return void this.reset();for(;this.list[this.index].content==this.list[this.index-1].content;)if(this.index--,0==this.index)return this.restore(0);this.restore(--this.index)}},this.redo=function(){if(this.hasRedo){for(;this.list[this.index].content==this.list[this.index+1].content;)if(this.index++,this.index==this.list.length-1)return this.restore(this.index);this.restore(++this.index)}},this.restore=function(){var t=this.editor,e=this.list[this.index],n=UE.htmlparser(e.content.replace(d,""));t.options.autoClearEmptyNode=!1,t.filterInputRule(n),t.options.autoClearEmptyNode=h,t.document.body.innerHTML=n.toHtml(),t.fireEvent("afterscencerestore"),browser.ie&&utils.each(domUtils.getElementsByTagName(t.document,"td th caption p"),function(e){domUtils.isEmptyNode(e)&&domUtils.fillNode(t.document,e)});try{var i=new dom.Range(t.document).moveToAddress(e.address);i.select(a[i.startContainer.nodeName.toLowerCase()])}catch(s){}this.update(),this.clearKey(),t.fireEvent("reset",!0)},this.getScene=function(){var t=this.editor,e=t.selection.getRange(),n=e.createAddress(!1,!0);t.fireEvent("beforegetscene");var i=UE.htmlparser(t.body.innerHTML);t.options.autoClearEmptyNode=!1,t.filterOutputRule(i),t.options.autoClearEmptyNode=h;var s=i.toHtml();return t.fireEvent("aftergetscene"),{address:n,content:s}},this.save=function(t,n){clearTimeout(i);var r=this.getScene(n),d=this.list[this.index];d&&d.content!=r.content&&s.trigger("contentchange"),d&&d.content==r.content&&(t?1:e(d.address,r.address))||(this.list=this.list.slice(0,this.index+1),this.list.push(r),this.list.length>o&&this.list.shift(),this.index=this.list.length-1,this.clearKey(),this.update())},this.update=function(){this.hasRedo=!!this.list[this.index+1],this.hasUndo=!!this.list[this.index-1]},this.reset=function(){this.list=[],this.index=0,this.hasUndo=!1,this.hasRedo=!1,this.clearKey()},this.clearKey=function(){u=0,l=null}}var i,s=this,o=s.options.maxUndoCount||20,r=s.options.maxInputCount||20,d=new RegExp(domUtils.fillChar+"|</hr>","gi"),a={ol:1,ul:1,table:1,tbody:1,tr:1,body:1},h=s.options.autoClearEmptyNode;s.undoManger=new n,s.undoManger.editor=s,s.addListener("saveScene",function(){var t=Array.prototype.splice.call(arguments,1);this.undoManger.save.apply(this.undoManger,t)}),s.addListener("reset",function(t,e){e||this.undoManger.reset()}),s.commands.redo=s.commands.undo={execCommand:function(t){this.undoManger[t]()},queryCommandState:function(t){return this.undoManger["has"+("undo"==t.toLowerCase()?"Undo":"Redo")]?0:-1},notNeedUndo:1};var l,c={16:1,17:1,18:1,37:1,38:1,39:1,40:1},u=0,f=!1;s.addListener("ready",function(){domUtils.on(this.body,"compositionstart",function(){f=!0}),domUtils.on(this.body,"compositionend",function(){f=!1})}),s.addshortcutkey({Undo:"ctrl+90",Redo:"ctrl+89"});var m=!0;s.addListener("keydown",function(t,e){function n(t){t.undoManger.save(!1,!0),t.fireEvent("selectionchange")}var s=this,o=e.keyCode||e.which;if(!(c[o]||e.ctrlKey||e.metaKey||e.shiftKey||e.altKey)){if(f)return;if(!s.selection.getRange().collapsed)return s.undoManger.save(!1,!0),void(m=!1);0==s.undoManger.list.length&&s.undoManger.save(!0),clearTimeout(i),i=setTimeout(function(){if(f)var t=setInterval(function(){f||(n(s),clearInterval(t))},300);else n(s)},200),l=o,u++,u>=r&&n(s)}}),s.addListener("keyup",function(t,e){var n=e.keyCode||e.which;if(!(c[n]||e.ctrlKey||e.metaKey||e.shiftKey||e.altKey)){if(f)return;m||(this.undoManger.save(!1,!0),m=!0)}}),s.stopCmdUndo=function(){s.__hasEnterExecCommand=!0},s.startCmdUndo=function(){s.__hasEnterExecCommand=!1}};
UE.plugin.register("copy",function(){function e(){ZeroClipboard.config({debug:!1,swfPath:o.options.UEDITOR_HOME_URL+"third-party/zeroclipboard/ZeroClipboard.swf"});var e=o.zeroclipboard=new ZeroClipboard;e.on("copy",function(e){var t=e.client,n=o.selection.getRange(),r=document.createElement("div");r.appendChild(n.cloneContents()),t.setText(r.innerText||r.textContent),t.setHtml(r.innerHTML),n.select()}),e.on("mouseover mouseout",function(e){var o=e.target;"mouseover"==e.type?domUtils.addClass(o,"edui-state-hover"):"mouseout"==e.type&&domUtils.removeClasses(o,"edui-state-hover")}),e.on("wrongflash noflash",function(){ZeroClipboard.destroy()})}var o=this;return{bindEvents:{ready:function(){browser.ie||(window.ZeroClipboard?e():utils.loadFile(document,{src:o.options.UEDITOR_HOME_URL+"third-party/zeroclipboard/ZeroClipboard.js",tag:"script",type:"text/javascript",defer:"defer"},function(){e()}))}},commands:{copy:{execCommand:function(e){o.document.execCommand("copy")||alert(o.getLang("copymsg"))}}}}});
UE.plugins.paste=function(){function e(e){var t=this.document;if(!t.getElementById("baidu_pastebin")){var r=this.selection.getRange(),o=r.createBookmark(),n=t.createElement("div");n.id="baidu_pastebin",browser.webkit&&n.appendChild(t.createTextNode(domUtils.fillChar+domUtils.fillChar)),t.body.appendChild(n),o.start.style.display="",n.style.cssText="position:absolute;width:1px;height:1px;overflow:hidden;left:-1000px;white-space:nowrap;top:"+domUtils.getXY(o.start).y+"px",r.selectNodeContents(n).select(!0),setTimeout(function(){if(browser.webkit)for(var i,a=0,s=t.querySelectorAll("#baidu_pastebin");i=s[a++];){if(!domUtils.isEmptyNode(i)){n=i;break}domUtils.remove(i)}try{n.parentNode.removeChild(n)}catch(l){}r.moveToBookmark(o).select(!0),e(n)},0)}}function t(e){return e.replace(/<(\/?)([\w\-]+)([^>]*)>/gi,function(e,t,r,o){return r=r.toLowerCase(),{img:1}[r]?e:(o=o.replace(/([\w\-]*?)\s*=\s*(("([^"]*)")|('([^']*)')|([^\s>]+))/gi,function(e,t,r){return{src:1,href:1,name:1}[t.toLowerCase()]?t+"="+r+" ":""}),{span:1,div:1}[r]?"":"<"+t+r+" "+utils.trim(o)+">")})}function r(e){var r;if(e.firstChild){for(var s,l=domUtils.getElementsByTagName(e,"span"),d=0;s=l[d++];)("_baidu_cut_start"==s.id||"_baidu_cut_end"==s.id)&&domUtils.remove(s);if(browser.webkit){for(var m,f=e.querySelectorAll("div br"),d=0;m=f[d++];){var c=m.parentNode;"DIV"==c.tagName&&1==c.childNodes.length&&(c.innerHTML="<p><br/></p>",domUtils.remove(c))}for(var p,u=e.querySelectorAll("#baidu_pastebin"),d=0;p=u[d++];){var v=o.document.createElement("p");for(p.parentNode.insertBefore(v,p);p.firstChild;)v.appendChild(p.firstChild);domUtils.remove(p)}for(var b,y=e.querySelectorAll("meta"),d=0;b=y[d++];)domUtils.remove(b);var f=e.querySelectorAll("br");for(d=0;b=f[d++];)/^apple-/i.test(b.className)&&domUtils.remove(b)}if(browser.gecko){var h=e.querySelectorAll("[_moz_dirty]");for(d=0;b=h[d++];)b.removeAttribute("_moz_dirty")}if(!browser.ie)for(var b,C=e.querySelectorAll("span.Apple-style-span"),d=0;b=C[d++];)domUtils.remove(b,!0);r=e.innerHTML,r=UE.filterWord(r);var g=UE.htmlparser(r);if(o.options.filterRules&&UE.filterNode(g,o.options.filterRules),o.filterInputRule(g),browser.webkit){var U=g.lastChild();U&&"element"==U.type&&"br"==U.tagName&&g.removeChild(U),utils.each(o.body.querySelectorAll("div"),function(e){domUtils.isEmptyBlock(e)&&domUtils.remove(e,!0)})}if(r={html:g.toHtml()},o.fireEvent("beforepaste",r,g),!r.html)return;g=UE.htmlparser(r.html,!0),1===o.queryCommandState("pasteplain")?o.execCommand("insertHtml",UE.filterNode(g,o.options.filterTxtRules).toHtml(),!0):(UE.filterNode(g,o.options.filterTxtRules),n=g.toHtml(),i=r.html,a=o.selection.getRange().createAddress(!0),o.execCommand("insertHtml",o.getOpt("retainOnlyLabelPasted")===!0?t(i):i,!0)),o.fireEvent("afterpaste",r)}}var o=this;o.setOpt({retainOnlyLabelPasted:!1});var n,i,a;o.addListener("pasteTransfer",function(e,r){if(a&&n&&i&&n!=i){var s=o.selection.getRange();if(s.moveToAddress(a,!0),!s.collapsed){for(;!domUtils.isBody(s.startContainer);){var l=s.startContainer;if(1==l.nodeType){if(l=l.childNodes[s.startOffset],!l){s.setStartBefore(s.startContainer);continue}var d=l.previousSibling;d&&3==d.nodeType&&new RegExp("^[\n\r	 "+domUtils.fillChar+"]*$").test(d.nodeValue)&&s.setStartBefore(d)}if(0!=s.startOffset)break;s.setStartBefore(s.startContainer)}for(;!domUtils.isBody(s.endContainer);){var m=s.endContainer;if(1==m.nodeType){if(m=m.childNodes[s.endOffset],!m){s.setEndAfter(s.endContainer);continue}var f=m.nextSibling;f&&3==f.nodeType&&new RegExp("^[\n\r	"+domUtils.fillChar+"]*$").test(f.nodeValue)&&s.setEndAfter(f)}if(s.endOffset!=s.endContainer[3==s.endContainer.nodeType?"nodeValue":"childNodes"].length)break;s.setEndAfter(s.endContainer)}}s.deleteContents(),s.select(!0),o.__hasEnterExecCommand=!0;var c=i;2===r?c=t(c):r&&(c=n),o.execCommand("inserthtml",c,!0),o.__hasEnterExecCommand=!1;for(var p=o.selection.getRange();!domUtils.isBody(p.startContainer)&&!p.startOffset&&p.startContainer[3==p.startContainer.nodeType?"nodeValue":"childNodes"].length;)p.setStartBefore(p.startContainer);var u=p.createAddress(!0);a.endAddress=u.startAddress}}),o.addListener("ready",function(){domUtils.on(o.body,"cut",function(){var e=o.selection.getRange();!e.collapsed&&o.undoManger&&o.undoManger.save()}),domUtils.on(o.body,browser.ie||browser.opera?"keydown":"paste",function(t){(!browser.ie&&!browser.opera||(t.ctrlKey||t.metaKey)&&"86"==t.keyCode)&&e.call(o,function(e){r(e)})})}),o.commands.paste={execCommand:function(t){browser.ie?(e.call(o,function(e){r(e)}),o.document.execCommand("paste")):alert(o.getLang("pastemsg"))}}};
UE.plugins.pasteplain=function(){var e=this;e.setOpt({pasteplain:!1,filterTxtRules:function(){function e(e){e.tagName="p",e.setStyle()}function t(e){e.parentNode.removeChild(e,!0)}return{"-":"script style object iframe embed input select",p:{$:{}},br:{$:{}},div:function(e){for(var t,n=UE.uNode.createElement("p");t=e.firstChild();)"text"!=t.type&&UE.dom.dtd.$block[t.tagName]?n.firstChild()?(e.parentNode.insertBefore(n,e),n=UE.uNode.createElement("p")):e.parentNode.insertBefore(t,e):n.appendChild(t);n.firstChild()&&e.parentNode.insertBefore(n,e),e.parentNode.removeChild(e)},ol:t,ul:t,dl:t,dt:t,dd:t,li:t,caption:e,th:e,tr:e,h1:e,h2:e,h3:e,h4:e,h5:e,h6:e,td:function(e){var t=!!e.innerText();t&&e.parentNode.insertAfter(UE.uNode.createText(" &nbsp; &nbsp;"),e),e.parentNode.removeChild(e,e.innerText())}}}()});var t=e.options.pasteplain;e.commands.pasteplain={queryCommandState:function(){return t?1:0},execCommand:function(){t=0|!t},notNeedUndo:1}};
UE.plugins.list=function(){function e(e){var t=[];for(var i in e)t.push(i);return t}function t(e){var t=e.className;return domUtils.hasClass(e,/custom_/)?t.match(/custom_(\w+)/)[1]:domUtils.getStyle(e,"list-style-type")}function i(e,i){utils.each(domUtils.getElementsByTagName(e,"ol ul"),function(n){if(domUtils.inDoc(n,e)){var s=n.parentNode;if(s.tagName==n.tagName){var a=t(n)||("OL"==n.tagName?"decimal":"disc"),d=t(s)||("OL"==s.tagName?"decimal":"disc");if(a==d){var p=utils.indexOf(m[n.tagName],a);p=p+1==m[n.tagName].length?0:p+1,o(n,m[n.tagName][p])}}var c=0,f=2;domUtils.hasClass(n,/custom_/)?/[ou]l/i.test(s.tagName)&&domUtils.hasClass(s,/custom_/)||(f=1):/[ou]l/i.test(s.tagName)&&domUtils.hasClass(s,/custom_/)&&(f=3);var u=domUtils.getStyle(n,"list-style-type");u&&(n.style.cssText="list-style-type:"+u),n.className=utils.trim(n.className.replace(/list-paddingleft-\w+/,""))+" list-paddingleft-"+f,utils.each(domUtils.getElementsByTagName(n,"li"),function(e){if(e.style.cssText&&(e.style.cssText=""),!e.firstChild)return void domUtils.remove(e);if(e.parentNode===n){if(c++,domUtils.hasClass(n,/custom_/)){var i=1,l=t(n);if("OL"==n.tagName){if(l)switch(l){case"cn":case"cn1":case"cn2":c>10&&(c%10==0||c>10&&20>c)?i=2:c>20&&(i=3);break;case"num2":c>9&&(i=2)}e.className="list-"+r[l]+c+" list-"+l+"-paddingleft-"+i}else e.className="list-"+r[l]+" list-"+l+"-paddingleft"}else e.className=e.className.replace(/list-[\w\-]+/gi,"");var o=e.getAttribute("class");null===o||o.replace(/\s/g,"")||domUtils.removeAttributes(e,"class")}}),!i&&l(n,n.tagName.toLowerCase(),t(n)||domUtils.getStyle(n,"list-style-type"),!0)}})}function l(e,l,o,n){var s=e.nextSibling;s&&1==s.nodeType&&s.tagName.toLowerCase()==l&&(t(s)||domUtils.getStyle(s,"list-style-type")||("ol"==l?"decimal":"disc"))==o&&(domUtils.moveChild(s,e),0==s.childNodes.length&&domUtils.remove(s)),s&&domUtils.isFillChar(s)&&domUtils.remove(s);var a=e.previousSibling;a&&1==a.nodeType&&a.tagName.toLowerCase()==l&&(t(a)||domUtils.getStyle(a,"list-style-type")||("ol"==l?"decimal":"disc"))==o&&domUtils.moveChild(e,a),a&&domUtils.isFillChar(a)&&domUtils.remove(a),!n&&domUtils.isEmptyBlock(e)&&domUtils.remove(e),t(e)&&i(e.ownerDocument,!0)}function o(e,t){r[t]&&(e.className="custom_"+t);try{domUtils.setStyle(e,"list-style-type",t)}catch(i){}}function n(e){var t=e.previousSibling;t&&domUtils.isEmptyBlock(t)&&domUtils.remove(t),t=e.nextSibling,t&&domUtils.isEmptyBlock(t)&&domUtils.remove(t)}function s(e){for(;e&&!domUtils.isBody(e);){if("TABLE"==e.nodeName)return null;if("LI"==e.nodeName)return e;e=e.parentNode}}var a=this,d={TD:1,PRE:1,BLOCKQUOTE:1},r={cn:"cn-1-",cn1:"cn-2-",cn2:"cn-3-",num:"num-1-",num1:"num-2-",num2:"num-3-",dash:"dash",dot:"dot"};a.setOpt({autoTransWordToList:!1,insertorderedlist:{num:"",num1:"",num2:"",cn:"",cn1:"",cn2:"",decimal:"","lower-alpha":"","lower-roman":"","upper-alpha":"","upper-roman":""},insertunorderedlist:{circle:"",disc:"",square:"",dash:"",dot:""},listDefaultPaddingLeft:"30",listiconpath:"http://bs.baidu.com/listicon/",maxListLevel:-1,disablePInList:!1});var m={OL:e(a.options.insertorderedlist),UL:e(a.options.insertunorderedlist)},p=a.options.listiconpath;for(var c in r)a.options.insertorderedlist.hasOwnProperty(c)||a.options.insertunorderedlist.hasOwnProperty(c)||delete r[c];a.ready(function(){var e=[];for(var t in r){if("dash"==t||"dot"==t)e.push("li.list-"+r[t]+"{background-image:url("+p+r[t]+".gif)}"),e.push("ul.custom_"+t+"{list-style:none;}ul.custom_"+t+" li{background-position:0 3px;background-repeat:no-repeat}");else{for(var i=0;99>i;i++)e.push("li.list-"+r[t]+i+"{background-image:url("+p+"list-"+r[t]+i+".gif)}");e.push("ol.custom_"+t+"{list-style:none;}ol.custom_"+t+" li{background-position:0 3px;background-repeat:no-repeat}")}switch(t){case"cn":e.push("li.list-"+t+"-paddingleft-1{padding-left:25px}"),e.push("li.list-"+t+"-paddingleft-2{padding-left:40px}"),e.push("li.list-"+t+"-paddingleft-3{padding-left:55px}");break;case"cn1":e.push("li.list-"+t+"-paddingleft-1{padding-left:30px}"),e.push("li.list-"+t+"-paddingleft-2{padding-left:40px}"),e.push("li.list-"+t+"-paddingleft-3{padding-left:55px}");break;case"cn2":e.push("li.list-"+t+"-paddingleft-1{padding-left:40px}"),e.push("li.list-"+t+"-paddingleft-2{padding-left:55px}"),e.push("li.list-"+t+"-paddingleft-3{padding-left:68px}");break;case"num":case"num1":e.push("li.list-"+t+"-paddingleft-1{padding-left:25px}");break;case"num2":e.push("li.list-"+t+"-paddingleft-1{padding-left:35px}"),e.push("li.list-"+t+"-paddingleft-2{padding-left:40px}");break;case"dash":e.push("li.list-"+t+"-paddingleft{padding-left:35px}");break;case"dot":e.push("li.list-"+t+"-paddingleft{padding-left:20px}")}}e.push(".list-paddingleft-1{padding-left:0}"),e.push(".list-paddingleft-2{padding-left:"+a.options.listDefaultPaddingLeft+"px}"),e.push(".list-paddingleft-3{padding-left:"+2*a.options.listDefaultPaddingLeft+"px}"),utils.cssRule("list","ol,ul{margin:0;pading:0;"+(browser.ie?"":"width:95%")+"}li{clear:both;}"+e.join("\n"),a.document)}),a.ready(function(){domUtils.on(a.body,"cut",function(){setTimeout(function(){var e,t=a.selection.getRange();if(!t.collapsed&&(e=domUtils.findParentByTagName(t.startContainer,"li",!0))&&!e.nextSibling&&domUtils.isEmptyBlock(e)){var i,l=e.parentNode;if(i=l.previousSibling)domUtils.remove(l),t.setStartAtLast(i).collapse(!0),t.select(!0);else if(i=l.nextSibling)domUtils.remove(l),t.setStartAtFirst(i).collapse(!0),t.select(!0);else{var o=a.document.createElement("p");domUtils.fillNode(a.document,o),l.parentNode.insertBefore(o,l),domUtils.remove(l),t.setStart(o,0).collapse(!0),t.select(!0)}}})})}),a.addListener("beforepaste",function(e,i){var l,o=this,n=o.selection.getRange(),s=UE.htmlparser(i.html,!0);if(l=domUtils.findParentByTagName(n.startContainer,"li",!0)){var a=l.parentNode,d="OL"==a.tagName?"ul":"ol";utils.each(s.getNodesByTagName(d),function(i){if(i.tagName=a.tagName,i.setAttr(),i.parentNode===s)e=t(a)||("OL"==a.tagName?"decimal":"disc");else{var l=i.parentNode.getAttr("class");e=l&&/custom_/.test(l)?l.match(/custom_(\w+)/)[1]:i.parentNode.getStyle("list-style-type"),e||(e="OL"==a.tagName?"decimal":"disc")}var o=utils.indexOf(m[a.tagName],e);i.parentNode!==s&&(o=o+1==m[a.tagName].length?0:o+1);var n=m[a.tagName][o];r[n]?i.setAttr("class","custom_"+n):i.setStyle("list-style-type",n)})}i.html=s.toHtml()}),a.getOpt("disablePInList")===!0&&a.addOutputRule(function(e){utils.each(e.getNodesByTagName("li"),function(e){var t=[],i=0;utils.each(e.children,function(l){if("p"==l.tagName){for(var o;o=l.children.pop();)t.splice(i,0,o),o.parentNode=e,lastNode=o;if(o=t[t.length-1],!o||"element"!=o.type||"br"!=o.tagName){var n=UE.uNode.createElement("br");n.parentNode=e,t.push(n)}i=t.length}}),t.length&&(e.children=t)})}),a.addInputRule(function(e){function t(e,t){var o=t.firstChild();if(o&&"element"==o.type&&"span"==o.tagName&&/Wingdings|Symbol/.test(o.getStyle("font-family"))){for(var n in l)if(l[n]==o.data)return n;return"disc"}for(var n in i)if(i[n].test(e))return n}if(utils.each(e.getNodesByTagName("li"),function(e){for(var t,i=UE.uNode.createElement("p"),l=0;t=e.children[l];)"text"==t.type||dtd.p[t.tagName]?i.appendChild(t):i.firstChild()?(e.insertBefore(i,t),i=UE.uNode.createElement("p"),l+=2):l++;(i.firstChild()&&!i.parentNode||!e.firstChild())&&e.appendChild(i),i.firstChild()||i.innerHTML(browser.ie?"&nbsp;":"<br/>");var o=e.firstChild(),n=o.lastChild();n&&"text"==n.type&&/^\s*$/.test(n.data)&&o.removeChild(n)}),a.options.autoTransWordToList){var i={num1:/^\d+\)/,decimal:/^\d+\./,"lower-alpha":/^[a-z]+\)/,"upper-alpha":/^[A-Z]+\./,cn:/^[\u4E00\u4E8C\u4E09\u56DB\u516d\u4e94\u4e03\u516b\u4e5d]+[\u3001]/,cn2:/^\([\u4E00\u4E8C\u4E09\u56DB\u516d\u4e94\u4e03\u516b\u4e5d]+\)/},l={square:"n"};utils.each(e.getNodesByTagName("p"),function(e){function l(e,t,l){if("ol"==e.tagName)if(browser.ie){var o=t.firstChild();"element"==o.type&&"span"==o.tagName&&i[l].test(o.innerText())&&t.removeChild(o)}else t.innerHTML(t.innerHTML().replace(i[l],""));else t.removeChild(t.firstChild());var n=UE.uNode.createElement("li");n.appendChild(t),e.appendChild(n)}if("MsoListParagraph"==e.getAttr("class")){e.setStyle("margin",""),e.setStyle("margin-left",""),e.setAttr("class","");var o,n=e,s=e;if("li"!=e.parentNode.tagName&&(o=t(e.innerText(),e))){var d=UE.uNode.createElement(a.options.insertorderedlist.hasOwnProperty(o)?"ol":"ul");for(r[o]?d.setAttr("class","custom_"+o):d.setStyle("list-style-type",o);e&&"li"!=e.parentNode.tagName&&t(e.innerText(),e);)n=e.nextSibling(),n||e.parentNode.insertBefore(d,e),l(d,e,o),e=n;!d.parentNode&&e&&e.parentNode&&e.parentNode.insertBefore(d,e)}var m=s.firstChild();m&&"element"==m.type&&"span"==m.tagName&&/^\s*(&nbsp;)+\s*$/.test(m.innerText())&&m.parentNode.removeChild(m)}})}}),a.addListener("contentchange",function(){i(a.document)}),a.addListener("keydown",function(e,t){function i(){t.preventDefault?t.preventDefault():t.returnValue=!1,a.fireEvent("contentchange"),a.undoManger&&a.undoManger.save()}function l(e,t){for(;e&&!domUtils.isBody(e);){if(t(e))return null;if(1==e.nodeType&&/[ou]l/i.test(e.tagName))return e;e=e.parentNode}return null}var o=t.keyCode||t.which;if(13==o&&!t.shiftKey){var s=a.selection.getRange(),d=domUtils.findParent(s.startContainer,function(e){return domUtils.isBlockElm(e)},!0),r=domUtils.findParentByTagName(s.startContainer,"li",!0);if(d&&"PRE"!=d.tagName&&!r){var m=d.innerHTML.replace(new RegExp(domUtils.fillChar,"g"),"");/^\s*1\s*\.[^\d]/.test(m)&&(d.innerHTML=m.replace(/^\s*1\s*\./,""),s.setStartAtLast(d).collapse(!0).select(),a.__hasEnterExecCommand=!0,a.execCommand("insertorderedlist"),a.__hasEnterExecCommand=!1)}var p=a.selection.getRange(),c=l(p.startContainer,function(e){return"TABLE"==e.tagName}),f=p.collapsed?c:l(p.endContainer,function(e){return"TABLE"==e.tagName});if(c&&f&&c===f){if(!p.collapsed){if(c=domUtils.findParentByTagName(p.startContainer,"li",!0),f=domUtils.findParentByTagName(p.endContainer,"li",!0),!c||!f||c!==f){var u=p.cloneRange(),g=u.collapse(!1).createBookmark();p.deleteContents(),u.moveToBookmark(g);var r=domUtils.findParentByTagName(u.startContainer,"li",!0);return n(r),u.select(),void i()}if(p.deleteContents(),r=domUtils.findParentByTagName(p.startContainer,"li",!0),r&&domUtils.isEmptyBlock(r))return y=r.previousSibling,next=r.nextSibling,v=a.document.createElement("p"),domUtils.fillNode(a.document,v),h=r.parentNode,y&&next?(p.setStart(next,0).collapse(!0).select(!0),domUtils.remove(r)):((y||next)&&y?r.parentNode.parentNode.insertBefore(v,h.nextSibling):h.parentNode.insertBefore(v,h),domUtils.remove(r),h.firstChild||domUtils.remove(h),p.setStart(v,0).setCursor()),void i()}if(r=domUtils.findParentByTagName(p.startContainer,"li",!0)){if(domUtils.isEmptyBlock(r)){g=p.createBookmark();var h=r.parentNode;if(r!==h.lastChild?(domUtils.breakParent(r,h),n(r)):(h.parentNode.insertBefore(r,h.nextSibling),domUtils.isEmptyNode(h)&&domUtils.remove(h)),!dtd.$list[r.parentNode.tagName])if(domUtils.isBlockElm(r.firstChild))domUtils.remove(r,!0);else{for(v=a.document.createElement("p"),r.parentNode.insertBefore(v,r);r.firstChild;)v.appendChild(r.firstChild);domUtils.remove(r)}p.moveToBookmark(g).select()}else{var N=r.firstChild;if(!N||!domUtils.isBlockElm(N)){var v=a.document.createElement("p");for(!r.firstChild&&domUtils.fillNode(a.document,v);r.firstChild;)v.appendChild(r.firstChild);r.appendChild(v),N=v}var C=a.document.createElement("span");p.insertNode(C),domUtils.breakParent(C,r);var U=C.nextSibling;N=U.firstChild,N||(v=a.document.createElement("p"),domUtils.fillNode(a.document,v),U.appendChild(v),N=v),domUtils.isEmptyNode(N)&&(N.innerHTML="",domUtils.fillNode(a.document,N)),p.setStart(N,0).collapse(!0).shrinkBoundary().select(),domUtils.remove(C);var y=U.previousSibling;y&&domUtils.isEmptyBlock(y)&&(y.innerHTML="<p></p>",domUtils.fillNode(a.document,y.firstChild))}i()}}}if(8==o&&(p=a.selection.getRange(),p.collapsed&&domUtils.isStartInblock(p)&&(u=p.cloneRange().trimBoundary(),r=domUtils.findParentByTagName(p.startContainer,"li",!0),r&&domUtils.isStartInblock(u)))){if(c=domUtils.findParentByTagName(p.startContainer,"p",!0),c&&c!==r.firstChild){var h=domUtils.findParentByTagName(c,["ol","ul"]);return domUtils.breakParent(c,h),n(c),a.fireEvent("contentchange"),p.setStart(c,0).setCursor(!1,!0),a.fireEvent("saveScene"),void domUtils.preventDefault(t)}if(r&&(y=r.previousSibling)){if(46==o&&r.childNodes.length)return;if(dtd.$list[y.tagName]&&(y=y.lastChild),a.undoManger&&a.undoManger.save(),N=r.firstChild,domUtils.isBlockElm(N))if(domUtils.isEmptyNode(N))for(y.appendChild(N),p.setStart(N,0).setCursor(!1,!0);r.firstChild;)y.appendChild(r.firstChild);else C=a.document.createElement("span"),p.insertNode(C),domUtils.isEmptyBlock(y)&&(y.innerHTML=""),domUtils.moveChild(r,y),p.setStartBefore(C).collapse(!0).select(!0),domUtils.remove(C);else if(domUtils.isEmptyNode(r)){var v=a.document.createElement("p");y.appendChild(v),p.setStart(v,0).setCursor()}else for(p.setEnd(y,y.childNodes.length).collapse().select(!0);r.firstChild;)y.appendChild(r.firstChild);return domUtils.remove(r),a.fireEvent("contentchange"),a.fireEvent("saveScene"),void domUtils.preventDefault(t)}if(r&&!r.previousSibling){var h=r.parentNode,g=p.createBookmark();if(domUtils.isTagNode(h.parentNode,"ol ul"))h.parentNode.insertBefore(r,h),domUtils.isEmptyNode(h)&&domUtils.remove(h);else{for(;r.firstChild;)h.parentNode.insertBefore(r.firstChild,h);domUtils.remove(r),domUtils.isEmptyNode(h)&&domUtils.remove(h)}return p.moveToBookmark(g).setCursor(!1,!0),a.fireEvent("contentchange"),a.fireEvent("saveScene"),void domUtils.preventDefault(t)}}}),a.addListener("keyup",function(e,i){var o=i.keyCode||i.which;if(8==o){var n,s=a.selection.getRange();(n=domUtils.findParentByTagName(s.startContainer,["ol","ul"],!0))&&l(n,n.tagName.toLowerCase(),t(n)||domUtils.getComputedStyle(n,"list-style-type"),!0)}}),a.addListener("tabkeydown",function(){function e(e){if(-1!=a.options.maxListLevel){for(var t=e.parentNode,i=0;/[ou]l/i.test(t.tagName);)i++,t=t.parentNode;if(i>=a.options.maxListLevel)return!0}}var i=a.selection.getRange(),n=domUtils.findParentByTagName(i.startContainer,"li",!0);if(n){var s;if(!i.collapsed){a.fireEvent("saveScene"),s=i.createBookmark();for(var d,r,p=0,c=domUtils.findParents(n);r=c[p++];)if(domUtils.isTagNode(r,"ol ul")){d=r;break}var f=n;if(s.end)for(;f&&!(domUtils.getPosition(f,s.end)&domUtils.POSITION_FOLLOWING);)if(e(f))f=domUtils.getNextDomNode(f,!1,null,function(e){return e!==d});else{var u=f.parentNode,g=a.document.createElement(u.tagName),h=utils.indexOf(m[g.tagName],t(u)||domUtils.getComputedStyle(u,"list-style-type")),N=h+1==m[g.tagName].length?0:h+1,v=m[g.tagName][N];for(o(g,v),u.insertBefore(g,f);f&&!(domUtils.getPosition(f,s.end)&domUtils.POSITION_FOLLOWING);){if(n=f.nextSibling,g.appendChild(f),!n||domUtils.isTagNode(n,"ol ul")){if(n)for(;(n=n.firstChild)&&"LI"!=n.tagName;);else n=domUtils.getNextDomNode(f,!1,null,function(e){return e!==d});break}f=n}l(g,g.tagName.toLowerCase(),v),f=n}return a.fireEvent("contentchange"),i.moveToBookmark(s).select(),!0}if(e(n))return!0;var u=n.parentNode,g=a.document.createElement(u.tagName),h=utils.indexOf(m[g.tagName],t(u)||domUtils.getComputedStyle(u,"list-style-type"));h=h+1==m[g.tagName].length?0:h+1;var v=m[g.tagName][h];if(o(g,v),domUtils.isStartInblock(i))return a.fireEvent("saveScene"),s=i.createBookmark(),u.insertBefore(g,n),g.appendChild(n),l(g,g.tagName.toLowerCase(),v),a.fireEvent("contentchange"),i.moveToBookmark(s).select(!0),!0}}),a.commands.insertorderedlist=a.commands.insertunorderedlist={execCommand:function(e,i){i||(i="insertorderedlist"==e.toLowerCase()?"decimal":"disc");var n=this,a=this.selection.getRange(),r=function(e){return 1==e.nodeType?"br"!=e.tagName.toLowerCase():!domUtils.isWhitespace(e)},m="insertorderedlist"==e.toLowerCase()?"ol":"ul",p=n.document.createDocumentFragment();a.adjustmentBoundary().shrinkBoundary();var c,f,u,g,h=a.createBookmark(!0),N=s(n.document.getElementById(h.start)),v=0,C=s(n.document.getElementById(h.end)),U=0;if(N||C){if(N&&(c=N.parentNode),h.end||(C=N),C&&(f=C.parentNode),c===f){for(;N!==C;){if(g=N,N=N.nextSibling,!domUtils.isBlockElm(g.firstChild)){for(var y=n.document.createElement("p");g.firstChild;)y.appendChild(g.firstChild);g.appendChild(y)}p.appendChild(g)}if(g=n.document.createElement("span"),c.insertBefore(g,C),!domUtils.isBlockElm(C.firstChild)){for(y=n.document.createElement("p");C.firstChild;)y.appendChild(C.firstChild);C.appendChild(y)}p.appendChild(C),domUtils.breakParent(g,c),domUtils.isEmptyNode(g.previousSibling)&&domUtils.remove(g.previousSibling),domUtils.isEmptyNode(g.nextSibling)&&domUtils.remove(g.nextSibling);var E=t(c)||domUtils.getComputedStyle(c,"list-style-type")||("insertorderedlist"==e.toLowerCase()?"decimal":"disc");if(c.tagName.toLowerCase()==m&&E==i){for(var B,k=0,b=n.document.createDocumentFragment();B=p.firstChild;)if(domUtils.isTagNode(B,"ol ul"))b.appendChild(B);else for(;B.firstChild;)b.appendChild(B.firstChild),domUtils.remove(B);g.parentNode.insertBefore(b,g)}else u=n.document.createElement(m),o(u,i),u.appendChild(p),g.parentNode.insertBefore(u,g);return domUtils.remove(g),u&&l(u,m,i),void a.moveToBookmark(h).select()}if(N){for(;N;){if(g=N.nextSibling,domUtils.isTagNode(N,"ol ul"))p.appendChild(N);else{for(var S=n.document.createDocumentFragment(),T=0;N.firstChild;)domUtils.isBlockElm(N.firstChild)&&(T=1),S.appendChild(N.firstChild);if(T)p.appendChild(S);else{var x=n.document.createElement("p");x.appendChild(S),p.appendChild(x)}domUtils.remove(N)}N=g}c.parentNode.insertBefore(p,c.nextSibling),domUtils.isEmptyNode(c)?(a.setStartBefore(c),domUtils.remove(c)):a.setStartAfter(c),v=1}if(C&&domUtils.inDoc(f,n.document)){for(N=f.firstChild;N&&N!==C;){if(g=N.nextSibling,domUtils.isTagNode(N,"ol ul"))p.appendChild(N);else{for(S=n.document.createDocumentFragment(),T=0;N.firstChild;)domUtils.isBlockElm(N.firstChild)&&(T=1),S.appendChild(N.firstChild);T?p.appendChild(S):(x=n.document.createElement("p"),x.appendChild(S),p.appendChild(x)),domUtils.remove(N)}N=g}var L=domUtils.createElement(n.document,"div",{tmpDiv:1});domUtils.moveChild(C,L),p.appendChild(L),domUtils.remove(C),f.parentNode.insertBefore(p,f),a.setEndBefore(f),domUtils.isEmptyNode(f)&&domUtils.remove(f),U=1}}v||a.setStartBefore(n.document.getElementById(h.start)),h.end&&!U&&a.setEndAfter(n.document.getElementById(h.end)),a.enlarge(!0,function(e){return d[e.tagName]}),p=n.document.createDocumentFragment();for(var P,w=a.createBookmark(),D=domUtils.getNextDomNode(w.start,!1,r),O=a.cloneRange(),_=domUtils.isBlockElm;D&&D!==w.end&&domUtils.getPosition(D,w.end)&domUtils.POSITION_PRECEDING;)if(3==D.nodeType||dtd.li[D.tagName]){if(1==D.nodeType&&dtd.$list[D.tagName]){for(;D.firstChild;)p.appendChild(D.firstChild);P=domUtils.getNextDomNode(D,!1,r),domUtils.remove(D),D=P;continue}for(P=D,O.setStartBefore(D);D&&D!==w.end&&(!_(D)||domUtils.isBookmarkNode(D));)P=D,D=domUtils.getNextDomNode(D,!1,null,function(e){return!d[e.tagName]});D&&_(D)&&(g=domUtils.getNextDomNode(P,!1,r),g&&domUtils.isBookmarkNode(g)&&(D=domUtils.getNextDomNode(g,!1,r),P=g)),O.setEndAfter(P),D=domUtils.getNextDomNode(P,!1,r);var A=a.document.createElement("li");if(A.appendChild(O.extractContents()),domUtils.isEmptyNode(A)){for(var P=a.document.createElement("p");A.firstChild;)P.appendChild(A.firstChild);A.appendChild(P)}p.appendChild(A)}else D=domUtils.getNextDomNode(D,!0,r);a.moveToBookmark(w).collapse(!0),u=n.document.createElement(m),o(u,i),u.appendChild(p),a.insertNode(u),l(u,m,i);for(var B,k=0,I=domUtils.getElementsByTagName(u,"div");B=I[k++];)B.getAttribute("tmpDiv")&&domUtils.remove(B,!0);a.moveToBookmark(h).select()},queryCommandState:function(e){for(var t,i="insertorderedlist"==e.toLowerCase()?"ol":"ul",l=this.selection.getStartElementPath(),o=0;t=l[o++];){if("TABLE"==t.nodeName)return 0;if(i==t.nodeName.toLowerCase())return 1}return 0},queryCommandValue:function(e){for(var i,l,o="insertorderedlist"==e.toLowerCase()?"ol":"ul",n=this.selection.getStartElementPath(),s=0;l=n[s++];){if("TABLE"==l.nodeName){i=null;break}if(o==l.nodeName.toLowerCase()){i=l;break}}return i?t(i)||domUtils.getComputedStyle(i,"list-style-type"):null}}};
!function(){var e={textarea:function(e,t){var r=t.ownerDocument.createElement("textarea");return r.style.cssText="position:absolute;resize:none;width:100%;height:100%;border:0;padding:0;margin:0;overflow-y:auto;",browser.ie&&browser.version<8&&(r.style.width=t.offsetWidth+"px",r.style.height=t.offsetHeight+"px",t.onresize=function(){r.style.width=t.offsetWidth+"px",r.style.height=t.offsetHeight+"px"}),t.appendChild(r),{setContent:function(e){r.value=e},getContent:function(){return r.value},select:function(){var e;browser.ie?(e=r.createTextRange(),e.collapse(!0),e.select()):(r.setSelectionRange(0,0),r.focus())},dispose:function(){t.removeChild(r),t.onresize=null,r=null,t=null}}},codemirror:function(e,t){var r=window.CodeMirror(t,{mode:"text/html",tabMode:"indent",lineNumbers:!0,lineWrapping:!0}),o=r.getWrapperElement();return o.style.cssText='position:absolute;left:0;top:0;width:100%;height:100%;font-family:consolas,"Courier new",monospace;font-size:13px;',r.getScrollerElement().style.cssText="position:absolute;left:0;top:0;width:100%;height:100%;",r.refresh(),{getCodeMirror:function(){return r},setContent:function(e){r.setValue(e)},getContent:function(){return r.getValue()},select:function(){r.focus()},dispose:function(){t.removeChild(o),o=null,r=null}}}};UE.plugins.source=function(){function t(t){return e["codemirror"==i.sourceEditor&&window.CodeMirror?"codemirror":"textarea"](n,t)}var r,o,n=this,i=this.options,s=!1;i.sourceEditor=browser.ie?"textarea":i.sourceEditor||"codemirror",n.setOpt({sourceEditorFirst:!1});var c,a,l;n.commands.source={execCommand:function(){if(s=!s){l=n.selection.getRange().createAddress(!1,!0),n.undoManger&&n.undoManger.save(!0),browser.gecko&&(n.body.contentEditable=!1),c=n.iframe.style.cssText,n.iframe.style.cssText+="position:absolute;left:-32768px;top:-32768px;",n.fireEvent("beforegetcontent");var e=UE.htmlparser(n.body.innerHTML);n.filterOutputRule(e),e.traversal(function(e){if("element"==e.type)switch(e.tagName){case"td":case"th":case"caption":e.children&&1==e.children.length&&"br"==e.firstChild().tagName&&e.removeChild(e.firstChild());break;case"pre":e.innerText(e.innerText().replace(/&nbsp;/g," "))}}),n.fireEvent("aftergetcontent");var i=e.toHtml(!0);r=t(n.iframe.parentNode),r.setContent(i),o=n.setContent,n.setContent=function(e){var t=UE.htmlparser(e);n.filterInputRule(t),e=t.toHtml(),r.setContent(e)},setTimeout(function(){r.select(),n.addListener("fullscreenchanged",function(){try{r.getCodeMirror().refresh()}catch(e){}})}),a=n.getContent,n.getContent=function(){return r.getContent()||"<p>"+(browser.ie?"":"<br/>")+"</p>"}}else{n.iframe.style.cssText=c;var d=r.getContent()||"<p>"+(browser.ie?"":"<br/>")+"</p>";d=d.replace(new RegExp("[\\r\\t\\n ]*</?(\\w+)\\s*(?:[^>]*)>","g"),function(e,t){return t&&!dtd.$inlineWithA[t.toLowerCase()]?e.replace(/(^[\n\r\t ]*)|([\n\r\t ]*$)/g,""):e.replace(/(^[\n\r\t]*)|([\n\r\t]*$)/g,"")}),n.setContent=o,n.setContent(d),r.dispose(),r=null,n.getContent=a;var u=n.body.firstChild;if(u||(n.body.innerHTML="<p>"+(browser.ie?"":"<br/>")+"</p>",u=n.body.firstChild),n.undoManger&&n.undoManger.save(!0),browser.gecko){var f=document.createElement("input");f.style.cssText="position:absolute;left:0;top:-32768px",document.body.appendChild(f),n.body.contentEditable=!1,setTimeout(function(){domUtils.setViewportOffset(f,{left:-32768,top:0}),f.focus(),setTimeout(function(){n.body.contentEditable=!0,n.selection.getRange().moveToAddress(l).select(!0),domUtils.remove(f)})})}else try{n.selection.getRange().moveToAddress(l).select(!0)}catch(p){}}this.fireEvent("sourcemodechanged",s)},queryCommandState:function(){return 0|s},notNeedUndo:1};var d=n.queryCommandState;n.queryCommandState=function(e){return e=e.toLowerCase(),s?e in{source:1,fullscreen:1}?1:-1:d.apply(this,arguments)},"codemirror"==i.sourceEditor&&n.addListener("ready",function(){utils.loadFile(document,{src:i.codeMirrorJsUrl||i.UEDITOR_HOME_URL+"third-party/codemirror/codemirror.js",tag:"script",type:"text/javascript",defer:"defer"},function(){i.sourceEditorFirst&&setTimeout(function(){n.execCommand("source")},0)}),utils.loadFile(document,{tag:"link",rel:"stylesheet",type:"text/css",href:i.codeMirrorCssUrl||i.UEDITOR_HOME_URL+"third-party/codemirror/codemirror.css"})})}}();
UE.plugins.enterkey=function(){var e,t=this,r=t.options.enterTag;t.addListener("keyup",function(r,n){var o=n.keyCode||n.which;if(13==o){var a,s=t.selection.getRange(),i=s.startContainer;if(browser.ie)t.fireEvent("saveScene",!0,!0);else{if(/h\d/i.test(e)){if(browser.gecko){var d=domUtils.findParentByTagName(i,["h1","h2","h3","h4","h5","h6","blockquote","caption","table"],!0);d||(t.document.execCommand("formatBlock",!1,"<p>"),a=1)}else if(1==i.nodeType){var l,f=t.document.createTextNode("");if(s.insertNode(f),l=domUtils.findParentByTagName(f,"div",!0)){for(var m=t.document.createElement("p");l.firstChild;)m.appendChild(l.firstChild);l.parentNode.insertBefore(m,l),domUtils.remove(l),s.setStartBefore(f).setCursor(),a=1}domUtils.remove(f)}t.undoManger&&a&&t.undoManger.save()}browser.opera&&s.select()}}}),t.addListener("keydown",function(n,o){var a=o.keyCode||o.which;if(13==a){if(t.fireEvent("beforeenterkeydown"))return void domUtils.preventDefault(o);t.fireEvent("saveScene",!0,!0),e="";var s=t.selection.getRange();if(!s.collapsed){var i=s.startContainer,d=s.endContainer,l=domUtils.findParentByTagName(i,"td",!0),f=domUtils.findParentByTagName(d,"td",!0);if(l&&f&&l!==f||!l&&f||l&&!f)return void(o.preventDefault?o.preventDefault():o.returnValue=!1)}if("p"==r)browser.ie||(i=domUtils.findParentByTagName(s.startContainer,["ol","ul","p","h1","h2","h3","h4","h5","h6","blockquote","caption"],!0),i||browser.opera?(e=i.tagName,"p"==i.tagName.toLowerCase()&&browser.gecko&&domUtils.removeDirtyAttr(i)):(t.document.execCommand("formatBlock",!1,"<p>"),browser.gecko&&(s=t.selection.getRange(),i=domUtils.findParentByTagName(s.startContainer,"p",!0),i&&domUtils.removeDirtyAttr(i))));else if(o.preventDefault?o.preventDefault():o.returnValue=!1,s.collapsed){u=s.document.createElement("br"),s.insertNode(u);var m=u.parentNode;m.lastChild===u?(u.parentNode.insertBefore(u.cloneNode(!0),u),s.setStartBefore(u)):s.setStartAfter(u),s.setCursor()}else if(s.deleteContents(),i=s.startContainer,1==i.nodeType&&(i=i.childNodes[s.startOffset])){for(;1==i.nodeType;){if(dtd.$empty[i.tagName])return s.setStartBefore(i).setCursor(),t.undoManger&&t.undoManger.save(),!1;if(!i.firstChild){var u=s.document.createElement("br");return i.appendChild(u),s.setStart(i,0).setCursor(),t.undoManger&&t.undoManger.save(),!1}i=i.firstChild}i===s.startContainer.childNodes[s.startOffset]?(u=s.document.createElement("br"),s.insertNode(u).setCursor()):s.setStart(i,0).setCursor()}else u=s.document.createElement("br"),s.insertNode(u).setStartAfter(u).setCursor()}})};
UE.plugins.keystrokes=function(){var e=this,t=!0;e.addListener("keydown",function(r,o){var i=o.keyCode||o.which,n=e.selection.getRange();if(!n.collapsed&&!(o.ctrlKey||o.shiftKey||o.altKey||o.metaKey)&&(i>=65&&90>=i||i>=48&&57>=i||i>=96&&111>=i||{13:1,8:1,46:1}[i])){var s=n.startContainer;if(domUtils.isFillChar(s)&&n.setStartBefore(s),s=n.endContainer,domUtils.isFillChar(s)&&n.setEndAfter(s),n.txtToElmBoundary(),n.endContainer&&1==n.endContainer.nodeType&&(s=n.endContainer.childNodes[n.endOffset],s&&domUtils.isBr(s)&&n.setEndAfter(s)),0==n.startOffset&&(s=n.startContainer,domUtils.isBoundaryNode(s,"firstChild")&&(s=n.endContainer,n.endOffset==(3==s.nodeType?s.nodeValue.length:s.childNodes.length)&&domUtils.isBoundaryNode(s,"lastChild"))))return e.fireEvent("saveScene"),e.body.innerHTML="<p>"+(browser.ie?"":"<br/>")+"</p>",n.setStart(e.body.firstChild,0).setCursor(!1,!0),void e._selectionChange()}if(i==keymap.Backspace){if(n=e.selection.getRange(),t=n.collapsed,e.fireEvent("delkeydown",o))return;var a,l;if(n.collapsed&&n.inFillChar()&&(a=n.startContainer,domUtils.isFillChar(a)?(n.setStartBefore(a).shrinkBoundary(!0).collapse(!0),domUtils.remove(a)):(a.nodeValue=a.nodeValue.replace(new RegExp("^"+domUtils.fillChar),""),n.startOffset--,n.collapse(!0).select(!0))),a=n.getClosedNode())return e.fireEvent("saveScene"),n.setStartBefore(a),domUtils.remove(a),n.setCursor(),e.fireEvent("saveScene"),void domUtils.preventDefault(o);if(!browser.ie&&(a=domUtils.findParentByTagName(n.startContainer,"table",!0),l=domUtils.findParentByTagName(n.endContainer,"table",!0),a&&!l||!a&&l||a!==l))return void o.preventDefault()}if(i==keymap.Tab){var d={ol:1,ul:1,table:1};if(e.fireEvent("tabkeydown",o))return void domUtils.preventDefault(o);var f=e.selection.getRange();e.fireEvent("saveScene");for(var m=0,c="",v=e.options.tabSize||4,C=e.options.tabNode||"&nbsp;";v>m;m++)c+=C;var p=e.document.createElement("span");if(p.innerHTML=c+domUtils.fillChar,f.collapsed)f.insertNode(p.cloneNode(!0).firstChild).setCursor(!0);else{var u=function(e){return domUtils.isBlockElm(e)&&!d[e.tagName.toLowerCase()]};if(a=domUtils.findParent(f.startContainer,u,!0),l=domUtils.findParent(f.endContainer,u,!0),a&&l&&a===l)f.deleteContents(),f.insertNode(p.cloneNode(!0).firstChild).setCursor(!0);else{var h=f.createBookmark();f.enlarge(!0);for(var U=f.createBookmark(),y=domUtils.getNextDomNode(U.start,!1,u);y&&!(domUtils.getPosition(y,U.end)&domUtils.POSITION_FOLLOWING);)y.insertBefore(p.cloneNode(!0).firstChild,y.firstChild),y=domUtils.getNextDomNode(y,!1,u);f.moveToBookmark(U).moveToBookmark(h).select()}}domUtils.preventDefault(o)}if(browser.gecko&&46==i&&(f=e.selection.getRange(),f.collapsed&&(a=f.startContainer,domUtils.isEmptyBlock(a)))){for(var g=a.parentNode;1==domUtils.getChildCount(g)&&!domUtils.isBody(g);)a=g,g=g.parentNode;return void(a===g.lastChild&&o.preventDefault())}}),e.addListener("keyup",function(e,r){var o,i=r.keyCode||r.which,n=this;if(i==keymap.Backspace){if(n.fireEvent("delkeyup"))return;if(o=n.selection.getRange(),o.collapsed){var s,a=["h1","h2","h3","h4","h5","h6"];if((s=domUtils.findParentByTagName(o.startContainer,a,!0))&&domUtils.isEmptyBlock(s)){var l=s.previousSibling;if(l&&"TABLE"!=l.nodeName)return domUtils.remove(s),void o.setStartAtLast(l).setCursor(!1,!0);var d=s.nextSibling;if(d&&"TABLE"!=d.nodeName)return domUtils.remove(s),void o.setStartAtFirst(d).setCursor(!1,!0)}if(domUtils.isBody(o.startContainer)){var s=domUtils.createElement(n.document,"p",{innerHTML:browser.ie?domUtils.fillChar:"<br/>"});o.insertNode(s).setStart(s,0).setCursor(!1,!0)}}if(!t&&(3==o.startContainer.nodeType||1==o.startContainer.nodeType&&domUtils.isEmptyBlock(o.startContainer)))if(browser.ie){var f=o.document.createElement("span");o.insertNode(f).setStartBefore(f).collapse(!0),o.select(),domUtils.remove(f)}else o.select()}})};
UE.plugins.fiximgclick=function(){function e(){this.editor=null,this.resizer=null,this.cover=null,this.doc=document,this.prePos={x:0,y:0},this.startPos={x:0,y:0}}var t=!1;return function(){var o=[[0,0,-1,-1],[0,0,0,-1],[0,0,1,-1],[0,0,-1,0],[0,0,1,0],[0,0,-1,1],[0,0,0,1],[0,0,1,1]];e.prototype={init:function(e){var t=this;t.editor=e,t.startPos=this.prePos={x:0,y:0},t.dragId=-1;var o=[],s=t.cover=document.createElement("div"),r=t.resizer=document.createElement("div");for(s.id=t.editor.ui.id+"_imagescale_cover",s.style.cssText="position:absolute;display:none;z-index:"+t.editor.options.zIndex+";filter:alpha(opacity=0); opacity:0;background:#CCC;",domUtils.on(s,"mousedown click",function(){t.hide()}),i=0;i<8;i++)o.push('<span class="edui-editor-imagescale-hand'+i+'"></span>');r.id=t.editor.ui.id+"_imagescale",r.className="edui-editor-imagescale",r.innerHTML=o.join(""),r.style.cssText+=";display:none;border:1px solid #3b77ff;z-index:"+t.editor.options.zIndex+";",t.editor.ui.getDom().appendChild(s),t.editor.ui.getDom().appendChild(r),t.initStyle(),t.initEvents()},initStyle:function(){utils.cssRule("imagescale",".edui-editor-imagescale{display:none;position:absolute;border:1px solid #38B2CE;cursor:hand;-webkit-box-sizing: content-box;-moz-box-sizing: content-box;box-sizing: content-box;}.edui-editor-imagescale span{position:absolute;width:6px;height:6px;overflow:hidden;font-size:0px;display:block;background-color:#3C9DD0;}.edui-editor-imagescale .edui-editor-imagescale-hand0{cursor:nw-resize;top:0;margin-top:-4px;left:0;margin-left:-4px;}.edui-editor-imagescale .edui-editor-imagescale-hand1{cursor:n-resize;top:0;margin-top:-4px;left:50%;margin-left:-4px;}.edui-editor-imagescale .edui-editor-imagescale-hand2{cursor:ne-resize;top:0;margin-top:-4px;left:100%;margin-left:-3px;}.edui-editor-imagescale .edui-editor-imagescale-hand3{cursor:w-resize;top:50%;margin-top:-4px;left:0;margin-left:-4px;}.edui-editor-imagescale .edui-editor-imagescale-hand4{cursor:e-resize;top:50%;margin-top:-4px;left:100%;margin-left:-3px;}.edui-editor-imagescale .edui-editor-imagescale-hand5{cursor:sw-resize;top:100%;margin-top:-3px;left:0;margin-left:-4px;}.edui-editor-imagescale .edui-editor-imagescale-hand6{cursor:s-resize;top:100%;margin-top:-3px;left:50%;margin-left:-4px;}.edui-editor-imagescale .edui-editor-imagescale-hand7{cursor:se-resize;top:100%;margin-top:-3px;left:100%;margin-left:-3px;}")},initEvents:function(){var e=this;e.startPos.x=e.startPos.y=0,e.isDraging=!1},_eventHandler:function(e){var i=this;switch(e.type){case"mousedown":var o,o=e.target||e.srcElement;-1!=o.className.indexOf("edui-editor-imagescale-hand")&&-1==i.dragId&&(i.dragId=o.className.slice(-1),i.startPos.x=i.prePos.x=e.clientX,i.startPos.y=i.prePos.y=e.clientY,domUtils.on(i.doc,"mousemove",i.proxy(i._eventHandler,i)));break;case"mousemove":-1!=i.dragId&&(i.updateContainerStyle(i.dragId,{x:e.clientX-i.prePos.x,y:e.clientY-i.prePos.y}),i.prePos.x=e.clientX,i.prePos.y=e.clientY,t=!0,i.updateTargetElement());break;case"mouseup":-1!=i.dragId&&(i.updateContainerStyle(i.dragId,{x:e.clientX-i.prePos.x,y:e.clientY-i.prePos.y}),i.updateTargetElement(),i.target.parentNode&&i.attachTo(i.target),i.dragId=-1),domUtils.un(i.doc,"mousemove",i.proxy(i._eventHandler,i)),t&&(t=!1,i.editor.fireEvent("contentchange"))}},updateTargetElement:function(){var e=this;domUtils.setStyles(e.target,{width:e.resizer.style.width,height:e.resizer.style.height}),e.target.width=parseInt(e.resizer.style.width),e.target.height=parseInt(e.resizer.style.height),e.attachTo(e.target)},updateContainerStyle:function(e,t){var i,s=this,r=s.resizer;0!=o[e][0]&&(i=parseInt(r.style.left)+t.x,r.style.left=s._validScaledProp("left",i)+"px"),0!=o[e][1]&&(i=parseInt(r.style.top)+t.y,r.style.top=s._validScaledProp("top",i)+"px"),0!=o[e][2]&&(i=r.clientWidth+o[e][2]*t.x,r.style.width=s._validScaledProp("width",i)+"px"),0!=o[e][3]&&(i=r.clientHeight+o[e][3]*t.y,r.style.height=s._validScaledProp("height",i)+"px")},_validScaledProp:function(e,t){var i=this.resizer,o=document;switch(t=isNaN(t)?0:t,e){case"left":return 0>t?0:t+i.clientWidth>o.clientWidth?o.clientWidth-i.clientWidth:t;case"top":return 0>t?0:t+i.clientHeight>o.clientHeight?o.clientHeight-i.clientHeight:t;case"width":return 0>=t?1:t+i.offsetLeft>o.clientWidth?o.clientWidth-i.offsetLeft:t;case"height":return 0>=t?1:t+i.offsetTop>o.clientHeight?o.clientHeight-i.offsetTop:t}},hideCover:function(){this.cover.style.display="none"},showCover:function(){var e=this,t=domUtils.getXY(e.editor.ui.getDom()),i=domUtils.getXY(e.editor.iframe);domUtils.setStyles(e.cover,{width:e.editor.iframe.offsetWidth+"px",height:e.editor.iframe.offsetHeight+"px",top:i.y-t.y+"px",left:i.x-t.x+"px",position:"absolute",display:""})},show:function(e){var t=this;t.resizer.style.display="block",e&&t.attachTo(e),domUtils.on(this.resizer,"mousedown",t.proxy(t._eventHandler,t)),domUtils.on(t.doc,"mouseup",t.proxy(t._eventHandler,t)),t.showCover(),t.editor.fireEvent("afterscaleshow",t),t.editor.fireEvent("saveScene")},hide:function(){var e=this;e.hideCover(),e.resizer.style.display="none",domUtils.un(e.resizer,"mousedown",e.proxy(e._eventHandler,e)),domUtils.un(e.doc,"mouseup",e.proxy(e._eventHandler,e)),e.editor.fireEvent("afterscalehide",e)},proxy:function(e,t){return function(i){return e.apply(t||this,arguments)}},attachTo:function(e){var t=this,i=t.target=e,o=this.resizer,s=domUtils.getXY(i),r=domUtils.getXY(t.editor.iframe),n=domUtils.getXY(o.parentNode);domUtils.setStyles(o,{width:i.width+"px",height:i.height+"px",left:r.x+s.x-t.editor.document.body.scrollLeft-n.x-parseInt(o.style.borderLeftWidth)+"px",top:r.y+s.y-t.editor.document.body.scrollTop-n.y-parseInt(o.style.borderTopWidth)+"px"})}}}(),function(){var t,i=this;i.setOpt("imageScaleEnabled",!0),!browser.ie&&i.options.imageScaleEnabled&&i.addListener("click",function(o,s){var r=i.selection.getRange(),n=r.getClosedNode();if(n&&"IMG"==n.tagName&&"false"!=i.body.contentEditable){if(-1!=n.className.indexOf("edui-faked-music")||n.getAttribute("anchorname")||domUtils.hasClass(n,"loadingclass")||domUtils.hasClass(n,"loaderrorclass"))return;if(!t){t=new e,t.init(i),i.ui.getDom().appendChild(t.resizer);var a,d=function(e){t.hide(),t.target&&i.selection.getRange().selectNode(t.target).select()},l=function(e){var t=e.target||e.srcElement;!t||void 0!==t.className&&-1!=t.className.indexOf("edui-editor-imagescale")||d(e)};i.addListener("afterscaleshow",function(e){i.addListener("beforekeydown",d),i.addListener("beforemousedown",l),domUtils.on(document,"keydown",d),domUtils.on(document,"mousedown",l),i.selection.getNative().removeAllRanges()}),i.addListener("afterscalehide",function(e){i.removeListener("beforekeydown",d),i.removeListener("beforemousedown",l),domUtils.un(document,"keydown",d),domUtils.un(document,"mousedown",l);var o=t.target;o.parentNode&&i.selection.getRange().selectNode(o).select()}),domUtils.on(t.resizer,"mousedown",function(e){i.selection.getNative().removeAllRanges();var o=e.target||e.srcElement;o&&-1==o.className.indexOf("edui-editor-imagescale-hand")&&(a=setTimeout(function(){t.hide(),t.target&&i.selection.getRange().selectNode(o).select()},200))}),domUtils.on(t.resizer,"mouseup",function(e){var t=e.target||e.srcElement;t&&-1==t.className.indexOf("edui-editor-imagescale-hand")&&clearTimeout(a)})}t.show(n)}else t&&"none"!=t.resizer.style.display&&t.hide()}),browser.webkit&&i.addListener("click",function(e,t){if("IMG"==t.target.tagName&&"false"!=i.body.contentEditable){var o=new dom.Range(i.document);o.selectNode(t.target).select()}})}}();
UE.plugin.register("autolink",function(){var e=0;return browser.ie?{}:{bindEvents:{reset:function(){e=0},keydown:function(e,t){var r=this,n=t.keyCode||t.which;if(32==n||13==n){for(var i,o,a=r.selection.getNative(),s=a.getRangeAt(0).cloneRange(),l=s.startContainer;1==l.nodeType&&s.startOffset>0&&(l=s.startContainer.childNodes[s.startOffset-1]);)s.setStart(l,1==l.nodeType?l.childNodes.length:l.nodeValue.length),s.collapse(!0),l=s.startContainer;do{if(0==s.startOffset){for(l=s.startContainer.previousSibling;l&&1==l.nodeType;)l=l.lastChild;if(!l||domUtils.isFillChar(l))break;i=l.nodeValue.length}else l=s.startContainer,i=s.startOffset;s.setStart(l,i-1),o=s.toString().charCodeAt(0)}while(160!=o&&32!=o);if(s.toString().replace(new RegExp(domUtils.fillChar,"g"),"").match(/(?:https?:\/\/|ssh:\/\/|ftp:\/\/|file:\/|www\.)/i)){for(;s.toString().length&&!/^(?:https?:\/\/|ssh:\/\/|ftp:\/\/|file:\/|www\.)/i.test(s.toString());)try{s.setStart(s.startContainer,s.startOffset+1)}catch(d){for(var l=s.startContainer;!(next=l.nextSibling);){if(domUtils.isBody(l))return;l=l.parentNode}s.setStart(next,0)}if(domUtils.findParentByTagName(s.startContainer,"a",!0))return;var f,g=r.document.createElement("a"),u=r.document.createTextNode(" ");r.undoManger&&r.undoManger.save(),g.appendChild(s.extractContents()),g.href=g.innerHTML=g.innerHTML.replace(/<[^>]+>/g,""),f=g.getAttribute("href").replace(new RegExp(domUtils.fillChar,"g"),""),f=/^(?:https?:\/\/)/gi.test(f)?f:"http://"+f,g.setAttribute("_src",utils.html(f)),g.href=utils.html(f),s.insertNode(g),g.parentNode.insertBefore(u,g.nextSibling),s.setStart(u,0),s.collapse(!0),a.removeAllRanges(),a.addRange(s),r.undoManger&&r.undoManger.save()}}}}}},function(){function e(e){if(3==e.nodeType)return null;if("A"==e.nodeName)return e;for(var t=e.lastChild;t;){if("A"==t.nodeName)return t;if(3==t.nodeType){if(domUtils.isWhitespace(t)){t=t.previousSibling;continue}return null}t=t.lastChild}}var t={37:1,38:1,39:1,40:1,13:1,32:1};browser.ie&&this.addListener("keyup",function(r,n){var i=this,o=n.keyCode;if(t[o]){var a=i.selection.getRange(),s=a.startContainer;if(13==o){for(;s&&!domUtils.isBody(s)&&!domUtils.isBlockElm(s);)s=s.parentNode;if(s&&!domUtils.isBody(s)&&"P"==s.nodeName){var l=s.previousSibling;if(l&&1==l.nodeType){var l=e(l);l&&!l.getAttribute("_href")&&domUtils.remove(l,!0)}}}else if(32==o)3==s.nodeType&&/^\s$/.test(s.nodeValue)&&(s=s.previousSibling,s&&"A"==s.nodeName&&!s.getAttribute("_href")&&domUtils.remove(s,!0));else if(s=domUtils.findParentByTagName(s,"a",!0),s&&!s.getAttribute("_href")){var d=a.createBookmark();domUtils.remove(s,!0),a.moveToBookmark(d).select(!0)}}})});
UE.plugins.autoheight=function(){function e(){var e=this;clearTimeout(i),a||(!e.queryCommandState||e.queryCommandState&&1!=e.queryCommandState("source"))&&(i=setTimeout(function(){for(var t=e.body.lastChild;t&&1!=t.nodeType;)t=t.previousSibling;t&&1==t.nodeType&&(t.style.clear="both",n=Math.max(domUtils.getXY(t).y+t.offsetHeight+25,Math.max(l.minFrameHeight,l.initialFrameHeight)),n!=r&&(n!==parseInt(e.iframe.parentNode.style.height)&&(e.iframe.parentNode.style.height=n+"px"),e.body.style.height=n+"px",r=n),domUtils.removeStyle(t,"clear"))},50))}var t=this;if(t.autoHeightEnabled=t.options.autoHeightEnabled!==!1,t.autoHeightEnabled){var o,n,i,a,r=0,l=t.options;t.addListener("fullscreenchanged",function(e,t){a=t}),t.addListener("destroy",function(){t.removeListener("contentchange afterinserthtml keyup mouseup",e)}),t.enableAutoHeight=function(){var t=this;if(t.autoHeightEnabled){var n=t.document;t.autoHeightEnabled=!0,o=n.body.style.overflowY,n.body.style.overflowY="hidden",t.addListener("contentchange afterinserthtml keyup mouseup",e),setTimeout(function(){e.call(t)},browser.gecko?100:0),t.fireEvent("autoheightchanged",t.autoHeightEnabled)}},t.disableAutoHeight=function(){t.body.style.overflowY=o||"",t.removeListener("contentchange",e),t.removeListener("keyup",e),t.removeListener("mouseup",e),t.autoHeightEnabled=!1,t.fireEvent("autoheightchanged",t.autoHeightEnabled)},t.on("setHeight",function(){t.disableAutoHeight()}),t.addListener("ready",function(){t.enableAutoHeight();var o;domUtils.on(browser.ie?t.body:t.document,browser.webkit?"dragover":"drop",function(){clearTimeout(o),o=setTimeout(function(){e.call(t)},100)});var n;window.onscroll=function(){null===n?n=this.scrollY:0==this.scrollY&&0!=n&&(t.window.scrollTo(0,0),n=null)}})}};
UE.plugins.autofloat=function(){function e(){return UE.ui?1:(alert(r.autofloatMsg),0)}function t(){var e=document.body.style;e.backgroundImage='url("about:blank")',e.backgroundAttachment="fixed"}function o(){var e=domUtils.getXY(a),t=domUtils.getComputedStyle(a,"position"),o=domUtils.getComputedStyle(a,"left");a.style.width=a.offsetWidth+"px",a.style.zIndex=1*s.options.zIndex+1,a.parentNode.insertBefore(b,a),m||y&&browser.ie?("absolute"!=a.style.position&&(a.style.position="absolute"),a.style.top=(document.body.scrollTop||document.documentElement.scrollTop)-f+d+"px"):(browser.ie7Compat&&g&&(g=!1,a.style.left=domUtils.getXY(a).x-document.documentElement.getBoundingClientRect().left+2+"px"),"fixed"!=a.style.position&&(a.style.position="fixed",a.style.top=d+"px",("absolute"==t||"relative"==t)&&parseFloat(o)&&(a.style.left=e.x+"px")))}function n(){g=!0,b.parentNode&&b.parentNode.removeChild(b),a.style.cssText=u}function i(){var e=c(s.container),t=s.options.toolbarTopOffset||0;e.top<0&&e.bottom-a.offsetHeight>t?o():n()}var s=this,r=s.getLang();s.setOpt({topOffset:0});var l=s.options.autoFloatEnabled!==!1,d=s.options.topOffset;if(l){var u,a,f,c,p=UE.ui.uiUtils,m=browser.ie&&browser.version<=6,y=browser.quirks,b=document.createElement("div"),g=!0,x=utils.defer(function(){i()},browser.ie?200:100,!0);s.addListener("destroy",function(){domUtils.un(window,["scroll","resize"],i),s.removeListener("keydown",x)}),s.addListener("ready",function(){if(e(s)){if(!s.ui)return;c=p.getClientRect,a=s.ui.getDom("toolbarbox"),f=c(a).top,u=a.style.cssText,b.style.height=a.offsetHeight+"px",m&&t(),domUtils.on(window,["scroll","resize"],i),s.addListener("keydown",x),s.addListener("beforefullscreenchange",function(e,t){t&&n()}),s.addListener("fullscreenchanged",function(e,t){t||i()}),s.addListener("sourcemodechanged",function(e,t){setTimeout(function(){i()},0)}),s.addListener("clearDoc",function(){setTimeout(function(){i()},0)})}})}};
UE.plugins.contextmenu=function(){var e=this;if(e.setOpt("enableContextMenu",!0),e.getOpt("enableContextMenu")!==!1){var a,l=e.getLang("contextMenu"),t=e.options.contextMenu||[{label:l.selectall,cmdName:"selectall"},{label:l.cleardoc,cmdName:"cleardoc",exec:function(){confirm(l.confirmclear)&&this.execCommand("cleardoc")}},"-",{label:l.unlink,cmdName:"unlink"},"-",{group:l.paragraph,icon:"justifyjustify",subMenu:[{label:l.justifyleft,cmdName:"justify",value:"left"},{label:l.justifyright,cmdName:"justify",value:"right"},{label:l.justifycenter,cmdName:"justify",value:"center"},{label:l.justifyjustify,cmdName:"justify",value:"justify"}]},"-",{group:l.table,icon:"table",subMenu:[{label:l.inserttable,cmdName:"inserttable"},{label:l.deletetable,cmdName:"deletetable"},"-",{label:l.deleterow,cmdName:"deleterow"},{label:l.deletecol,cmdName:"deletecol"},{label:l.insertcol,cmdName:"insertcol"},{label:l.insertcolnext,cmdName:"insertcolnext"},{label:l.insertrow,cmdName:"insertrow"},{label:l.insertrownext,cmdName:"insertrownext"},"-",{label:l.insertcaption,cmdName:"insertcaption"},{label:l.deletecaption,cmdName:"deletecaption"},{label:l.inserttitle,cmdName:"inserttitle"},{label:l.deletetitle,cmdName:"deletetitle"},{label:l.inserttitlecol,cmdName:"inserttitlecol"},{label:l.deletetitlecol,cmdName:"deletetitlecol"},"-",{label:l.mergecells,cmdName:"mergecells"},{label:l.mergeright,cmdName:"mergeright"},{label:l.mergedown,cmdName:"mergedown"},"-",{label:l.splittorows,cmdName:"splittorows"},{label:l.splittocols,cmdName:"splittocols"},{label:l.splittocells,cmdName:"splittocells"},"-",{label:l.averageDiseRow,cmdName:"averagedistributerow"},{label:l.averageDisCol,cmdName:"averagedistributecol"},"-",{label:l.edittd,cmdName:"edittd",exec:function(){UE.ui.edittd&&new UE.ui.edittd(this),this.getDialog("edittd").open()}},{label:l.edittable,cmdName:"edittable",exec:function(){UE.ui.edittable&&new UE.ui.edittable(this),this.getDialog("edittable").open()}},{label:l.setbordervisible,cmdName:"setbordervisible"}]},{group:l.tablesort,icon:"tablesort",subMenu:[{label:l.enablesort,cmdName:"enablesort"},{label:l.disablesort,cmdName:"disablesort"},"-",{label:l.reversecurrent,cmdName:"sorttable",value:"reversecurrent"},{label:l.orderbyasc,cmdName:"sorttable",value:"orderbyasc"},{label:l.reversebyasc,cmdName:"sorttable",value:"reversebyasc"},{label:l.orderbynum,cmdName:"sorttable",value:"orderbynum"},{label:l.reversebynum,cmdName:"sorttable",value:"reversebynum"}]},{group:l.borderbk,icon:"borderBack",subMenu:[{label:l.setcolor,cmdName:"interlacetable",exec:function(){this.execCommand("interlacetable")}},{label:l.unsetcolor,cmdName:"uninterlacetable",exec:function(){this.execCommand("uninterlacetable")}},{label:l.setbackground,cmdName:"settablebackground",exec:function(){this.execCommand("settablebackground",{repeat:!0,colorList:["#bbb","#ccc"]})}},{label:l.unsetbackground,cmdName:"cleartablebackground",exec:function(){this.execCommand("cleartablebackground")}},{label:l.redandblue,cmdName:"settablebackground",exec:function(){this.execCommand("settablebackground",{repeat:!0,colorList:["red","blue"]})}},{label:l.threecolorgradient,cmdName:"settablebackground",exec:function(){this.execCommand("settablebackground",{repeat:!0,colorList:["#aaa","#bbb","#ccc"]})}}]},{group:l.aligntd,icon:"aligntd",subMenu:[{cmdName:"cellalignment",value:{align:"left",vAlign:"top"}},{cmdName:"cellalignment",value:{align:"center",vAlign:"top"}},{cmdName:"cellalignment",value:{align:"right",vAlign:"top"}},{cmdName:"cellalignment",value:{align:"left",vAlign:"middle"}},{cmdName:"cellalignment",value:{align:"center",vAlign:"middle"}},{cmdName:"cellalignment",value:{align:"right",vAlign:"middle"}},{cmdName:"cellalignment",value:{align:"left",vAlign:"bottom"}},{cmdName:"cellalignment",value:{align:"center",vAlign:"bottom"}},{cmdName:"cellalignment",value:{align:"right",vAlign:"bottom"}}]},{group:l.aligntable,icon:"aligntable",subMenu:[{cmdName:"tablealignment",className:"left",label:l.tableleft,value:"left"},{cmdName:"tablealignment",className:"center",label:l.tablecenter,value:"center"},{cmdName:"tablealignment",className:"right",label:l.tableright,value:"right"}]},"-",{label:l.insertparagraphbefore,cmdName:"insertparagraph",value:!0},{label:l.insertparagraphafter,cmdName:"insertparagraph"},{label:l.copy,cmdName:"copy"},{label:l.paste,cmdName:"paste"}];if(t.length){var n=UE.ui.uiUtils;e.addListener("contextmenu",function(c,m){var r=n.getViewportOffsetByEvent(m);e.fireEvent("beforeselectionchange"),a&&a.destroy();for(var i,o=0,d=[];i=t[o];o++){var s;!function(a){function t(){switch(a.icon){case"table":return e.getLang("contextMenu.table");case"justifyjustify":return e.getLang("contextMenu.paragraph");case"aligntd":return e.getLang("contextMenu.aligntd");case"aligntable":return e.getLang("contextMenu.aligntable");case"tablesort":return l.tablesort;case"borderBack":return l.borderbk;default:return""}}if("-"==a)(s=d[d.length-1])&&"-"!==s&&d.push("-");else if(a.hasOwnProperty("group")){for(var n,c=0,m=[];n=a.subMenu[c];c++)!function(a){"-"==a?(s=m[m.length-1])&&"-"!==s?m.push("-"):m.splice(m.length-1):(e.commands[a.cmdName]||UE.commands[a.cmdName]||a.query)&&(a.query?a.query():e.queryCommandState(a.cmdName))>-1&&m.push({label:a.label||e.getLang("contextMenu."+a.cmdName+(a.value||""))||"",className:"edui-for-"+a.cmdName+(a.className?" edui-for-"+a.cmdName+"-"+a.className:""),onclick:a.exec?function(){a.exec.call(e)}:function(){e.execCommand(a.cmdName,a.value)}})}(n);m.length&&d.push({label:t(),className:"edui-for-"+a.icon,subMenu:{items:m,editor:e}})}else(e.commands[a.cmdName]||UE.commands[a.cmdName]||a.query)&&(a.query?a.query.call(e):e.queryCommandState(a.cmdName))>-1&&d.push({label:a.label||e.getLang("contextMenu."+a.cmdName),className:"edui-for-"+(a.icon?a.icon:a.cmdName+(a.value||"")),onclick:a.exec?function(){a.exec.call(e)}:function(){e.execCommand(a.cmdName,a.value)}})}(i)}if("-"==d[d.length-1]&&d.pop(),a=new UE.ui.Menu({items:d,className:"edui-contextmenu",editor:e}),a.render(),a.showAt(r),e.fireEvent("aftershowcontextmenu",a),domUtils.preventDefault(m),browser.ie){var u;try{u=e.selection.getNative().createRange()}catch(b){return}if(u.item){var g=new dom.Range(e.document);g.selectNode(u.item(0)).select(!0,!0)}}}),e.addListener("aftershowcontextmenu",function(a,l){if(e.zeroclipboard){var t=l.items;for(var n in t)"edui-for-copy"==t[n].className&&e.zeroclipboard.clip(t[n].getDom())}})}}};
UE.plugins.shortcutmenu=function(){var e,t=this,n=t.options.shortcutMenu||[];n.length&&(t.addListener("contextmenu mouseup",function(t,i){var r=this,o={type:t,target:i.target||i.srcElement,screenX:i.screenX,screenY:i.screenY,clientX:i.clientX,clientY:i.clientY};if(setTimeout(function(){var i=r.selection.getRange();(i.collapsed===!1||"contextmenu"==t)&&(e||(e=new baidu.editor.ui.ShortCutMenu({editor:r,items:n,theme:r.options.theme,className:"edui-shortcutmenu"}),e.render(),r.fireEvent("afterrendershortcutmenu",e)),e.show(o,!!UE.plugins.contextmenu))}),"contextmenu"==t&&(domUtils.preventDefault(i),browser.ie9below)){var c;try{c=r.selection.getNative().createRange()}catch(i){return}if(c.item){var s=new dom.Range(r.document);s.selectNode(c.item(0)).select(!0,!0)}}}),t.addListener("keydown",function(t){"keydown"==t&&e&&!e.isHidden&&e.hide()}))};
UE.plugins.basestyle=function(){var e={bold:["strong","b"],italic:["em","i"],subscript:["sub"],superscript:["sup"]},t=function(e,t){return domUtils.filterNodeList(e.selection.getStartElementPath(),t)},s=this;s.addshortcutkey({Bold:"ctrl+66",Italic:"ctrl+73",Underline:"ctrl+85"}),s.addInputRule(function(e){utils.each(e.getNodesByTagName("b i"),function(e){switch(e.tagName){case"b":e.tagName="strong";break;case"i":e.tagName="em"}})});for(var n in e)!function(e,n){s.commands[e]={execCommand:function(e){var r=s.selection.getRange(),i=t(this,n);if(r.collapsed){if(i){var a=s.document.createTextNode("");r.insertNode(a).removeInlineStyle(n),r.setStartBefore(a),domUtils.remove(a)}else{var o=r.document.createElement(n[0]);("superscript"==e||"subscript"==e)&&(a=s.document.createTextNode(""),r.insertNode(a).removeInlineStyle(["sub","sup"]).setStartBefore(a).collapse(!0)),r.insertNode(o).setStart(o,0)}r.collapse(!0)}else("superscript"==e||"subscript"==e)&&(i&&i.tagName.toLowerCase()==e||r.removeInlineStyle(["sub","sup"])),i?r.removeInlineStyle(n):r.applyInlineStyle(n[0]);r.select()},queryCommandState:function(){return t(this,n)?1:0}}}(n,e[n])};
UE.plugins.elementpath=function(){var e,t,n=this;n.setOpt("elementPathEnabled",!0),n.options.elementPathEnabled&&(n.commands.elementpath={execCommand:function(a,o){var r=t[o],m=n.selection.getRange();e=1*o,m.selectNode(r).select()},queryCommandValue:function(){var n=[].concat(this.selection.getStartElementPath()).reverse(),a=[];t=n;for(var o,r=0;o=n[r];r++)if(3!=o.nodeType){var m=o.tagName.toLowerCase();if("img"==m&&o.getAttribute("anchorname")&&(m="anchor"),a[r]=m,e==r){e=-1;break}}return a}})};
UE.plugins.formatmatch=function(){function e(r,s){function i(e){return c&&e.selectNode(c),e.applyInlineStyle(o[o.length-1].tagName,null,o)}if(browser.webkit)var l="IMG"==s.target.tagName?s.target:null;n.undoManger&&n.undoManger.save();var m=n.selection.getRange(),d=l||m.getClosedNode();if(t&&d&&"IMG"==d.tagName)d.style.cssText+=";float:"+(t.style.cssFloat||t.style.styleFloat||"none")+";display:"+(t.style.display||"inline"),t=null;else if(!t){var u=m.collapsed;if(u){var c=n.document.createTextNode("match");m.insertNode(c).select()}n.__hasEnterExecCommand=!0;var g=n.options.removeFormatAttributes;n.options.removeFormatAttributes="",n.execCommand("removeformat"),n.options.removeFormatAttributes=g,n.__hasEnterExecCommand=!1,m=n.selection.getRange(),o.length&&i(m),c&&m.setStartBefore(c).collapse(!0),m.select(),c&&domUtils.remove(c)}n.undoManger&&n.undoManger.save(),n.removeListener("mouseup",e),a=0}var t,n=this,o=[],a=0;n.addListener("reset",function(){o=[],a=0}),n.commands.formatmatch={execCommand:function(r){if(a)return a=0,o=[],void n.removeListener("mouseup",e);var s=n.selection.getRange();if(t=s.getClosedNode(),!t||"IMG"!=t.tagName){s.collapse(!0).shrinkBoundary();var i=s.startContainer;o=domUtils.findParents(i,!0,function(e){return!domUtils.isBlockElm(e)&&1==e.nodeType});for(var l,m=0;l=o[m];m++)if("A"==l.tagName){o.splice(m,1);break}}n.addListener("mouseup",e),a=1},queryCommandState:function(){return a},notNeedUndo:1}};
UE.plugins.customstyle=function(){var t=this;t.setOpt({customstyle:[{tag:"h1",name:"tc",style:"font-size:32px;font-weight:bold;border-bottom:#ccc 2px solid;padding:0 4px 0 0;text-align:center;margin:0 0 20px 0;"},{tag:"h1",name:"tl",style:"font-size:32px;font-weight:bold;border-bottom:#ccc 2px solid;padding:0 4px 0 0;text-align:left;margin:0 0 10px 0;"},{tag:"span",name:"im",style:"font-size:16px;font-style:italic;font-weight:bold;line-height:18px;"},{tag:"span",name:"hi",style:"font-size:16px;font-style:italic;font-weight:bold;color:rgb(51, 153, 204);line-height:18px;"}]}),t.commands.customstyle={execCommand:function(t,e){var o,l,i=this,n=e.tag,s=domUtils.findParent(i.selection.getStart(),function(t){return t.getAttribute("label")},!0),a={};for(var r in e)void 0!==e[r]&&(a[r]=e[r]);if(delete a.tag,s&&s.getAttribute("label")==e.label){if(o=this.selection.getRange(),l=o.createBookmark(),o.collapsed)if(dtd.$block[s.tagName]){var d=i.document.createElement("p");domUtils.moveChild(s,d),s.parentNode.insertBefore(d,s),domUtils.remove(s)}else domUtils.remove(s,!0);else{var m=domUtils.getCommonAncestor(l.start,l.end),c=domUtils.getElementsByTagName(m,n);new RegExp(n,"i").test(m.tagName)&&c.push(m);for(var g,f=0;g=c[f++];)if(g.getAttribute("label")==e.label){var u=domUtils.getPosition(g,l.start),p=domUtils.getPosition(g,l.end);if((u&domUtils.POSITION_FOLLOWING||u&domUtils.POSITION_CONTAINS)&&(p&domUtils.POSITION_PRECEDING||p&domUtils.POSITION_CONTAINS)&&dtd.$block[n]){var d=i.document.createElement("p");domUtils.moveChild(g,d),g.parentNode.insertBefore(d,g)}domUtils.remove(g,!0)}s=domUtils.findParent(m,function(t){return t.getAttribute("label")==e.label},!0),s&&domUtils.remove(s,!0)}o.moveToBookmark(l).select()}else if(dtd.$block[n]){if(this.execCommand("paragraph",n,a,"customstyle"),o=i.selection.getRange(),!o.collapsed){o.collapse(),s=domUtils.findParent(i.selection.getStart(),function(t){return t.getAttribute("label")==e.label},!0);var b=i.document.createElement("p");domUtils.insertAfter(s,b),domUtils.fillNode(i.document,b),o.setStart(b,0).setCursor()}}else{if(o=i.selection.getRange(),o.collapsed)return s=i.document.createElement(n),domUtils.setAttributes(s,a),void o.insertNode(s).setStart(s,0).setCursor();l=o.createBookmark(),o.applyInlineStyle(n,a).moveToBookmark(l).select()}},queryCommandValue:function(){var t=domUtils.filterNodeList(this.selection.getStartElementPath(),function(t){return t.getAttribute("label")});return t?t.getAttribute("label"):""}},t.addListener("keyup",function(e,o){var l=o.keyCode||o.which;if(32==l||13==l){var i=t.selection.getRange();if(i.collapsed){var n=domUtils.findParent(t.selection.getStart(),function(t){return t.getAttribute("label")},!0);if(n&&dtd.$block[n.tagName]&&domUtils.isEmptyNode(n)){var s=t.document.createElement("p");domUtils.insertAfter(n,s),domUtils.fillNode(t.document,s),domUtils.remove(n),i.setStart(s,0).setCursor()}}}})};
UE.plugin.register("autoupload",function(){function e(e,t){var a,r,i,o,n,s,l,d,c=t,u=/image\/\w+/i.test(e.type)?"image":"file",g="loading_"+(+new Date).toString(36);if(a=c.getOpt(u+"FieldName"),r=c.getOpt(u+"UrlPrefix"),i=c.getOpt(u+"MaxSize"),o=c.getOpt(u+"AllowFiles"),n=c.getActionUrl(c.getOpt(u+"ActionName")),l=function(e){var t=c.document.getElementById(g);t&&domUtils.remove(t),c.fireEvent("showmessage",{id:g,content:e,type:"error",timeout:4e3})},"image"==u?(s='<img class="loadingclass" id="'+g+'" src="'+c.options.themePath+c.options.theme+'/images/spacer.gif" title="'+(c.getLang("autoupload.loading")||"")+'" >',d=function(e){var t=r+e.url,a=c.document.getElementById(g);a&&(a.setAttribute("src",t),a.setAttribute("_src",t),a.setAttribute("title",e.title||""),a.setAttribute("alt",e.original||""),a.removeAttribute("id"),domUtils.removeClasses(a,"loadingclass"))}):(s='<p><img class="loadingclass" id="'+g+'" src="'+c.options.themePath+c.options.theme+'/images/spacer.gif" title="'+(c.getLang("autoupload.loading")||"")+'" ></p>',d=function(e){var t=r+e.url,a=c.document.getElementById(g),i=c.selection.getRange(),o=i.createBookmark();i.selectNode(a).select(),c.execCommand("insertfile",{url:t}),i.moveToBookmark(o).select()}),c.execCommand("inserthtml",s),!c.getOpt(u+"ActionName"))return void l(c.getLang("autoupload.errorLoadConfig"));if(e.size>i)return void l(c.getLang("autoupload.exceedSizeError"));var p=e.name?e.name.substr(e.name.lastIndexOf(".")):"";if(p&&"image"!=u||o&&-1==(o.join("")+".").indexOf(p.toLowerCase()+"."))return void l(c.getLang("autoupload.exceedTypeError"));var m=new XMLHttpRequest,f=new FormData,h=utils.serializeParam(c.queryCommandValue("serverparam"))||"",b=utils.formatUrl(n+(-1==n.indexOf("?")?"?":"&")+h);f.append(a,e,e.name||"blob."+e.type.substr("image/".length)),f.append("type","ajax"),m.open("post",b,!0),m.setRequestHeader("X-Requested-With","XMLHttpRequest"),m.addEventListener("load",function(e){try{var t=new Function("return "+utils.trim(e.target.response))();"SUCCESS"==t.state&&t.url?d(t):l(t.state)}catch(a){l(c.getLang("autoupload.loadError"))}}),m.send(f)}function t(e){return e.clipboardData&&e.clipboardData.items&&1==e.clipboardData.items.length&&/^image\//.test(e.clipboardData.items[0].type)?e.clipboardData.items:null}function a(e){return e.dataTransfer&&e.dataTransfer.files?e.dataTransfer.files:null}return{outputRule:function(e){utils.each(e.getNodesByTagName("img"),function(e){/\b(loaderrorclass)|(bloaderrorclass)\b/.test(e.getAttr("class"))&&e.parentNode.removeChild(e)}),utils.each(e.getNodesByTagName("p"),function(e){/\bloadpara\b/.test(e.getAttr("class"))&&e.parentNode.removeChild(e)})},bindEvents:{ready:function(r){var i=this;window.FormData&&window.FileReader&&(domUtils.on(i.body,"paste drop",function(r){var o,n=!1;if(o="paste"==r.type?t(r):a(r)){for(var s,l=o.length;l--;)s=o[l],s.getAsFile&&(s=s.getAsFile()),s&&s.size>0&&(e(s,i),n=!0);n&&r.preventDefault()}}),domUtils.on(i.body,"dragover",function(e){"Files"==e.dataTransfer.types[0]&&e.preventDefault()}),utils.cssRule("loading",".loadingclass{display:inline-block;cursor:default;background: url('"+this.options.themePath+this.options.theme+"/images/loading.gif') no-repeat center center transparent;border:1px solid #cccccc;margin-left:1px;height: 22px;width: 22px;}\n.loaderrorclass{display:inline-block;cursor:default;background: url('"+this.options.themePath+this.options.theme+"/images/loaderror.png') no-repeat center center transparent;border:1px solid #cccccc;margin-right:1px;height: 22px;width: 22px;}",this.document))}}}});
UE.plugin.register("autosave",function(){function e(e){var r;if(!(new Date-t<o)){if(!e.hasContents())return void(a&&n.removePreferences(a));t=new Date,e._saveFlag=null,r=n.body.innerHTML,e.fireEvent("beforeautosave",{content:r})!==!1&&(n.setPreferences(a,r),e.fireEvent("afterautosave",{content:r}))}}var n=this,t=new Date,o=20,a=null;return{defaultOptions:{saveInterval:500},bindEvents:{ready:function(){var e="-drafts-data",t=null;t=n.key?n.key+e:(n.container.parentNode.id||"ue-common")+e,a=(location.protocol+location.host+location.pathname).replace(/[.:\/]/g,"_")+t},contentchange:function(){a&&(n._saveFlag&&window.clearTimeout(n._saveFlag),n.options.saveInterval>0?n._saveFlag=window.setTimeout(function(){e(n)},n.options.saveInterval):e(n))}},commands:{clearlocaldata:{execCommand:function(e,t){a&&n.getPreferences(a)&&n.removePreferences(a)},notNeedUndo:!0,ignoreContentChange:!0},getlocaldata:{execCommand:function(e,t){return a?n.getPreferences(a)||"":""},notNeedUndo:!0,ignoreContentChange:!0},drafts:{execCommand:function(e,t){a&&(n.body.innerHTML=n.getPreferences(a)||"<p>"+domUtils.fillHtml+"</p>",n.focus(!0))},queryCommandState:function(){return a?null===n.getPreferences(a)?-1:0:-1},notNeedUndo:!0,ignoreContentChange:!0}}}});
UE.plugin.register("section",function(){function e(e){this.tag="",this.level=-1,this.dom=null,this.nextSection=null,this.previousSection=null,this.parentSection=null,this.startAddress=[],this.endAddress=[],this.children=[]}function t(t){var n=new e;return utils.extend(n,t)}function n(e,t){for(var n=t,s=0;s<e.length;s++){if(!n.childNodes)return null;n=n.childNodes[e[s]]}return n}var s=this;return{bindMultiEvents:{type:"aftersetcontent afterscencerestore",handler:function(){s.fireEvent("updateSections")}},bindEvents:{ready:function(){s.fireEvent("updateSections"),domUtils.on(s.body,"drop paste",function(){s.fireEvent("updateSections")})},afterexeccommand:function(e,t){"paragraph"==t&&s.fireEvent("updateSections")},keyup:function(e,t){var n=this,s=n.selection.getRange();if(1!=s.collapsed)n.fireEvent("updateSections");else{var r=t.keyCode||t.which;(13==r||8==r||46==r)&&n.fireEvent("updateSections")}}},commands:{getsections:{execCommand:function(e,n){function s(e){for(var t=0;t<d.length;t++)if(d[t](e))return t;return-1}function r(e,n){for(var d,o,l,a=null,u=e.childNodes,f=0,h=u.length;h>f;f++)if(l=u[f],d=s(l),d>=0){var v=i.selection.getRange().selectNode(l).createAddress(!0).startAddress,m=t({tag:l.tagName,title:l.innerText||l.textContent||"",level:d,dom:l,startAddress:utils.clone(v,[]),endAddress:utils.clone(v,[]),children:[]});for(c.nextSection=m,m.previousSection=c,o=c;d<=o.level;)o=o.parentSection;m.parentSection=o,o.children.push(m),a=c=m}else 1===l.nodeType&&r(l,n),a&&a.endAddress[a.endAddress.length-1]++}for(var d=n||["h1","h2","h3","h4","h5","h6"],o=0;o<d.length;o++)"string"==typeof d[o]?d[o]=function(e){return function(t){return t.tagName==e.toUpperCase()}}(d[o]):"function"!=typeof d[o]&&(d[o]=function(e){return null});var i=this,l=t({level:-1,title:"root"}),c=l;return r(i.body,l),l},notNeedUndo:!0},movesection:{execCommand:function(e,t,s,r){function d(e,t,n){for(var s=!1,r=!1,d=0;d<e.length&&!(d>=n.length);d++){if(n[d]>e[d]){s=!0;break}if(n[d]<e[d])break}for(var d=0;d<t.length&&!(d>=n.length);d++){if(n[d]<e[d]){r=!0;break}if(n[d]>e[d])break}return s&&r}var o,i,l=this;if(t&&s&&-1!=s.level&&(o=r?s.endAddress:s.startAddress,i=n(o,l.body),o&&i&&!d(t.startAddress,t.endAddress,o))){var c,a,u=n(t.startAddress,l.body),f=n(t.endAddress,l.body);if(r)for(c=f;c&&!(domUtils.getPosition(u,c)&domUtils.POSITION_FOLLOWING)&&(a=c.previousSibling,domUtils.insertAfter(i,c),c!=u);)c=a;else for(c=u;c&&!(domUtils.getPosition(c,f)&domUtils.POSITION_FOLLOWING)&&(a=c.nextSibling,i.parentNode.insertBefore(c,i),c!=f);)c=a;l.fireEvent("updateSections")}}},deletesection:{execCommand:function(e,t,n){function s(e){for(var t=r.body,n=0;n<e.length;n++){if(!t.childNodes)return null;t=t.childNodes[e[n]]}return t}var r=this;if(t){var d,o=s(t.startAddress),i=s(t.endAddress),l=o;if(n)domUtils.remove(l);else for(;l&&domUtils.inDoc(i,r.document)&&!(domUtils.getPosition(l,i)&domUtils.POSITION_FOLLOWING);)d=l.nextSibling,domUtils.remove(l),l=d;r.fireEvent("updateSections")}}},selectsection:{execCommand:function(e,t){if(!t&&!t.dom)return!1;var n=this,s=n.selection.getRange(),r={startAddress:utils.clone(t.startAddress,[]),endAddress:utils.clone(t.endAddress,[])};return r.endAddress[r.endAddress.length-1]++,s.moveToAddress(r).select().scrollToView(),!0},notNeedUndo:!0},scrolltosection:{execCommand:function(e,t){if(!t&&!t.dom)return!1;var n=this,s=n.selection.getRange(),r={startAddress:t.startAddress,endAddress:t.endAddress};return r.endAddress[r.endAddress.length-1]++,s.moveToAddress(r).scrollToView(),!0},notNeedUndo:!0}}}});
UE.plugin.register("simpleupload",function(){function e(){var e=t.offsetWidth||20,n=t.offsetHeight||20,a=document.createElement("iframe"),r="display:block;width:"+e+"px;height:"+n+"px;overflow:hidden;border:0;margin:0;padding:0;position:absolute;top:0;left:0;filter:alpha(opacity=0);-moz-opacity:0;-khtml-opacity: 0;opacity: 0;cursor:pointer;";domUtils.on(a,"load",function(){var t,d,l,s=(+new Date).toString(36);d=a.contentDocument||a.contentWindow.document,l=d.body,t=d.createElement("div"),t.innerHTML='<form id="edui_form_'+s+'" target="edui_iframe_'+s+'" method="POST" enctype="multipart/form-data" action="'+i.getOpt("serverUrl")+'" style="'+r+'"><input id="edui_input_'+s+'" type="file" accept="image/*" name="'+i.options.imageFieldName+'" style="'+r+'"></form><iframe id="edui_iframe_'+s+'" name="edui_iframe_'+s+'" style="display:none;width:0;height:0;border:0;margin:0;padding:0;position:absolute;"></iframe>',t.className="edui-"+i.options.theme,t.id=i.ui.id+"_iframeupload",l.style.cssText=r,l.style.width=e+"px",l.style.height=n+"px",l.appendChild(t),l.parentNode&&(l.parentNode.style.width=e+"px",l.parentNode.style.height=e+"px");var m=d.getElementById("edui_form_"+s),c=d.getElementById("edui_input_"+s),u=d.getElementById("edui_iframe_"+s);domUtils.on(c,"change",function(){function e(){try{var n,a,r,d=(u.contentDocument||u.contentWindow.document).body,l=d.innerText||d.textContent||"";a=new Function("return "+l)(),n=i.options.imageUrlPrefix+a.url,"SUCCESS"==a.state&&a.url?(r=i.document.getElementById(o),r.setAttribute("src",n),r.setAttribute("_src",n),r.setAttribute("title",a.title||""),r.setAttribute("alt",a.original||""),r.removeAttribute("id"),domUtils.removeClasses(r,"loadingclass")):t&&t(a.state)}catch(s){t&&t(i.getLang("simpleupload.loadError"))}m.reset(),domUtils.un(u,"load",e)}function t(e){if(o){var t=i.document.getElementById(o);t&&domUtils.remove(t),i.fireEvent("showmessage",{id:o,content:e,type:"error",timeout:4e3})}}if(c.value){var o="loading_"+(+new Date).toString(36),n=utils.serializeParam(i.queryCommandValue("serverparam"))||"",a=i.getActionUrl(i.getOpt("imageActionName")),r=i.getOpt("imageAllowFiles");if(i.focus(),i.execCommand("inserthtml",'<img class="loadingclass" id="'+o+'" src="'+i.options.themePath+i.options.theme+'/images/spacer.gif" title="'+(i.getLang("simpleupload.loading")||"")+'" >'),!i.getOpt("imageActionName"))return void errorHandler(i.getLang("autoupload.errorLoadConfig"));var d=c.value,l=d?d.substr(d.lastIndexOf(".")):"";if(!l||r&&-1==(r.join("")+".").indexOf(l.toLowerCase()+"."))return void t(i.getLang("simpleupload.exceedTypeError"));domUtils.on(u,"load",e),m.action=utils.formatUrl(a+(-1==a.indexOf("?")?"?":"&")+n),m.submit()}});var p;i.addListener("selectionchange",function(){clearTimeout(p),p=setTimeout(function(){var e=i.queryCommandState("simpleupload");c.disabled=-1==e?"disabled":!1},400)}),o=!0}),a.style.cssText=r,t.appendChild(a)}var t,i=this,o=!1;return{bindEvents:{ready:function(){utils.cssRule("loading",".loadingclass{display:inline-block;cursor:default;background: url('"+this.options.themePath+this.options.theme+"/images/loading.gif') no-repeat center center transparent;border:1px solid #cccccc;margin-right:1px;height: 22px;width: 22px;}\n.loaderrorclass{display:inline-block;cursor:default;background: url('"+this.options.themePath+this.options.theme+"/images/loaderror.png') no-repeat center center transparent;border:1px solid #cccccc;margin-right:1px;height: 22px;width: 22px;}",this.document)},simpleuploadbtnready:function(o,n){t=n,i.afterConfigReady(e)}},outputRule:function(e){utils.each(e.getNodesByTagName("img"),function(e){/\b(loaderrorclass)|(bloaderrorclass)\b/.test(e.getAttr("class"))&&e.parentNode.removeChild(e)})},commands:{simpleupload:{queryCommandState:function(){return o?0:-1}}}}});
UE.plugin.register("serverparam",function(){var e={};return{commands:{serverparam:{execCommand:function(n,i,t){void 0===i||null===i?e={}:utils.isString(i)?void 0===t||null===t?delete e[i]:e[i]=t:utils.isObject(i)?utils.extend(e,i,!0):utils.isFunction(i)&&utils.extend(e,i(),!0)},queryCommandValue:function(){return e||{}}}}}});
var baidu=baidu||{};baidu.editor=baidu.editor||{},UE.ui=baidu.editor.ui={};
!function(){function e(){var e=document.getElementById("edui_fixedlayer");a.setViewportOffset(e,{left:0,top:0})}function t(t){o.on(window,"scroll",e),o.on(window,"resize",baidu.editor.utils.defer(e,0,!0))}var n=baidu.editor.browser,o=baidu.editor.dom.domUtils,i="$EDITORUI",r=window[i]={},l="ID"+i,s=0,a=baidu.editor.ui.uiUtils={uid:function(e){return e?e[l]||(e[l]=++s):++s},hook:function(e,t){var n;return e&&e._callbacks?n=e:(n=function(){var t;e&&(t=e.apply(this,arguments));for(var o=n._callbacks,i=o.length;i--;){var r=o[i].apply(this,arguments);void 0===t&&(t=r)}return t},n._callbacks=[]),n._callbacks.push(t),n},createElementByHtml:function(e){var t=document.createElement("div");return t.innerHTML=e,t=t.firstChild,t.parentNode.removeChild(t),t},getViewportElement:function(){return n.ie&&n.quirks?document.body:document.documentElement},getClientRect:function(e){var t;try{t=e.getBoundingClientRect()}catch(n){t={left:0,top:0,height:0,width:0}}for(var i,r={left:Math.round(t.left),top:Math.round(t.top),height:Math.round(t.bottom-t.top),width:Math.round(t.right-t.left)};(i=e.ownerDocument)!==document&&(e=o.getWindow(i).frameElement);)t=e.getBoundingClientRect(),r.left+=t.left,r.top+=t.top;return r.bottom=r.top+r.height,r.right=r.left+r.width,r},getViewportRect:function(){var e=a.getViewportElement(),t=0|(window.innerWidth||e.clientWidth),n=0|(window.innerHeight||e.clientHeight);return{left:0,top:0,height:n,width:t,bottom:n,right:t}},setViewportOffset:function(e,t){var n=a.getFixedLayer();e.parentNode===n?(e.style.left=t.left+"px",e.style.top=t.top+"px"):o.setViewportOffset(e,t)},getEventOffset:function(e){var t=e.target||e.srcElement,n=a.getClientRect(t),o=a.getViewportOffsetByEvent(e);return{left:o.left-n.left,top:o.top-n.top}},getViewportOffsetByEvent:function(e){var t=e.target||e.srcElement,n=o.getWindow(t).frameElement,i={left:e.clientX,top:e.clientY};if(n&&t.ownerDocument!==document){var r=a.getClientRect(n);i.left+=r.left,i.top+=r.top}return i},setGlobal:function(e,t){return r[e]=t,i+'["'+e+'"]'},unsetGlobal:function(e){delete r[e]},copyAttributes:function(e,t){for(var i=t.attributes,r=i.length;r--;){var l=i[r];"style"==l.nodeName||"class"==l.nodeName||n.ie&&!l.specified||e.setAttribute(l.nodeName,l.nodeValue)}t.className&&o.addClass(e,t.className),t.style.cssText&&(e.style.cssText+=";"+t.style.cssText)},removeStyle:function(e,t){if(e.style.removeProperty)e.style.removeProperty(t);else{if(!e.style.removeAttribute)throw"";e.style.removeAttribute(t)}},contains:function(e,t){return e&&t&&(e===t?!1:e.contains?e.contains(t):16&e.compareDocumentPosition(t))},startDrag:function(e,t,n){function o(e){var n=e.clientX-l,o=e.clientY-s;t.ondragmove(n,o,e),e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}function i(e){n.removeEventListener("mousemove",o,!0),n.removeEventListener("mouseup",i,!0),window.removeEventListener("mouseup",i,!0),t.ondragstop()}function r(){a.releaseCapture(),a.detachEvent("onmousemove",o),a.detachEvent("onmouseup",r),a.detachEvent("onlosecaptrue",r),t.ondragstop()}var n=n||document,l=e.clientX,s=e.clientY;if(n.addEventListener)n.addEventListener("mousemove",o,!0),n.addEventListener("mouseup",i,!0),window.addEventListener("mouseup",i,!0),e.preventDefault();else{var a=e.srcElement;a.setCapture(),a.attachEvent("onmousemove",o),a.attachEvent("onmouseup",r),a.attachEvent("onlosecaptrue",r),e.returnValue=!1}t.ondragstart()},getFixedLayer:function(){var o=document.getElementById("edui_fixedlayer");return null==o&&(o=document.createElement("div"),o.id="edui_fixedlayer",document.body.appendChild(o),n.ie&&n.version<=8?(o.style.position="absolute",t(),setTimeout(e)):o.style.position="fixed",o.style.left="0",o.style.top="0",o.style.width="0",o.style.height="0"),o},makeUnselectable:function(e){if(n.opera||n.ie&&n.version<9){if(e.unselectable="on",e.hasChildNodes())for(var t=0;t<e.childNodes.length;t++)1==e.childNodes[t].nodeType&&a.makeUnselectable(e.childNodes[t])}else void 0!==e.style.MozUserSelect?e.style.MozUserSelect="none":void 0!==e.style.WebkitUserSelect?e.style.WebkitUserSelect="none":void 0!==e.style.KhtmlUserSelect&&(e.style.KhtmlUserSelect="none")}}}();
!function(){var t=baidu.editor.utils,e=baidu.editor.ui.uiUtils,i=baidu.editor.EventBase,s=baidu.editor.ui.UIBase=function(){};s.prototype={className:"",uiName:"",initOptions:function(t){var i=this;for(var s in t)i[s]=t[s];this.id=this.id||"edui"+e.uid()},initUIBase:function(){this._globalKey=t.unhtml(e.setGlobal(this.id,this))},render:function(t){for(var i,s=this.renderHtml(),d=e.createElementByHtml(s),n=domUtils.getElementsByTagName(d,"*"),a="edui-"+(this.theme||this.editor.options.theme),o=document.getElementById("edui_fixedlayer"),r=0;i=n[r++];)domUtils.addClass(i,a);domUtils.addClass(d,a),o&&(o.className="",domUtils.addClass(o,a));var l=this.getDom();null!=l?(l.parentNode.replaceChild(d,l),e.copyAttributes(d,l)):("string"==typeof t&&(t=document.getElementById(t)),t=t||e.getFixedLayer(),domUtils.addClass(t,a),t.appendChild(d)),this.postRender()},getDom:function(t){return document.getElementById(t?this.id+"_"+t:this.id)},postRender:function(){this.fireEvent("postrender")},getHtmlTpl:function(){return""},formatHtml:function(t){var e="edui-"+this.uiName;return t.replace(/##/g,this.id).replace(/%%-/g,this.uiName?e+"-":"").replace(/%%/g,(this.uiName?e:"")+" "+this.className).replace(/\$\$/g,this._globalKey)},renderHtml:function(){return this.formatHtml(this.getHtmlTpl())},dispose:function(){var t=this.getDom();t&&baidu.editor.dom.domUtils.remove(t),e.unsetGlobal(this.id)}},t.inherits(s,i)}();
!function(){var i=baidu.editor.utils,t=baidu.editor.ui.UIBase,a=baidu.editor.ui.Separator=function(i){this.initOptions(i),this.initSeparator()};a.prototype={uiName:"separator",initSeparator:function(){this.initUIBase()},getHtmlTpl:function(){return'<div id="##" class="edui-box %%"></div>'}},i.inherits(a,t)}();
!function(){var i=baidu.editor.utils,t=baidu.editor.dom.domUtils,e=baidu.editor.ui.UIBase,n=baidu.editor.ui.uiUtils,o=baidu.editor.ui.Mask=function(i){this.initOptions(i),this.initUIBase()};o.prototype={getHtmlTpl:function(){return'<div id="##" class="edui-mask %%" onclick="return $$._onClick(event, this);" onmousedown="return $$._onMouseDown(event, this);"></div>'},postRender:function(){var i=this;t.on(window,"resize",function(){setTimeout(function(){i.isHidden()||i._fill()})})},show:function(i){this._fill(),this.getDom().style.display="",this.getDom().style.zIndex=i},hide:function(){this.getDom().style.display="none",this.getDom().style.zIndex=""},isHidden:function(){return"none"==this.getDom().style.display},_onMouseDown:function(){return!1},_onClick:function(i,t){this.fireEvent("click",i,t)},_fill:function(){var i=this.getDom(),t=n.getViewportRect();i.style.width=t.width+"px",i.style.height=t.height+"px"}},i.inherits(o,e)}();
!function(){function t(t,e){for(var i=0;i<h.length;i++){var o=h[i];if(!o.isHidden()&&o.queryAutoHide(e)!==!1){if(t&&/scroll/gi.test(t.type)&&"edui-wordpastepop"==o.className)return;o.hide()}}h.length&&o.editor.fireEvent("afterhidepop")}var e=baidu.editor.utils,i=baidu.editor.ui.uiUtils,o=baidu.editor.dom.domUtils,n=baidu.editor.ui.UIBase,s=baidu.editor.ui.Popup=function(t){this.initOptions(t),this.initPopup()},h=[];s.postHide=t;var d=["edui-anchor-topleft","edui-anchor-topright","edui-anchor-bottomleft","edui-anchor-bottomright"];s.prototype={SHADOW_RADIUS:5,content:null,_hidden:!1,autoRender:!0,canSideLeft:!0,canSideUp:!0,initPopup:function(){this.initUIBase(),h.push(this)},getHtmlTpl:function(){return'<div id="##" class="edui-popup %%" onmousedown="return false;"> <div id="##_body" class="edui-popup-body"> <iframe style="position:absolute;z-index:-1;left:0;top:0;background-color: transparent;" frameborder="0" width="100%" height="100%" src="about:blank"></iframe> <div class="edui-shadow"></div> <div id="##_content" class="edui-popup-content">'+this.getContentHtmlTpl()+"  </div> </div></div>"},getContentHtmlTpl:function(){return this.content?"string"==typeof this.content?this.content:this.content.renderHtml():""},_UIBase_postRender:n.prototype.postRender,postRender:function(){if(this.content instanceof n&&this.content.postRender(),this.captureWheel&&!this.captured){this.captured=!0;var t=(document.documentElement.clientHeight||document.body.clientHeight)-80,e=this.getDom().offsetHeight,s=i.getClientRect(this.combox.getDom()).top,h=this.getDom("content"),d=this.getDom("body").getElementsByTagName("iframe"),r=this;for(d.length&&(d=d[0]);s+e>t;)e-=30;h.style.height=e+"px",d&&(d.style.height=e+"px"),window.XMLHttpRequest?o.on(h,"onmousewheel"in document.body?"mousewheel":"DOMMouseScroll",function(t){t.preventDefault?t.preventDefault():t.returnValue=!1,h.scrollTop-=t.wheelDelta?t.wheelDelta/120*60:t.detail/-3*60}):o.on(this.getDom(),"mousewheel",function(t){t.returnValue=!1,r.getDom("content").scrollTop-=t.wheelDelta/120*60})}this.fireEvent("postRenderAfter"),this.hide(!0),this._UIBase_postRender()},_doAutoRender:function(){!this.getDom()&&this.autoRender&&this.render()},mesureSize:function(){var t=this.getDom("content");return i.getClientRect(t)},fitSize:function(){if(this.captureWheel&&this.sized)return this.__size;this.sized=!0;var t=this.getDom("body");t.style.width="",t.style.height="";var e=this.mesureSize();if(this.captureWheel){t.style.width=-(-20-e.width)+"px";var i=parseInt(this.getDom("content").style.height,10);!window.isNaN(i)&&(e.height=i)}else t.style.width=e.width+"px";return t.style.height=e.height+"px",this.__size=e,this.captureWheel&&(this.getDom("content").style.overflow="auto"),e},showAnchor:function(t,e){this.showAnchorRect(i.getClientRect(t),e)},showAnchorRect:function(t,e,n){this._doAutoRender();var s=i.getViewportRect();this.getDom().style.visibility="hidden",this._show();var h,r,u,l,c=this.fitSize();e?(h=this.canSideLeft&&t.right+c.width>s.right&&t.left>c.width,r=this.canSideUp&&t.top+c.height>s.bottom&&t.bottom>c.height,u=h?t.left-c.width:t.right,l=r?t.bottom-c.height:t.top):(h=this.canSideLeft&&t.right+c.width>s.right&&t.left>c.width,r=this.canSideUp&&t.top+c.height>s.bottom&&t.bottom>c.height,u=h?t.right-c.width:t.left,l=r?t.top-c.height:t.bottom);var a=this.getDom();i.setViewportOffset(a,{left:u,top:l}),o.removeClasses(a,d),a.className+=" "+d[2*(r?1:0)+(h?1:0)],this.editor&&(a.style.zIndex=1*this.editor.container.style.zIndex+10,baidu.editor.ui.uiUtils.getFixedLayer().style.zIndex=a.style.zIndex-1),this.getDom().style.visibility="visible"},showAt:function(t){var e=t.left,i=t.top,o={left:e,top:i,right:e,bottom:i,height:0,width:0};this.showAnchorRect(o,!1,!0)},_show:function(){if(this._hidden){var t=this.getDom();t.style.display="",this._hidden=!1,this.fireEvent("show")}},isHidden:function(){return this._hidden},show:function(){this._doAutoRender(),this._show()},hide:function(t){!this._hidden&&this.getDom()&&(this.getDom().style.display="none",this._hidden=!0,t||this.fireEvent("hide"))},queryAutoHide:function(t){return!t||!i.contains(this.getDom(),t)}},e.inherits(s,n),o.on(document,"mousedown",function(e){var i=e.target||e.srcElement;t(e,i)}),o.on(window,"scroll",function(e,i){t(e,i)})}();
!function(){function e(e,o){for(var t='<div id="##" class="edui-colorpicker %%"><div class="edui-colorpicker-topbar edui-clearfix"><div unselectable="on" id="##_preview" class="edui-colorpicker-preview"></div><div unselectable="on" class="edui-colorpicker-nocolor" onclick="$$._onPickNoColor(event, this);">'+e+'</div></div><table  class="edui-box" style="border-collapse: collapse;" onmouseover="$$._onTableOver(event, this);" onmouseout="$$._onTableOut(event, this);" onclick="return $$._onTableClick(event, this);" cellspacing="0" cellpadding="0"><tr style="border-bottom: 1px solid #ddd;font-size: 13px;line-height: 25px;color:#39C;padding-top: 2px"><td colspan="10">'+o.getLang("themeColor")+'</td> </tr><tr class="edui-colorpicker-tablefirstrow" >',i=0;i<r.length;i++)i&&i%10===0&&(t+="</tr>"+(60==i?'<tr style="border-bottom: 1px solid #ddd;font-size: 13px;line-height: 25px;color:#39C;"><td colspan="10">'+o.getLang("standardColor")+"</td></tr>":"")+"<tr"+(60==i?' class="edui-colorpicker-tablefirstrow"':"")+">"),t+=70>i?'<td style="padding: 0 2px;"><a hidefocus title="'+r[i]+'" onclick="return false;" href="javascript:" unselectable="on" class="edui-box edui-colorpicker-colorcell" data-color="#'+r[i]+'" style="background-color:#'+r[i]+";border:solid #ccc;"+(10>i||i>=60?"border-width:1px;":i>=10&&20>i?"border-width:1px 1px 0 1px;":"border-width:0 1px 0 1px;")+'"></a></td>':"";return t+="</tr></table></div>"}var o=baidu.editor.utils,t=baidu.editor.ui.UIBase,i=baidu.editor.ui.ColorPicker=function(e){this.initOptions(e),this.noColorText=this.noColorText||this.editor.getLang("clearColor"),this.initUIBase()};i.prototype={getHtmlTpl:function(){return e(this.noColorText,this.editor)},_onTableClick:function(e){var o=e.target||e.srcElement,t=o.getAttribute("data-color");t&&this.fireEvent("pickcolor",t)},_onTableOver:function(e){var o=e.target||e.srcElement,t=o.getAttribute("data-color");t&&(this.getDom("preview").style.backgroundColor=t)},_onTableOut:function(){this.getDom("preview").style.backgroundColor=""},_onPickNoColor:function(){this.fireEvent("picknocolor")}},o.inherits(i,t);var r="ffffff,000000,eeece1,1f497d,4f81bd,c0504d,9bbb59,8064a2,4bacc6,f79646,f2f2f2,7f7f7f,ddd9c3,c6d9f0,dbe5f1,f2dcdb,ebf1dd,e5e0ec,dbeef3,fdeada,d8d8d8,595959,c4bd97,8db3e2,b8cce4,e5b9b7,d7e3bc,ccc1d9,b7dde8,fbd5b5,bfbfbf,3f3f3f,938953,548dd4,95b3d7,d99694,c3d69b,b2a2c7,92cddc,fac08f,a5a5a5,262626,494429,17365d,366092,953734,76923c,5f497a,31859b,e36c09,7f7f7f,0c0c0c,1d1b10,0f243e,244061,632423,4f6128,3f3151,205867,595959,c00000,ff0000,ffc000,ffff00,92d050,00b050,00b0f0,0070c0,002060,7030a0,".split(",")}();
!function(){var t=baidu.editor.browser,e=baidu.editor.dom.domUtils,s=baidu.editor.ui.uiUtils,a='onmousedown="$$.Stateful_onMouseDown(event, this);" onmouseup="$$.Stateful_onMouseUp(event, this);"'+(t.ie?' onmouseenter="$$.Stateful_onMouseEnter(event, this);" onmouseleave="$$.Stateful_onMouseLeave(event, this);"':' onmouseover="$$.Stateful_onMouseOver(event, this);" onmouseout="$$.Stateful_onMouseOut(event, this);"');baidu.editor.ui.Stateful={alwalysHoverable:!1,target:null,Stateful_init:function(){this._Stateful_dGetHtmlTpl=this.getHtmlTpl,this.getHtmlTpl=this.Stateful_getHtmlTpl},Stateful_getHtmlTpl:function(){var t=this._Stateful_dGetHtmlTpl();return t.replace(/stateful/g,function(){return a})},Stateful_onMouseEnter:function(t,e){this.target=e,(!this.isDisabled()||this.alwalysHoverable)&&(this.addState("hover"),this.fireEvent("over"))},Stateful_onMouseLeave:function(t,e){(!this.isDisabled()||this.alwalysHoverable)&&(this.removeState("hover"),this.removeState("active"),this.fireEvent("out"))},Stateful_onMouseOver:function(t,e){var a=t.relatedTarget;s.contains(e,a)||e===a||this.Stateful_onMouseEnter(t,e)},Stateful_onMouseOut:function(t,e){var a=t.relatedTarget;s.contains(e,a)||e===a||this.Stateful_onMouseLeave(t,e)},Stateful_onMouseDown:function(t,e){this.isDisabled()||this.addState("active")},Stateful_onMouseUp:function(t,e){this.isDisabled()||this.removeState("active")},Stateful_postRender:function(){this.disabled&&!this.hasState("disabled")&&this.addState("disabled")},hasState:function(t){return e.hasClass(this.getStateDom(),"edui-state-"+t)},addState:function(t){this.hasState(t)||(this.getStateDom().className+=" edui-state-"+t)},removeState:function(t){this.hasState(t)&&e.removeClasses(this.getStateDom(),["edui-state-"+t])},getStateDom:function(){return this.getDom("state")},isChecked:function(){return this.hasState("checked")},setChecked:function(t){!this.isDisabled()&&t?this.addState("checked"):this.removeState("checked")},isDisabled:function(){return this.hasState("disabled")},setDisabled:function(t){t?(this.removeState("hover"),this.removeState("checked"),this.removeState("active"),this.addState("disabled")):this.removeState("disabled")}}}();
!function(){var t=baidu.editor.utils,i=baidu.editor.ui.UIBase,e=baidu.editor.ui.Stateful,s=baidu.editor.ui.Button=function(t){if(t.name){var i=t.name,e=t.cssRules;t.className||(t.className="edui-for-"+i),t.cssRules=".edui-default  .edui-for-"+i+" .edui-icon {"+e+"}"}this.initOptions(t),this.initButton()};s.prototype={uiName:"button",label:"",title:"",showIcon:!0,showText:!0,cssRules:"",initButton:function(){this.initUIBase(),this.Stateful_init(),this.cssRules&&t.cssRule("edui-customize-"+this.name+"-style",this.cssRules)},getHtmlTpl:function(){return'<div id="##" class="edui-box %%"><div id="##_state" stateful><div class="%%-wrap"><div id="##_body" unselectable="on" '+(this.title?'title="'+this.title+'"':"")+' class="%%-body" onmousedown="return $$._onMouseDown(event, this);" onclick="return $$._onClick(event, this);">'+(this.showIcon?'<div class="edui-box edui-icon"></div>':"")+(this.showText?'<div class="edui-box edui-label">'+this.label+"</div>":"")+"</div></div></div></div>"},postRender:function(){this.Stateful_postRender(),this.setDisabled(this.disabled)},_onMouseDown:function(t){var i=t.target||t.srcElement,e=i&&i.tagName&&i.tagName.toLowerCase();return"input"==e||"object"==e||"object"==e?!1:void 0},_onClick:function(){this.isDisabled()||this.fireEvent("click")},setTitle:function(t){var i=this.getDom("label");i.innerHTML=t}},t.inherits(s,i),t.extend(s.prototype,e)}();
!function(){var i=baidu.editor.utils,t=baidu.editor.ui.uiUtils,o=(baidu.editor.dom.domUtils,baidu.editor.ui.UIBase),e=baidu.editor.ui.Stateful,s=baidu.editor.ui.SplitButton=function(i){this.initOptions(i),this.initSplitButton()};s.prototype={popup:null,uiName:"splitbutton",title:"",initSplitButton:function(){this.initUIBase(),this.Stateful_init();if(null!=this.popup){var i=this.popup;this.popup=null,this.setPopup(i)}},_UIBase_postRender:o.prototype.postRender,postRender:function(){this.Stateful_postRender(),this._UIBase_postRender()},setPopup:function(o){this.popup!==o&&(null!=this.popup&&this.popup.dispose(),o.addListener("show",i.bind(this._onPopupShow,this)),o.addListener("hide",i.bind(this._onPopupHide,this)),o.addListener("postrender",i.bind(function(){o.getDom("body").appendChild(t.createElementByHtml('<div id="'+this.popup.id+'_bordereraser" class="edui-bordereraser edui-background" style="width:'+(t.getClientRect(this.getDom()).width+20)+'px"></div>')),o.getDom().className+=" "+this.className},this)),this.popup=o)},_onPopupShow:function(){this.addState("opened")},_onPopupHide:function(){this.removeState("opened")},getHtmlTpl:function(){return'<div id="##" class="edui-box %%"><div '+(this.title?'title="'+this.title+'"':"")+' id="##_state" stateful><div class="%%-body"><div id="##_button_body" class="edui-box edui-button-body" onclick="$$._onButtonClick(event, this);"><div class="edui-box edui-icon"></div></div><div class="edui-box edui-splitborder"></div><div class="edui-box edui-arrow" onclick="$$._onArrowClick();"></div></div></div></div>'},showPopup:function(){var i=t.getClientRect(this.getDom());i.top-=this.popup.SHADOW_RADIUS,i.height+=this.popup.SHADOW_RADIUS,this.popup.showAnchorRect(i)},_onArrowClick:function(i,t){this.isDisabled()||this.showPopup()},_onButtonClick:function(){this.isDisabled()||this.fireEvent("buttonclick")}},i.inherits(s,o),i.extend(s.prototype,e,!0)}();
!function(){var o=baidu.editor.utils,t=baidu.editor.ui.uiUtils,i=baidu.editor.ui.ColorPicker,n=baidu.editor.ui.Popup,e=baidu.editor.ui.SplitButton,r=baidu.editor.ui.ColorButton=function(o){this.initOptions(o),this.initColorButton()};r.prototype={initColorButton:function(){var o=this;this.popup=new n({content:new i({noColorText:o.editor.getLang("clearColor"),editor:o.editor,onpickcolor:function(t,i){o._onPickColor(i)},onpicknocolor:function(t,i){o._onPickNoColor(i)}}),editor:o.editor}),this.initSplitButton()},_SplitButton_postRender:e.prototype.postRender,postRender:function(){this._SplitButton_postRender(),this.getDom("button_body").appendChild(t.createElementByHtml('<div id="'+this.id+'_colorlump" class="edui-colorlump"></div>')),this.getDom().className+=" edui-colorbutton"},setColor:function(o){this.getDom("colorlump").style.backgroundColor=o,this.color=o},_onPickColor:function(o){this.fireEvent("pickcolor",o)!==!1&&(this.setColor(o),this.popup.hide())},_onPickNoColor:function(o){this.fireEvent("picknocolor")!==!1&&this.popup.hide()}},o.inherits(r,e)}();
!function(){var e=baidu.editor.utils,t=baidu.editor.ui.UIBase,i=baidu.editor.ui.AutoTypeSetPicker=function(e){this.initOptions(e),this.initAutoTypeSetPicker()};i.prototype={initAutoTypeSetPicker:function(){this.initUIBase()},getHtmlTpl:function(){var e=this.editor,t=e.options.autotypeset,i=e.getLang("autoTypeSet"),n="textAlignValue"+e.uid,a="imageBlockLineValue"+e.uid,c="symbolConverValue"+e.uid;return'<div id="##" class="edui-autotypesetpicker %%"><div class="edui-autotypesetpicker-body"><table ><tr><td nowrap><input type="checkbox" name="mergeEmptyline" '+(t.mergeEmptyline?"checked":"")+">"+i.mergeLine+'</td><td colspan="2"><input type="checkbox" name="removeEmptyline" '+(t.removeEmptyline?"checked":"")+">"+i.delLine+'</td></tr><tr><td nowrap><input type="checkbox" name="removeClass" '+(t.removeClass?"checked":"")+">"+i.removeFormat+'</td><td colspan="2"><input type="checkbox" name="indent" '+(t.indent?"checked":"")+">"+i.indent+'</td></tr><tr><td nowrap><input type="checkbox" name="textAlign" '+(t.textAlign?"checked":"")+">"+i.alignment+'</td><td colspan="2" id="'+n+'"><input type="radio" name="'+n+'" value="left" '+(t.textAlign&&"left"==t.textAlign?"checked":"")+">"+e.getLang("justifyleft")+'<input type="radio" name="'+n+'" value="center" '+(t.textAlign&&"center"==t.textAlign?"checked":"")+">"+e.getLang("justifycenter")+'<input type="radio" name="'+n+'" value="right" '+(t.textAlign&&"right"==t.textAlign?"checked":"")+">"+e.getLang("justifyright")+'</td></tr><tr><td nowrap><input type="checkbox" name="imageBlockLine" '+(t.imageBlockLine?"checked":"")+">"+i.imageFloat+'</td><td nowrap id="'+a+'"><input type="radio" name="'+a+'" value="none" '+(t.imageBlockLine&&"none"==t.imageBlockLine?"checked":"")+">"+e.getLang("default")+'<input type="radio" name="'+a+'" value="left" '+(t.imageBlockLine&&"left"==t.imageBlockLine?"checked":"")+">"+e.getLang("justifyleft")+'<input type="radio" name="'+a+'" value="center" '+(t.imageBlockLine&&"center"==t.imageBlockLine?"checked":"")+">"+e.getLang("justifycenter")+'<input type="radio" name="'+a+'" value="right" '+(t.imageBlockLine&&"right"==t.imageBlockLine?"checked":"")+">"+e.getLang("justifyright")+'</td></tr><tr><td nowrap><input type="checkbox" name="clearFontSize" '+(t.clearFontSize?"checked":"")+">"+i.removeFontsize+'</td><td colspan="2"><input type="checkbox" name="clearFontFamily" '+(t.clearFontFamily?"checked":"")+">"+i.removeFontFamily+'</td></tr><tr><td nowrap colspan="3"><input type="checkbox" name="removeEmptyNode" '+(t.removeEmptyNode?"checked":"")+">"+i.removeHtml+'</td></tr><tr><td nowrap colspan="3"><input type="checkbox" name="pasteFilter" '+(t.pasteFilter?"checked":"")+">"+i.pasteFilter+'</td></tr><tr><td nowrap><input type="checkbox" name="symbolConver" '+(t.bdc2sb||t.tobdc?"checked":"")+">"+i.symbol+'</td><td id="'+c+'"><input type="radio" name="bdc" value="bdc2sb" '+(t.bdc2sb?"checked":"")+">"+i.bdc2sb+'<input type="radio" name="bdc" value="tobdc" '+(t.tobdc?"checked":"")+">"+i.tobdc+'</td><td nowrap align="right"><button >'+i.run+"</button></td></tr></table></div></div>"},_UIBase_render:t.prototype.render},e.inherits(i,t)}();
!function(){function e(e){for(var i,n={},o=e.getDom(),a=e.editor.uid,u=null,d=null,l=domUtils.getElementsByTagName(o,"input"),r=l.length-1;i=l[r--];)if(u=i.getAttribute("type"),"checkbox"==u)if(d=i.getAttribute("name"),n[d]&&delete n[d],i.checked){var s=document.getElementById(d+"Value"+a);if(s){if(/input/gi.test(s.tagName))n[d]=s.value;else for(var c,m=s.getElementsByTagName("input"),g=m.length-1;c=m[g--];)if(c.checked){n[d]=c.value;break}}else n[d]=!0}else n[d]=!1;else n[i.getAttribute("value")]=i.checked;for(var h,p=domUtils.getElementsByTagName(o,"select"),r=0;h=p[r++];){var f=h.getAttribute("name");n[f]=n[f]?h.value:""}t.extend(e.editor.options.autotypeset,n),e.editor.setPreferences("autotypeset",n)}var t=baidu.editor.utils,i=baidu.editor.ui.Popup,n=baidu.editor.ui.AutoTypeSetPicker,o=baidu.editor.ui.SplitButton,a=baidu.editor.ui.AutoTypeSetButton=function(e){this.initOptions(e),this.initAutoTypeSetButton()};a.prototype={initAutoTypeSetButton:function(){var t=this;this.popup=new i({content:new n({editor:t.editor}),editor:t.editor,hide:function(){!this._hidden&&this.getDom()&&(e(this),this.getDom().style.display="none",this._hidden=!0,this.fireEvent("hide"))}});var o=0;this.popup.addListener("postRenderAfter",function(){var i=this;if(!o){var n=this.getDom(),a=n.getElementsByTagName("button")[0];a.onclick=function(){e(i),t.editor.execCommand("autotypeset"),i.hide()},domUtils.on(n,"click",function(n){var o=n.target||n.srcElement,a=t.editor.uid;if(o&&"INPUT"==o.tagName){if("imageBlockLine"==o.name||"textAlign"==o.name||"symbolConver"==o.name)for(var u=o.checked,d=document.getElementById(o.name+"Value"+a),l=d.getElementsByTagName("input"),r={imageBlockLine:"none",textAlign:"left",symbolConver:"tobdc"},s=0;s<l.length;s++)u?l[s].value==r[o.name]&&(l[s].checked="checked"):l[s].checked=!1;if(o.name=="imageBlockLineValue"+a||o.name=="textAlignValue"+a||"bdc"==o.name){var c=o.parentNode.previousSibling.getElementsByTagName("input");c&&(c[0].checked=!0)}e(i)}}),o=1}}),this.initSplitButton()}},t.inherits(a,o)}();
!function(){var t=baidu.editor.utils,i=baidu.editor.ui.Stateful,e=baidu.editor.ui.uiUtils,s=baidu.editor.ui.UIBase,d=baidu.editor.ui.PastePicker=function(t){this.initOptions(t),this.initPastePicker()};d.prototype={initPastePicker:function(){this.initUIBase(),this.Stateful_init()},getHtmlTpl:function(){return'<div class="edui-pasteicon" onclick="$$._onClick(this)"></div><div class="edui-pastecontainer"><div class="edui-title">'+this.editor.getLang("pasteOpt")+'</div><div class="edui-button"><div title="'+this.editor.getLang("pasteSourceFormat")+'" onclick="$$.format(false)" stateful><div class="edui-richtxticon"></div></div><div title="'+this.editor.getLang("tagFormat")+'" onclick="$$.format(2)" stateful><div class="edui-tagicon"></div></div><div title="'+this.editor.getLang("pasteTextFormat")+'" onclick="$$.format(true)" stateful><div class="edui-plaintxticon"></div></div></div></div></div>'},getStateDom:function(){return this.target},format:function(t){this.editor.ui._isTransfer=!0,this.editor.fireEvent("pasteTransfer",t)},_onClick:function(t){var i=domUtils.getNextDomNode(t),s=e.getViewportRect().height,d=e.getClientRect(i);i.style.top=d.top+d.height>s?-d.height-t.offsetHeight+"px":"",/hidden/gi.test(domUtils.getComputedStyle(i,"visibility"))?(i.style.visibility="visible",domUtils.addClass(t,"edui-state-opened")):(i.style.visibility="hidden",domUtils.removeClasses(t,"edui-state-opened"))},_UIBase_render:s.prototype.render},t.inherits(d,s),t.extend(d.prototype,i,!0)}();
!function(){var t=baidu.editor.utils,i=baidu.editor.ui.uiUtils,e=baidu.editor.ui.UIBase,o=baidu.editor.ui.Toolbar=function(t){this.initOptions(t),this.initToolbar()};o.prototype={items:null,initToolbar:function(){this.items=this.items||[],this.initUIBase()},add:function(t,i){void 0===i?this.items.push(t):this.items.splice(i,0,t)},getHtmlTpl:function(){for(var t=[],i=0;i<this.items.length;i++)t[i]=this.items[i].renderHtml();return'<div id="##" class="edui-toolbar %%" onselectstart="return false;" onmousedown="return $$._onMouseDown(event, this);">'+t.join("")+"</div>"},postRender:function(){for(var t=this.getDom(),e=0;e<this.items.length;e++)this.items[e].postRender();i.makeUnselectable(t)},_onMouseDown:function(t){var i=t.target||t.srcElement,e=i&&i.tagName&&i.tagName.toLowerCase();return"input"==e||"object"==e||"object"==e?!1:void 0}},t.inherits(o,e)}();
!function(){var e=baidu.editor.utils,t=baidu.editor.dom.domUtils,i=baidu.editor.ui.uiUtils,n=baidu.editor.ui.UIBase,s=baidu.editor.ui.Popup,u=baidu.editor.ui.Stateful,o=baidu.editor.ui.CellAlignPicker,r=baidu.editor.ui.Menu=function(e){this.initOptions(e),this.initMenu()},d={renderHtml:function(){return'<div class="edui-menuitem edui-menuseparator"><div class="edui-menuseparator-inner"></div></div>'},postRender:function(){},queryAutoHide:function(){return!0}};r.prototype={items:null,uiName:"menu",initMenu:function(){this.items=this.items||[],this.initPopup(),this.initItems()},initItems:function(){for(var e=0;e<this.items.length;e++){var t=this.items[e];"-"==t?this.items[e]=this.getSeparator():t instanceof a||(t.editor=this.editor,t.theme=this.editor.options.theme,this.items[e]=this.createItem(t))}},getSeparator:function(){return d},createItem:function(e){return e.menu=this,new a(e)},_Popup_getContentHtmlTpl:s.prototype.getContentHtmlTpl,getContentHtmlTpl:function(){if(0==this.items.length)return this._Popup_getContentHtmlTpl();for(var e=[],t=0;t<this.items.length;t++){var i=this.items[t];e[t]=i.renderHtml()}return'<div class="%%-body">'+e.join("")+"</div>"},_Popup_postRender:s.prototype.postRender,postRender:function(){for(var e=this,n=0;n<this.items.length;n++){var s=this.items[n];s.ownerMenu=this,s.postRender()}t.on(this.getDom(),"mouseover",function(t){t=t||event;var n=t.relatedTarget||t.fromElement,s=e.getDom();i.contains(s,n)||s===n||e.fireEvent("over")}),this._Popup_postRender()},queryAutoHide:function(e){if(e){if(i.contains(this.getDom(),e))return!1;for(var t=0;t<this.items.length;t++){var n=this.items[t];if(n.queryAutoHide(e)===!1)return!1}}},clearItems:function(){for(var e=0;e<this.items.length;e++){var t=this.items[e];clearTimeout(t._showingTimer),clearTimeout(t._closingTimer),t.subMenu&&t.subMenu.destroy()}this.items=[]},destroy:function(){this.getDom()&&t.remove(this.getDom()),this.clearItems()},dispose:function(){this.destroy()}},e.inherits(r,s);var a=baidu.editor.ui.MenuItem=function(e){if(this.initOptions(e),this.initUIBase(),this.Stateful_init(),this.subMenu&&!(this.subMenu instanceof r))if(e.className&&-1!=e.className.indexOf("aligntd")){var i=this;this.subMenu.selected=this.editor.queryCommandValue("cellalignment"),this.subMenu=new s({content:new o(this.subMenu),parentMenu:i,editor:i.editor,destroy:function(){this.getDom()&&t.remove(this.getDom())}}),this.subMenu.addListener("postRenderAfter",function(){t.on(this.getDom(),"mouseover",function(){i.addState("opened")})})}else this.subMenu=new r(this.subMenu)};a.prototype={label:"",subMenu:null,ownerMenu:null,uiName:"menuitem",alwalysHoverable:!0,getHtmlTpl:function(){return'<div id="##" class="%%" stateful onclick="$$._onClick(event, this);"><div class="%%-body">'+this.renderLabelHtml()+"</div></div>"},postRender:function(){var e=this;this.addListener("over",function(){e.ownerMenu.fireEvent("submenuover",e),e.subMenu&&e.delayShowSubMenu()}),this.subMenu&&(this.getDom().className+=" edui-hassubmenu",this.subMenu.render(),this.addListener("out",function(){e.delayHideSubMenu()}),this.subMenu.addListener("over",function(){clearTimeout(e._closingTimer),e._closingTimer=null,e.addState("opened")}),this.ownerMenu.addListener("hide",function(){e.hideSubMenu()}),this.ownerMenu.addListener("submenuover",function(t,i){i!==e&&e.delayHideSubMenu()}),this.subMenu._bakQueryAutoHide=this.subMenu.queryAutoHide,this.subMenu.queryAutoHide=function(t){return t&&i.contains(e.getDom(),t)?!1:this._bakQueryAutoHide(t)}),this.getDom().style.tabIndex="-1",i.makeUnselectable(this.getDom()),this.Stateful_postRender()},delayShowSubMenu:function(){var e=this;e.isDisabled()||(e.addState("opened"),clearTimeout(e._showingTimer),clearTimeout(e._closingTimer),e._closingTimer=null,e._showingTimer=setTimeout(function(){e.showSubMenu()},250))},delayHideSubMenu:function(){var e=this;e.isDisabled()||(e.removeState("opened"),clearTimeout(e._showingTimer),e._closingTimer||(e._closingTimer=setTimeout(function(){e.hasState("opened")||e.hideSubMenu(),e._closingTimer=null},400)))},renderLabelHtml:function(){return'<div class="edui-arrow"></div><div class="edui-box edui-icon"></div><div class="edui-box edui-label %%-label">'+(this.label||"")+"</div>"},getStateDom:function(){return this.getDom()},queryAutoHide:function(e){return this.subMenu&&this.hasState("opened")?this.subMenu.queryAutoHide(e):void 0},_onClick:function(e,t){this.hasState("disabled")||this.fireEvent("click",e,t)!==!1&&(this.subMenu?this.showSubMenu():s.postHide(e))},showSubMenu:function(){var e=i.getClientRect(this.getDom());e.right-=5,e.left+=2,e.width-=7,e.top-=4,e.bottom+=4,e.height+=8,this.subMenu.showAnchorRect(e,!0,!0)},hideSubMenu:function(){this.subMenu.hide()}},e.inherits(a,n),e.extend(a.prototype,u,!0)}();
!function(){var t=baidu.editor.utils,i=baidu.editor.ui.uiUtils,e=baidu.editor.ui.Menu,s=baidu.editor.ui.SplitButton,n=baidu.editor.ui.Combox=function(t){this.initOptions(t),this.initCombox()};n.prototype={uiName:"combox",onbuttonclick:function(){this.showPopup()},initCombox:function(){var t=this;this.items=this.items||[];for(var i=0;i<this.items.length;i++){var s=this.items[i];s.uiName="listitem",s.index=i,s.onclick=function(){t.selectByIndex(this.index)}}this.popup=new e({items:this.items,uiName:"list",editor:this.editor,captureWheel:!0,combox:this}),this.initSplitButton()},_SplitButton_postRender:s.prototype.postRender,postRender:function(){this._SplitButton_postRender(),this.setLabel(this.label||""),this.setValue(this.initValue||"")},showPopup:function(){var t=i.getClientRect(this.getDom());t.top+=1,t.bottom-=1,t.height-=2,this.popup.showAnchorRect(t)},getValue:function(){return this.value},setValue:function(t){var i=this.indexByValue(t);-1!=i?(this.selectedIndex=i,this.setLabel(this.items[i].label),this.value=this.items[i].value):(this.selectedIndex=-1,this.setLabel(this.getLabelForUnknowValue(t)),this.value=t)},setLabel:function(t){this.getDom("button_body").innerHTML=t,this.label=t},getLabelForUnknowValue:function(t){return t},indexByValue:function(t){for(var i=0;i<this.items.length;i++)if(t==this.items[i].value)return i;return-1},getItem:function(t){return this.items[t]},selectByIndex:function(t){t<this.items.length&&this.fireEvent("select",t)!==!1&&(this.selectedIndex=t,this.value=this.items[t].value,this.setLabel(this.items[t].label))}},t.inherits(n,s)}();
!function(){var t,e,i,s=baidu.editor.utils,o=baidu.editor.dom.domUtils,n=baidu.editor.ui.uiUtils,d=baidu.editor.ui.Mask,h=baidu.editor.ui.UIBase,l=baidu.editor.ui.Button,a=baidu.editor.ui.Dialog=function(t){if(t.name){var e=t.name,i=t.cssRules;t.className||(t.className="edui-for-"+e),i&&(t.cssRules=".edui-default .edui-for-"+e+" .edui-dialog-content  {"+i+"}")}this.initOptions(s.extend({autoReset:!0,draggable:!0,onok:function(){},oncancel:function(){},onclose:function(t,e){return e?this.onok():this.oncancel()},holdScroll:!1},t)),this.initDialog()};a.prototype={draggable:!1,uiName:"dialog",initDialog:function(){var o=this,n=this.editor.options.theme;if(this.cssRules&&s.cssRule("edui-customize-"+this.name+"-style",this.cssRules),this.initUIBase(),this.modalMask=t||(t=new d({className:"edui-dialog-modalmask",theme:n,onclick:function(){i&&i.close(!1)}})),this.dragMask=e||(e=new d({className:"edui-dialog-dragmask",theme:n})),this.closeButton=new l({className:"edui-dialog-closebutton",title:o.closeDialog,theme:n,onclick:function(){o.close(!1)}}),this.fullscreen&&this.initResizeEvent(),this.buttons)for(var h=0;h<this.buttons.length;h++)this.buttons[h]instanceof l||(this.buttons[h]=new l(s.extend(this.buttons[h],{editor:this.editor},!0)))},initResizeEvent:function(){var t=this;o.on(window,"resize",function(){t._hidden||void 0===t._hidden||(t.__resizeTimer&&window.clearTimeout(t.__resizeTimer),t.__resizeTimer=window.setTimeout(function(){t.__resizeTimer=null;var e=t.getDom(),i=t.getDom("content"),s=UE.ui.uiUtils.getClientRect(e),o=UE.ui.uiUtils.getClientRect(i),d=n.getViewportRect();i.style.width=d.width-s.width+o.width+"px",i.style.height=d.height-s.height+o.height+"px",e.style.width=d.width+"px",e.style.height=d.height+"px",t.fireEvent("resize")},100))})},fitSize:function(){var t=this.getDom("body"),e=this.mesureSize();return t.style.width=e.width+"px",t.style.height=e.height+"px",e},safeSetOffset:function(t){var e=this,i=e.getDom(),s=n.getViewportRect(),o=n.getClientRect(i),d=t.left;d+o.width>s.right&&(d=s.right-o.width);var h=t.top;h+o.height>s.bottom&&(h=s.bottom-o.height),i.style.left=Math.max(d,0)+"px",i.style.top=Math.max(h,0)+"px"},showAtCenter:function(){var t=n.getViewportRect();if(this.fullscreen){var e=this.getDom(),i=this.getDom("content");e.style.display="block";var s=UE.ui.uiUtils.getClientRect(e),d=UE.ui.uiUtils.getClientRect(i);e.style.left="-100000px",i.style.width=t.width-s.width+d.width+"px",i.style.height=t.height-s.height+d.height+"px",e.style.width=t.width+"px",e.style.height=t.height+"px",e.style.left=0,this._originalContext={html:{overflowX:document.documentElement.style.overflowX,overflowY:document.documentElement.style.overflowY},body:{overflowX:document.body.style.overflowX,overflowY:document.body.style.overflowY}},document.documentElement.style.overflowX="hidden",document.documentElement.style.overflowY="hidden",document.body.style.overflowX="hidden",document.body.style.overflowY="hidden"}else{this.getDom().style.display="";var h=this.fitSize(),l=0|this.getDom("titlebar").offsetHeight,a=t.width/2-h.width/2,r=t.height/2-(h.height-l)/2-l,c=this.getDom();this.safeSetOffset({left:Math.max(0|a,0),top:Math.max(0|r,0)}),o.hasClass(c,"edui-state-centered")||(c.className+=" edui-state-centered")}this._show()},getContentHtml:function(){var t="";return"string"==typeof this.content?t=this.content:this.iframeUrl&&(t='<span id="'+this.id+'_contmask" class="dialogcontmask"></span><iframe id="'+this.id+'_iframe" class="%%-iframe" height="100%" width="100%" frameborder="0" src="'+this.iframeUrl+'"></iframe>'),t},getHtmlTpl:function(){var t="";if(this.buttons){for(var e=[],i=0;i<this.buttons.length;i++)e[i]=this.buttons[i].renderHtml();t='<div class="%%-foot"><div id="##_buttons" class="%%-buttons">'+e.join("")+"</div></div>"}return'<div id="##" class="%%"><div '+(this.fullscreen?'class="%%-wrap edui-dialog-fullscreen-flag"':'class="%%"')+'><div id="##_body" class="%%-body"><div class="%%-shadow"></div><div id="##_titlebar" class="%%-titlebar"><div class="%%-draghandle" onmousedown="$$._onTitlebarMouseDown(event, this);"><span class="%%-caption">'+(this.title||"")+"</span></div>"+this.closeButton.renderHtml()+'</div><div id="##_content" class="%%-content">'+(this.autoReset?"":this.getContentHtml())+"</div>"+t+"</div></div></div>"},postRender:function(){this.modalMask.getDom()||(this.modalMask.render(),this.modalMask.hide()),this.dragMask.getDom()||(this.dragMask.render(),this.dragMask.hide());var t=this;if(this.addListener("show",function(){t.modalMask.show(this.getDom().style.zIndex-2)}),this.addListener("hide",function(){t.modalMask.hide()}),this.buttons)for(var e=0;e<this.buttons.length;e++)this.buttons[e].postRender();o.on(window,"resize",function(){setTimeout(function(){t.isHidden()||t.safeSetOffset(n.getClientRect(t.getDom()))})}),this._hide()},mesureSize:function(){var t=this.getDom("body"),e=n.getClientRect(this.getDom("content")).width,i=t.style;return i.width=e,n.getClientRect(t)},_onTitlebarMouseDown:function(t,e){if(this.draggable){var i,s=(n.getViewportRect(),this);n.startDrag(t,{ondragstart:function(){i=n.getClientRect(s.getDom()),s.getDom("contmask").style.visibility="visible",s.dragMask.show(s.getDom().style.zIndex-1)},ondragmove:function(t,e){var o=i.left+t,n=i.top+e;s.safeSetOffset({left:o,top:n})},ondragstop:function(){s.getDom("contmask").style.visibility="hidden",o.removeClasses(s.getDom(),["edui-state-centered"]),s.dragMask.hide()}})}},reset:function(){this.getDom("content").innerHTML=this.getContentHtml(),this.fireEvent("dialogafterreset")},_show:function(){this._hidden&&(this.getDom().style.display="",this.editor.container.style.zIndex&&(this.getDom().style.zIndex=1*this.editor.container.style.zIndex+10),this._hidden=!1,this.fireEvent("show"),baidu.editor.ui.uiUtils.getFixedLayer().style.zIndex=this.getDom().style.zIndex-4)},isHidden:function(){return this._hidden},_hide:function(){if(!this._hidden){var t=this.getDom();t.style.display="none",t.style.zIndex="",t.style.width="",t.style.height="",this._hidden=!0,this.fireEvent("hide")}},open:function(){if(this.autoReset)try{this.reset()}catch(t){this.render(),this.open()}if(this.showAtCenter(),this.iframeUrl)try{this.getDom("iframe").focus()}catch(e){}i=this},_onCloseButtonClick:function(t,e){this.close(!1)},close:function(t){if(this.fireEvent("close",t)!==!1){this.fullscreen&&(document.documentElement.style.overflowX=this._originalContext.html.overflowX,document.documentElement.style.overflowY=this._originalContext.html.overflowY,document.body.style.overflowX=this._originalContext.body.overflowX,document.body.style.overflowY=this._originalContext.body.overflowY,delete this._originalContext),this._hide();var e=this.getDom("content"),i=this.getDom("iframe");if(e&&i){var s=i.contentDocument||i.contentWindow.document;s&&(s.body.innerHTML=""),o.remove(e)}}}},s.inherits(a,h)}();
!function(){var t=baidu.editor.utils,i=baidu.editor.ui.Menu,e=baidu.editor.ui.SplitButton,u=baidu.editor.ui.MenuButton=function(t){this.initOptions(t),this.initMenuButton()};u.prototype={initMenuButton:function(){var t=this;this.uiName="menubutton",this.popup=new i({items:t.items,className:t.className,editor:t.editor}),this.popup.addListener("show",function(){for(var i=this,e=0;e<i.items.length;e++)i.items[e].removeState("checked"),i.items[e].value==t._value&&(i.items[e].addState("checked"),this.value=t._value)}),this.initSplitButton()},setValue:function(t){this._value=t}},t.inherits(u,e)}();
!function(){var i=baidu.editor.utils,t=baidu.editor.ui.Popup,e=baidu.editor.ui.SplitButton,n=baidu.editor.ui.MultiMenuPop=function(i){this.initOptions(i),this.initMultiMenu()};n.prototype={initMultiMenu:function(){var i=this;this.popup=new t({content:"",editor:i.editor,iframe_rendered:!1,onshow:function(){this.iframe_rendered||(this.iframe_rendered=!0,this.getDom("content").innerHTML='<iframe id="'+i.id+'_iframe" src="'+i.iframeUrl+'" frameborder="0"></iframe>',i.editor.container.style.zIndex&&(this.getDom().style.zIndex=1*i.editor.container.style.zIndex+1))}}),this.onbuttonclick=function(){this.showPopup()},this.initSplitButton()}},i.inherits(n,e)}();
!function(){function t(t){var e=t.target||t.srcElement,i=r.findParent(e,function(t){return r.hasClass(t,"edui-shortcutmenu")||r.hasClass(t,"edui-popup")},!0);if(!i)for(var s,n=0;s=a[n++];)s.hide()}var e,i=baidu.editor.ui,s=i.UIBase,n=i.uiUtils,o=baidu.editor.utils,r=baidu.editor.dom.domUtils,a=[],u=!1,d=i.ShortCutMenu=function(t){this.initOptions(t),this.initShortCutMenu()};d.postHide=t,d.prototype={isHidden:!0,SPACE:5,initShortCutMenu:function(){this.items=this.items||[],this.initUIBase(),this.initItems(),this.initEvent(),a.push(this)},initEvent:function(){var t=this,i=t.editor.document;r.on(i,"mousemove",function(i){if(t.isHidden===!1){if(t.getSubMenuMark()||"contextmenu"==t.eventType)return;var s=!0,n=t.getDom(),o=n.offsetWidth,r=n.offsetHeight,a=o/2+t.SPACE,u=r/2,d=Math.abs(i.screenX-t.left),f=Math.abs(i.screenY-t.top);clearTimeout(e),e=setTimeout(function(){f>0&&u>f?t.setOpacity(n,"1"):f>u&&u+70>f?(t.setOpacity(n,"0.5"),s=!1):f>u+70&&u+140>f&&t.hide(),s&&d>0&&a>d?t.setOpacity(n,"1"):d>a&&a+70>d?t.setOpacity(n,"0.5"):d>a+70&&a+140>d&&t.hide()})}}),browser.chrome&&r.on(i,"mouseout",function(e){var i=e.relatedTarget||e.toElement;(null==i||"HTML"==i.tagName)&&t.hide()}),t.editor.addListener("afterhidepop",function(){t.isHidden||(u=!0)})},initItems:function(){if(o.isArray(this.items))for(var t=0,e=this.items.length;e>t;t++){var s=this.items[t].toLowerCase();i[s]&&(this.items[t]=new i[s](this.editor),this.items[t].className+=" edui-shortcutsubmenu ")}},setOpacity:function(t,e){browser.ie&&browser.version<9?t.style.filter="alpha(opacity = "+100*parseFloat(e)+");":t.style.opacity=e},getSubMenuMark:function(){u=!1;for(var t,e=n.getFixedLayer(),i=r.getElementsByTagName(e,"div",function(t){return r.hasClass(t,"edui-shortcutsubmenu edui-popup")}),s=0;t=i[s++];)"none"!=t.style.display&&(u=!0);return u},show:function(t,e){function i(t){t.left<0&&(t.left=0),t.top<0&&(t.top=0),u.style.cssText="position:absolute;left:"+t.left+"px;top:"+t.top+"px;"}function s(t){t.tagName||(t=t.getDom()),a.left=parseInt(t.style.left),a.top=parseInt(t.style.top),a.top-=u.offsetHeight+15,i(a)}var o=this,a={},u=this.getDom(),d=n.getFixedLayer();if(o.eventType=t.type,u.style.cssText="display:block;left:-9999px","contextmenu"==t.type&&e){var f=r.getElementsByTagName(d,"div","edui-contextmenu")[0];f?s(f):o.editor.addListener("aftershowcontextmenu",function(t,e){s(e)})}else a=n.getViewportOffsetByEvent(t),a.top-=u.offsetHeight+o.SPACE,a.left+=o.SPACE+20,i(a),o.setOpacity(u,.2);o.isHidden=!1,o.left=t.screenX+u.offsetWidth/2-o.SPACE,o.top=t.screenY-u.offsetHeight/2-o.SPACE,o.editor&&(u.style.zIndex=1*o.editor.container.style.zIndex+10,d.style.zIndex=u.style.zIndex-1)},hide:function(){this.getDom()&&(this.getDom().style.display="none"),this.isHidden=!0},postRender:function(){if(o.isArray(this.items))for(var t,e=0;t=this.items[e++];)t.postRender()},getHtmlTpl:function(){var t;if(o.isArray(this.items)){t=[];for(var e=0;e<this.items.length;e++)t[e]=this.items[e].renderHtml();t=t.join("")}else t=this.items;return'<div id="##" class="%% edui-toolbar" data-src="shortcutmenu" onmousedown="return false;" onselectstart="return false;" >'+t+"</div>"}},o.inherits(d,s),r.on(document,"mousedown",function(e){t(e)}),r.on(window,"scroll",function(e){t(e)})}();
!function(){var i=baidu.editor.utils,t=baidu.editor.ui.UIBase,n=baidu.editor.ui.Breakline=function(i){this.initOptions(i),this.initSeparator()};n.prototype={uiName:"Breakline",initSeparator:function(){this.initUIBase()},getHtmlTpl:function(){return"<br/>"}},i.inherits(n,t)}();
!function(){var e=baidu.editor.utils,t=baidu.editor.dom.domUtils,i=baidu.editor.ui.UIBase,s=baidu.editor.ui.Message=function(e){this.initOptions(e),this.initMessage()};s.prototype={initMessage:function(){this.initUIBase()},getHtmlTpl:function(){return'<div id="##" class="edui-message %%"> <div id="##_closer" class="edui-message-closer">×</div> <div id="##_body" class="edui-message-body edui-message-type-info"> <iframe style="position:absolute;z-index:-1;left:0;top:0;background-color: transparent;" frameborder="0" width="100%" height="100%" src="about:blank"></iframe> <div class="edui-shadow"></div> <div id="##_content" class="edui-message-content">  </div> </div></div>'},reset:function(e){var t=this;e.keepshow||(clearTimeout(this.timer),t.timer=setTimeout(function(){t.hide()},e.timeout||4e3)),void 0!==e.content&&t.setContent(e.content),void 0!==e.type&&t.setType(e.type),t.show()},postRender:function(){var e=this,i=this.getDom("closer");i&&t.on(i,"click",function(){e.hide()})},setContent:function(e){this.getDom("content").innerHTML=e},setType:function(e){e=e||"info";var t=this.getDom("body");t.className=t.className.replace(/edui-message-type-[\w-]+/,"edui-message-type-"+e)},getContent:function(){return this.getDom("content").innerHTML},getType:function(){var e=this.getDom("body").match(/edui-message-type-([\w-]+)/);return e?e[1]:""},show:function(){this.getDom().style.display="block"},hide:function(){var e=this.getDom();e&&(e.style.display="none",e.parentNode&&e.parentNode.removeChild(e))}},e.inherits(s,i)}();
!function(){var e=baidu.editor.utils,t=baidu.editor.ui,a=t.Dialog;t.buttons={},t.Dialog=function(e){var t=new a(e);return t.addListener("hide",function(){if(t.editor){var e=t.editor;try{if(browser.gecko){var a=e.window.scrollY,n=e.window.scrollX;e.body.focus(),e.window.scrollTo(n,a)}else e.focus()}catch(o){}}}),t};for(var n,o={anchor:"~/dialogs/anchor/anchor.html",insertimage:"~/dialogs/image/image.html",link:"~/dialogs/link/link.html",spechars:"~/dialogs/spechars/spechars.html",searchreplace:"~/dialogs/searchreplace/searchreplace.html",map:"~/dialogs/map/map.html",gmap:"~/dialogs/gmap/gmap.html",insertvideo:"~/dialogs/video/video.html",help:"~/dialogs/help/help.html",preview:"~/dialogs/preview/preview.html",emotion:"~/dialogs/emotion/emotion.html",wordimage:"~/dialogs/wordimage/wordimage.html",attachment:"~/dialogs/attachment/attachment.html",insertframe:"~/dialogs/insertframe/insertframe.html",edittip:"~/dialogs/table/edittip.html",edittable:"~/dialogs/table/edittable.html",edittd:"~/dialogs/table/edittd.html",webapp:"~/dialogs/webapp/webapp.html",snapscreen:"~/dialogs/snapscreen/snapscreen.html",scrawl:"~/dialogs/scrawl/scrawl.html",music:"~/dialogs/music/music.html",template:"~/dialogs/template/template.html",background:"~/dialogs/background/background.html",charts:"~/dialogs/charts/charts.html"},i=["undo","redo","formatmatch","bold","italic","underline","fontborder","touppercase","tolowercase","strikethrough","subscript","superscript","source","indent","outdent","blockquote","pasteplain","pagebreak","selectall","print","horizontal","removeformat","time","date","unlink","insertparagraphbeforetable","insertrow","insertcol","mergeright","mergedown","deleterow","deletecol","splittorows","splittocols","splittocells","mergecells","deletetable","drafts"],l=0;n=i[l++];)n=n.toLowerCase(),t[n]=function(e){return function(a){var n=new t.Button({className:"edui-for-"+e,title:a.options.labelMap[e]||a.getLang("labelMap."+e)||"",onclick:function(){a.execCommand(e)},theme:a.options.theme,showText:!1});return t.buttons[e]=n,a.addListener("selectionchange",function(t,o,i){var l=a.queryCommandState(e);-1==l?(n.setDisabled(!0),n.setChecked(!1)):i||(n.setDisabled(!1),n.setChecked(l))}),n}}(n);t.cleardoc=function(e){var a=new t.Button({className:"edui-for-cleardoc",title:e.options.labelMap.cleardoc||e.getLang("labelMap.cleardoc")||"",theme:e.options.theme,onclick:function(){confirm(e.getLang("confirmClear"))&&e.execCommand("cleardoc")}});return t.buttons.cleardoc=a,e.addListener("selectionchange",function(){a.setDisabled(-1==e.queryCommandState("cleardoc"))}),a};var s={justify:["left","right","center","justify"],imagefloat:["none","left","center","right"],directionality:["ltr","rtl"]};for(var r in s)!function(e,a){for(var n,o=0;n=a[o++];)!function(a){t[e.replace("float","")+a]=function(n){var o=new t.Button({className:"edui-for-"+e.replace("float","")+a,title:n.options.labelMap[e.replace("float","")+a]||n.getLang("labelMap."+e.replace("float","")+a)||"",theme:n.options.theme,onclick:function(){n.execCommand(e,a)}});return t.buttons[e]=o,n.addListener("selectionchange",function(t,i,l){o.setDisabled(-1==n.queryCommandState(e)),o.setChecked(n.queryCommandValue(e)==a&&!l)}),o}}(n)}(r,s[r]);for(var n,l=0;n=["backcolor","forecolor"][l++];)t[n]=function(e){return function(a){var n=new t.ColorButton({className:"edui-for-"+e,color:"default",title:a.options.labelMap[e]||a.getLang("labelMap."+e)||"",editor:a,onpickcolor:function(t,n){a.execCommand(e,n)},onpicknocolor:function(){a.execCommand(e,"default"),this.setColor("transparent"),this.color="default"},onbuttonclick:function(){a.execCommand(e,this.color)}});return t.buttons[e]=n,a.addListener("selectionchange",function(){n.setDisabled(-1==a.queryCommandState(e))}),n}}(n);var c={noOk:["searchreplace","help","spechars","webapp","preview"],ok:["attachment","anchor","link","insertimage","map","gmap","insertframe","wordimage","insertvideo","insertframe","edittip","edittable","edittd","scrawl","template","music","background","charts"]};for(var r in c)!function(a,n){for(var i,l=0;i=n[l++];)browser.opera&&"searchreplace"===i||!function(n){t[n]=function(i,l,s){l=l||(i.options.iframeUrlMap||{})[n]||o[n],s=i.options.labelMap[n]||i.getLang("labelMap."+n)||"";var r;l&&(r=new t.Dialog(e.extend({iframeUrl:i.ui.mapUrl(l),editor:i,className:"edui-for-"+n,title:s,holdScroll:"insertimage"===n,fullscreen:/charts|preview/.test(n),closeDialog:i.getLang("closeDialog")},"ok"==a?{buttons:[{className:"edui-okbutton",label:i.getLang("ok"),editor:i,onclick:function(){r.close(!0)}},{className:"edui-cancelbutton",label:i.getLang("cancel"),editor:i,onclick:function(){r.close(!1)}}]}:{})),i.ui._dialogs[n+"Dialog"]=r);var c=new t.Button({className:"edui-for-"+n,title:s,onclick:function(){if(r)switch(n){case"wordimage":var e=i.execCommand("wordimage");e&&e.length&&(r.render(),r.open());break;case"scrawl":-1!=i.queryCommandState("scrawl")&&(r.render(),r.open());break;default:r.render(),r.open()}},theme:i.options.theme,disabled:"scrawl"==n&&-1==i.queryCommandState("scrawl")||"charts"==n});return t.buttons[n]=c,i.addListener("selectionchange",function(){var e={edittable:1};if(!(n in e)){var t=i.queryCommandState(n);c.getDom()&&(c.setDisabled(-1==t),c.setChecked(t))}}),c}}(i.toLowerCase())}(r,c[r]);t.snapscreen=function(e,a,n){n=e.options.labelMap.snapscreen||e.getLang("labelMap.snapscreen")||"";var i=new t.Button({className:"edui-for-snapscreen",title:n,onclick:function(){e.execCommand("snapscreen")},theme:e.options.theme});if(t.buttons.snapscreen=i,a=a||(e.options.iframeUrlMap||{}).snapscreen||o.snapscreen){var l=new t.Dialog({iframeUrl:e.ui.mapUrl(a),editor:e,className:"edui-for-snapscreen",title:n,buttons:[{className:"edui-okbutton",label:e.getLang("ok"),editor:e,onclick:function(){l.close(!0)}},{className:"edui-cancelbutton",label:e.getLang("cancel"),editor:e,onclick:function(){l.close(!1)}}]});l.render(),e.ui._dialogs.snapscreenDialog=l}return e.addListener("selectionchange",function(){i.setDisabled(-1==e.queryCommandState("snapscreen"))}),i},t.insertcode=function(a,n,o){n=a.options.insertcode||[],o=a.options.labelMap.insertcode||a.getLang("labelMap.insertcode")||"";var i=[];e.each(n,function(e,t){i.push({label:e,value:t,theme:a.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label" >'+(this.label||"")+"</div>"}})});var l=new t.Combox({editor:a,items:i,onselect:function(e,t){a.execCommand("insertcode",this.items[t].value)},onbuttonclick:function(){this.showPopup()},title:o,initValue:o,className:"edui-for-insertcode",indexByValue:function(e){if(e)for(var t,a=0;t=this.items[a];a++)if(-1!=t.value.indexOf(e))return a;return-1}});return t.buttons.insertcode=l,a.addListener("selectionchange",function(e,t,n){if(!n){var i=a.queryCommandState("insertcode");if(-1==i)l.setDisabled(!0);else{l.setDisabled(!1);var s=a.queryCommandValue("insertcode");if(!s)return void l.setValue(o);s&&(s=s.replace(/['"]/g,"").split(",")[0]),l.setValue(s)}}}),l},t.fontfamily=function(a,n,o){if(n=a.options.fontfamily||[],o=a.options.labelMap.fontfamily||a.getLang("labelMap.fontfamily")||"",n.length){for(var i,l=0,s=[];i=n[l];l++){var r=a.getLang("fontfamily")[i.name]||"";!function(t,n){s.push({label:t,value:n,theme:a.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label" style="font-family:'+e.unhtml(this.value)+'">'+(this.label||"")+"</div>"}})}(i.label||r,i.val)}var c=new t.Combox({editor:a,items:s,onselect:function(e,t){a.execCommand("FontFamily",this.items[t].value)},onbuttonclick:function(){this.showPopup()},title:o,initValue:o,className:"edui-for-fontfamily",indexByValue:function(e){if(e)for(var t,a=0;t=this.items[a];a++)if(-1!=t.value.indexOf(e))return a;return-1}});return t.buttons.fontfamily=c,a.addListener("selectionchange",function(e,t,n){if(!n){var o=a.queryCommandState("FontFamily");if(-1==o)c.setDisabled(!0);else{c.setDisabled(!1);var i=a.queryCommandValue("FontFamily");i&&(i=i.replace(/['"]/g,"").split(",")[0]),c.setValue(i)}}}),c}},t.fontsize=function(e,a,n){if(n=e.options.labelMap.fontsize||e.getLang("labelMap.fontsize")||"",a=a||e.options.fontsize||[],a.length){for(var o=[],i=0;i<a.length;i++){var l=a[i]+"px";o.push({label:l,value:l,theme:e.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label" style="line-height:1;font-size:'+this.value+'">'+(this.label||"")+"</div>"}})}var s=new t.Combox({editor:e,items:o,title:n,initValue:n,onselect:function(t,a){e.execCommand("FontSize",this.items[a].value)},onbuttonclick:function(){this.showPopup()},className:"edui-for-fontsize"});return t.buttons.fontsize=s,e.addListener("selectionchange",function(t,a,n){if(!n){var o=e.queryCommandState("FontSize");-1==o?s.setDisabled(!0):(s.setDisabled(!1),s.setValue(e.queryCommandValue("FontSize")))}}),s}},t.paragraph=function(a,n,o){if(o=a.options.labelMap.paragraph||a.getLang("labelMap.paragraph")||"",n=a.options.paragraph||[],!e.isEmptyObject(n)){var i=[];for(var l in n)i.push({value:l,label:n[l]||a.getLang("paragraph")[l],theme:a.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label"><span class="edui-for-'+this.value+'">'+(this.label||"")+"</span></div>"}});var s=new t.Combox({editor:a,items:i,title:o,initValue:o,className:"edui-for-paragraph",onselect:function(e,t){a.execCommand("Paragraph",this.items[t].value)},onbuttonclick:function(){this.showPopup()}});return t.buttons.paragraph=s,a.addListener("selectionchange",function(e,t,n){if(!n){var o=a.queryCommandState("Paragraph");if(-1==o)s.setDisabled(!0);else{s.setDisabled(!1);var i=a.queryCommandValue("Paragraph"),l=s.indexByValue(i);s.setValue(-1!=l?i:s.initValue)}}}),s}},t.customstyle=function(e){var a=e.options.customstyle||[],n=e.options.labelMap.customstyle||e.getLang("labelMap.customstyle")||"";if(a.length){for(var o,i=e.getLang("customstyle"),l=0,s=[];o=a[l++];)!function(t){var a={};a.label=t.label?t.label:i[t.name],a.style=t.style,a.className=t.className,a.tag=t.tag,s.push({label:a.label,value:a,theme:e.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label"><'+a.tag+" "+(a.className?' class="'+a.className+'"':"")+(a.style?' style="'+a.style+'"':"")+">"+a.label+"</"+a.tag+"></div>"}})}(o);var r=new t.Combox({editor:e,items:s,title:n,initValue:n,className:"edui-for-customstyle",onselect:function(t,a){e.execCommand("customstyle",this.items[a].value)},onbuttonclick:function(){this.showPopup()},indexByValue:function(e){for(var t,a=0;t=this.items[a++];)if(t.label==e)return a-1;return-1}});return t.buttons.customstyle=r,e.addListener("selectionchange",function(t,a,n){if(!n){var o=e.queryCommandState("customstyle");if(-1==o)r.setDisabled(!0);else{r.setDisabled(!1);var i=e.queryCommandValue("customstyle"),l=r.indexByValue(i);r.setValue(-1!=l?i:r.initValue)}}}),r}},t.inserttable=function(e,a,n){n=e.options.labelMap.inserttable||e.getLang("labelMap.inserttable")||"";var o=new t.TableButton({editor:e,title:n,className:"edui-for-inserttable",onpicktable:function(t,a,n){e.execCommand("InsertTable",{numRows:n,numCols:a,border:1})},onbuttonclick:function(){this.showPopup()}});return t.buttons.inserttable=o,e.addListener("selectionchange",function(){o.setDisabled(-1==e.queryCommandState("inserttable"))}),o},t.lineheight=function(e){var a=e.options.lineheight||[];if(a.length){for(var n,o=0,i=[];n=a[o++];)i.push({label:n,value:n,theme:e.options.theme,onclick:function(){e.execCommand("lineheight",this.value)}});var l=new t.MenuButton({editor:e,className:"edui-for-lineheight",title:e.options.labelMap.lineheight||e.getLang("labelMap.lineheight")||"",items:i,onbuttonclick:function(){var t=e.queryCommandValue("LineHeight")||this.value;e.execCommand("LineHeight",t)}});return t.buttons.lineheight=l,e.addListener("selectionchange",function(){var t=e.queryCommandState("LineHeight");if(-1==t)l.setDisabled(!0);else{l.setDisabled(!1);var a=e.queryCommandValue("LineHeight");a&&l.setValue((a+"").replace(/cm/,"")),l.setChecked(t)}}),l}};for(var u,d=["top","bottom"],m=0;u=d[m++];)!function(e){t["rowspacing"+e]=function(a){var n=a.options["rowspacing"+e]||[];if(!n.length)return null;for(var o,i=0,l=[];o=n[i++];)l.push({label:o,value:o,theme:a.options.theme,onclick:function(){a.execCommand("rowspacing",this.value,e)}});var s=new t.MenuButton({editor:a,className:"edui-for-rowspacing"+e,title:a.options.labelMap["rowspacing"+e]||a.getLang("labelMap.rowspacing"+e)||"",items:l,onbuttonclick:function(){var t=a.queryCommandValue("rowspacing",e)||this.value;a.execCommand("rowspacing",t,e)}});return t.buttons[e]=s,a.addListener("selectionchange",function(){var t=a.queryCommandState("rowspacing",e);if(-1==t)s.setDisabled(!0);else{s.setDisabled(!1);var n=a.queryCommandValue("rowspacing",e);n&&s.setValue((n+"").replace(/%/,"")),s.setChecked(t)}}),s}}(u);for(var p,f=["insertorderedlist","insertunorderedlist"],h=0;p=f[h++];)!function(e){t[e]=function(a){var n=a.options[e],o=function(){a.execCommand(e,this.value)},i=[];for(var l in n)i.push({label:n[l]||a.getLang()[e][l]||"",value:l,theme:a.options.theme,onclick:o});var s=new t.MenuButton({editor:a,className:"edui-for-"+e,title:a.getLang("labelMap."+e)||"",items:i,onbuttonclick:function(){var t=a.queryCommandValue(e)||this.value;a.execCommand(e,t)}});return t.buttons[e]=s,a.addListener("selectionchange",function(){var t=a.queryCommandState(e);if(-1==t)s.setDisabled(!0);else{s.setDisabled(!1);var n=a.queryCommandValue(e);s.setValue(n),s.setChecked(t)}}),s}}(p);t.fullscreen=function(e,a){a=e.options.labelMap.fullscreen||e.getLang("labelMap.fullscreen")||"";var n=new t.Button({className:"edui-for-fullscreen",title:a,theme:e.options.theme,onclick:function(){e.ui&&e.ui.setFullScreen(!e.ui.isFullScreen()),this.setChecked(e.ui.isFullScreen())}});return t.buttons.fullscreen=n,e.addListener("selectionchange",function(){var t=e.queryCommandState("fullscreen");n.setDisabled(-1==t),n.setChecked(e.ui.isFullScreen())}),n},t.emotion=function(e,a){var n="emotion",i=new t.MultiMenuPop({title:e.options.labelMap[n]||e.getLang("labelMap."+n)||"",editor:e,className:"edui-for-"+n,iframeUrl:e.ui.mapUrl(a||(e.options.iframeUrlMap||{})[n]||o[n])});return t.buttons[n]=i,e.addListener("selectionchange",function(){i.setDisabled(-1==e.queryCommandState(n))}),i},t.autotypeset=function(e){var a=new t.AutoTypeSetButton({editor:e,title:e.options.labelMap.autotypeset||e.getLang("labelMap.autotypeset")||"",className:"edui-for-autotypeset",onbuttonclick:function(){e.execCommand("autotypeset")}});return t.buttons.autotypeset=a,e.addListener("selectionchange",function(){a.setDisabled(-1==e.queryCommandState("autotypeset"))}),a},t.simpleupload=function(e){var a="simpleupload",n=new t.Button({className:"edui-for-"+a,title:e.options.labelMap[a]||e.getLang("labelMap."+a)||"",onclick:function(){},theme:e.options.theme,showText:!1});return t.buttons[a]=n,e.addListener("ready",function(){var t=n.getDom("body"),a=t.children[0];e.fireEvent("simpleuploadbtnready",a)}),e.addListener("selectionchange",function(t,o,i){var l=e.queryCommandState(a);-1==l?(n.setDisabled(!0),n.setChecked(!1)):i||(n.setDisabled(!1),n.setChecked(l))}),n}}();
!function(){function e(e){this.initOptions(e),this.initEditorUI()}var t=baidu.editor.utils,i=baidu.editor.ui.uiUtils,o=baidu.editor.ui.UIBase,n=baidu.editor.dom.domUtils,a=[];e.prototype={uiName:"editor",initEditorUI:function(){function e(e,t){e.setOpt({wordCount:!0,maximumWords:1e4,wordCountMsg:e.options.wordCountMsg||e.getLang("wordCountMsg"),wordOverFlowMsg:e.options.wordOverFlowMsg||e.getLang("wordOverFlowMsg")});var i=e.options,o=i.maximumWords,n=i.wordCountMsg,a=i.wordOverFlowMsg,s=t.getDom("wordcount");if(i.wordCount){var l=e.getContentLength(!0);l>o?(s.innerHTML=a,e.fireEvent("wordcountoverflow")):s.innerHTML=n.replace("{#leave}",o-l).replace("{#count}",l)}}this.editor.ui=this,this._dialogs={},this.initUIBase(),this._initToolbars();var t=this.editor,i=this;t.addListener("ready",function(){function o(){e(t,i),n.un(t.document,"click",arguments.callee)}t.getDialog=function(e){return t.ui._dialogs[e+"Dialog"]},n.on(t.window,"scroll",function(e){baidu.editor.ui.Popup.postHide(e)}),t.ui._actualFrameWidth=t.options.initialFrameWidth,UE.browser.ie&&6===UE.browser.version&&t.container.ownerDocument.execCommand("BackgroundImageCache",!1,!0),t.options.elementPathEnabled&&(t.ui.getDom("elementpath").innerHTML='<div class="edui-editor-breadcrumb">'+t.getLang("elementPathTip")+":</div>"),t.options.wordCount&&(n.on(t.document,"click",o),t.ui.getDom("wordcount").innerHTML=t.getLang("wordCountTip")),t.ui._scale(),t.options.scaleEnabled?(t.autoHeightEnabled&&t.disableAutoHeight(),i.enableScale()):i.disableScale(),t.options.elementPathEnabled||t.options.wordCount||t.options.scaleEnabled||(t.ui.getDom("elementpath").style.display="none",t.ui.getDom("wordcount").style.display="none",t.ui.getDom("scale").style.display="none"),t.selection.isFocus()&&t.fireEvent("selectionchange",!1,!0)}),t.addListener("mousedown",function(e,t){var i=t.target||t.srcElement;baidu.editor.ui.Popup.postHide(t,i),baidu.editor.ui.ShortCutMenu.postHide(t)}),t.addListener("delcells",function(){UE.ui.edittip&&new UE.ui.edittip(t),t.getDialog("edittip").open()});var o,a,s=!1;t.addListener("afterpaste",function(){t.queryCommandState("pasteplain")||(baidu.editor.ui.PastePicker&&(o=new baidu.editor.ui.Popup({content:new baidu.editor.ui.PastePicker({editor:t}),editor:t,className:"edui-wordpastepop"}),o.render()),s=!0)}),t.addListener("afterinserthtml",function(){clearTimeout(a),a=setTimeout(function(){if(o&&(s||t.ui._isTransfer)){if(o.isHidden()){var e=n.createElement(t.document,"span",{style:"line-height:0px;",innerHTML:"\ufeff"}),i=t.selection.getRange();i.insertNode(e);var a=getDomNode(e,"firstChild","previousSibling");a&&o.showAnchor(3==a.nodeType?a.parentNode:a),n.remove(e)}else o.show();delete t.ui._isTransfer,s=!1}},200)}),t.addListener("contextmenu",function(e,t){baidu.editor.ui.Popup.postHide(t)}),t.addListener("keydown",function(e,t){o&&o.dispose(t);var i=t.keyCode||t.which;t.altKey&&90==i&&UE.ui.buttons.fullscreen.onclick()}),t.addListener("wordcount",function(t){e(this,i)}),t.addListener("selectionchange",function(){t.options.elementPathEnabled&&i[(-1==t.queryCommandState("elementpath")?"dis":"en")+"ableElementPath"](),t.options.scaleEnabled&&i[(-1==t.queryCommandState("scale")?"dis":"en")+"ableScale"]()});var l=new baidu.editor.ui.Popup({editor:t,content:"",className:"edui-bubble",_onEditButtonClick:function(){this.hide(),t.ui._dialogs.linkDialog.open()},_onImgEditButtonClick:function(e){this.hide(),t.ui._dialogs[e]&&t.ui._dialogs[e].open()},_onImgSetFloat:function(e){this.hide(),t.execCommand("imagefloat",e)},_setIframeAlign:function(e){var t=l.anchorEl,i=t.cloneNode(!0);switch(e){case-2:i.setAttribute("align","");break;case-1:i.setAttribute("align","left");break;case 1:i.setAttribute("align","right")}t.parentNode.insertBefore(i,t),n.remove(t),l.anchorEl=i,l.showAnchor(l.anchorEl)},_updateIframe:function(){var e=t._iframe=l.anchorEl;n.hasClass(e,"ueditor_baidumap")?(t.selection.getRange().selectNode(e).select(),t.ui._dialogs.mapDialog.open(),l.hide()):(t.ui._dialogs.insertframeDialog.open(),l.hide())},_onRemoveButtonClick:function(e){t.execCommand(e),this.hide()},queryAutoHide:function(e){return e&&e.ownerDocument==t.document&&("img"==e.tagName.toLowerCase()||n.findParentByTagName(e,"a",!0))?e!==l.anchorEl:baidu.editor.ui.Popup.prototype.queryAutoHide.call(this,e)}});l.render(),t.options.imagePopup&&(t.addListener("mouseover",function(e,i){i=i||window.event;var o=i.target||i.srcElement;if(t.ui._dialogs.insertframeDialog&&/iframe/gi.test(o.tagName)){var n=l.formatHtml("<nobr>"+t.getLang("property")+': <span onclick=$$._setIframeAlign(-2) class="edui-clickable">'+t.getLang("default")+'</span>&nbsp;&nbsp;<span onclick=$$._setIframeAlign(-1) class="edui-clickable">'+t.getLang("justifyleft")+'</span>&nbsp;&nbsp;<span onclick=$$._setIframeAlign(1) class="edui-clickable">'+t.getLang("justifyright")+'</span>&nbsp;&nbsp; <span onclick="$$._updateIframe( this);" class="edui-clickable">'+t.getLang("modify")+"</span></nobr>");n?(l.getDom("content").innerHTML=n,l.anchorEl=o,l.showAnchor(l.anchorEl)):l.hide()}}),t.addListener("selectionchange",function(e,i){if(i){var o="",a="",s=t.selection.getRange().getClosedNode(),r=t.ui._dialogs;if(s&&"IMG"==s.tagName){var d="insertimageDialog";if((-1!=s.className.indexOf("edui-faked-video")||-1!=s.className.indexOf("edui-upload-video"))&&(d="insertvideoDialog"),-1!=s.className.indexOf("edui-faked-webapp")&&(d="webappDialog"),-1!=s.src.indexOf("http://api.map.baidu.com")&&(d="mapDialog"),-1!=s.className.indexOf("edui-faked-music")&&(d="musicDialog"),-1!=s.src.indexOf("http://maps.google.com/maps/api/staticmap")&&(d="gmapDialog"),s.getAttribute("anchorname")&&(d="anchorDialog",o=l.formatHtml("<nobr>"+t.getLang("property")+': <span onclick=$$._onImgEditButtonClick("anchorDialog") class="edui-clickable">'+t.getLang("modify")+"</span>&nbsp;&nbsp;<span onclick=$$._onRemoveButtonClick('anchor') class=\"edui-clickable\">"+t.getLang("delete")+"</span></nobr>")),s.getAttribute("word_img")&&(t.word_img=[s.getAttribute("word_img")],d="wordimageDialog"),(n.hasClass(s,"loadingclass")||n.hasClass(s,"loaderrorclass"))&&(d=""),!r[d])return;a="<nobr>"+t.getLang("property")+': <span onclick=$$._onImgSetFloat("none") class="edui-clickable">'+t.getLang("default")+'</span>&nbsp;&nbsp;<span onclick=$$._onImgSetFloat("left") class="edui-clickable">'+t.getLang("justifyleft")+'</span>&nbsp;&nbsp;<span onclick=$$._onImgSetFloat("right") class="edui-clickable">'+t.getLang("justifyright")+'</span>&nbsp;&nbsp;<span onclick=$$._onImgSetFloat("center") class="edui-clickable">'+t.getLang("justifycenter")+"</span>&nbsp;&nbsp;<span onclick=\"$$._onImgEditButtonClick('"+d+'\');" class="edui-clickable">'+t.getLang("modify")+"</span></nobr>",!o&&(o=l.formatHtml(a))}if(t.ui._dialogs.linkDialog){var c,u=t.queryCommandValue("link");if(u&&(c=u.getAttribute("_href")||u.getAttribute("href",2))){var m=c;c.length>30&&(m=c.substring(0,20)+"..."),o&&(o+='<div style="height:5px;"></div>'),o+=l.formatHtml("<nobr>"+t.getLang("anthorMsg")+': <a target="_blank" href="'+c+'" title="'+c+'" >'+m+'</a> <span class="edui-clickable" onclick="$$._onEditButtonClick();">'+t.getLang("modify")+'</span> <span class="edui-clickable" onclick="$$._onRemoveButtonClick(\'unlink\');"> '+t.getLang("clear")+"</span></nobr>"),l.showAnchor(u)}}o?(l.getDom("content").innerHTML=o,l.anchorEl=s||u,l.showAnchor(l.anchorEl)):l.hide()}}))},_initToolbars:function(){for(var e=this.editor,i=this.toolbars||[],o=[],n=0;n<i.length;n++){for(var a=i[n],s=new baidu.editor.ui.Toolbar({theme:e.options.theme}),l=0;l<a.length;l++){var r=a[l],d=null;if("string"==typeof r){if(r=r.toLowerCase(),"|"==r&&(r="Separator"),"||"==r&&(r="Breakline"),baidu.editor.ui[r]&&(d=new baidu.editor.ui[r](e)),"fullscreen"==r){o&&o[0]?o[0].items.splice(0,0,d):d&&s.items.splice(0,0,d);continue}}else d=r;d&&d.id&&s.add(d)}o[n]=s}t.each(UE._customizeUI,function(t,i){var o,n;return t.id&&t.id!=e.key?!1:(o=t.execFn.call(e,e,i),void(o&&(n=t.index,void 0===n&&(n=s.items.length),s.add(o,n))))}),this.toolbars=o},getHtmlTpl:function(){return'<div id="##" class="%%"><div id="##_toolbarbox" class="%%-toolbarbox">'+(this.toolbars.length?'<div id="##_toolbarboxouter" class="%%-toolbarboxouter"><div class="%%-toolbarboxinner">'+this.renderToolbarBoxHtml()+"</div></div>":"")+'<div id="##_toolbarmsg" class="%%-toolbarmsg" style="display:none;"><div id = "##_upload_dialog" class="%%-toolbarmsg-upload" onclick="$$.showWordImageDialog();">'+this.editor.getLang("clickToUpload")+'</div><div class="%%-toolbarmsg-close" onclick="$$.hideToolbarMsg();">x</div><div id="##_toolbarmsg_label" class="%%-toolbarmsg-label"></div><div style="height:0;overflow:hidden;clear:both;"></div></div><div id="##_message_holder" class="%%-messageholder"></div></div><div id="##_iframeholder" class="%%-iframeholder"></div><div id="##_bottombar" class="%%-bottomContainer"><table><tr><td id="##_elementpath" class="%%-bottombar"></td><td id="##_wordcount" class="%%-wordcount"></td><td id="##_scale" class="%%-scale"><div class="%%-icon"></div></td></tr></table></div><div id="##_scalelayer"></div></div>'},showWordImageDialog:function(){this._dialogs.wordimageDialog.open()},renderToolbarBoxHtml:function(){for(var e=[],t=0;t<this.toolbars.length;t++)e.push(this.toolbars[t].renderHtml());return e.join("")},setFullScreen:function(e){var t=this.editor,i=t.container.parentNode.parentNode;if(this._fullscreen!=e){if(this._fullscreen=e,this.editor.fireEvent("beforefullscreenchange",e),baidu.editor.browser.gecko)var o=t.selection.getRange().createBookmark();if(e){for(;"BODY"!=i.tagName;){var n=baidu.editor.dom.domUtils.getComputedStyle(i,"position");a.push(n),i.style.position="static",i=i.parentNode}this._bakHtmlOverflow=document.documentElement.style.overflow,this._bakBodyOverflow=document.body.style.overflow,this._bakAutoHeight=this.editor.autoHeightEnabled,this._bakScrollTop=Math.max(document.documentElement.scrollTop,document.body.scrollTop),this._bakEditorContaninerWidth=t.iframe.parentNode.offsetWidth,this._bakAutoHeight&&(t.autoHeightEnabled=!1,this.editor.disableAutoHeight()),document.documentElement.style.overflow="hidden",window.scrollTo(0,window.scrollY),this._bakCssText=this.getDom().style.cssText,this._bakCssText1=this.getDom("iframeholder").style.cssText,t.iframe.parentNode.style.width="",this._updateFullScreen()}else{for(;"BODY"!=i.tagName;)i.style.position=a.shift(),i=i.parentNode;this.getDom().style.cssText=this._bakCssText,this.getDom("iframeholder").style.cssText=this._bakCssText1,this._bakAutoHeight&&(t.autoHeightEnabled=!0,this.editor.enableAutoHeight()),document.documentElement.style.overflow=this._bakHtmlOverflow,document.body.style.overflow=this._bakBodyOverflow,t.iframe.parentNode.style.width=this._bakEditorContaninerWidth+"px",window.scrollTo(0,this._bakScrollTop)}if(browser.gecko&&"true"===t.body.contentEditable){var s=document.createElement("input");document.body.appendChild(s),t.body.contentEditable=!1,setTimeout(function(){s.focus(),setTimeout(function(){t.body.contentEditable=!0,t.fireEvent("fullscreenchanged",e),t.selection.getRange().moveToBookmark(o).select(!0),baidu.editor.dom.domUtils.remove(s),e&&window.scroll(0,0)},0)},0)}"true"===t.body.contentEditable&&(this.editor.fireEvent("fullscreenchanged",e),this.triggerLayout())}},_updateFullScreen:function(){if(this._fullscreen){var e=i.getViewportRect();if(this.getDom().style.cssText="border:0;position:absolute;left:0;top:"+(this.editor.options.topOffset||0)+"px;width:"+e.width+"px;height:"+e.height+"px;z-index:"+(1*this.getDom().style.zIndex+100),i.setViewportOffset(this.getDom(),{left:0,top:this.editor.options.topOffset||0}),this.editor.setHeight(e.height-this.getDom("toolbarbox").offsetHeight-this.getDom("bottombar").offsetHeight-(this.editor.options.topOffset||0),!0),browser.gecko)try{window.onresize()}catch(t){}}},_updateElementPath:function(){var e,t=this.getDom("elementpath");if(this.elementPathEnabled&&(e=this.editor.queryCommandValue("elementpath"))){for(var i,o=[],n=0;i=e[n];n++)o[n]=this.formatHtml('<span unselectable="on" onclick="$$.editor.execCommand(&quot;elementpath&quot;, &quot;'+n+'&quot;);">'+i+"</span>");t.innerHTML='<div class="edui-editor-breadcrumb" onmousedown="return false;">'+this.editor.getLang("elementPathTip")+": "+o.join(" &gt; ")+"</div>"}else t.style.display="none"},disableElementPath:function(){var e=this.getDom("elementpath");e.innerHTML="",e.style.display="none",this.elementPathEnabled=!1},enableElementPath:function(){var e=this.getDom("elementpath");e.style.display="",this.elementPathEnabled=!0,this._updateElementPath()},_scale:function(){function e(){g=n.getXY(l),p||(p=s.options.minFrameHeight+d.offsetHeight+c.offsetHeight),m.style.cssText="position:absolute;left:0;display:;top:0;background-color:#41ABFF;opacity:0.4;filter: Alpha(opacity=40);width:"+l.offsetWidth+"px;height:"+l.offsetHeight+"px;z-index:"+(s.options.zIndex+1),n.on(a,"mousemove",t),n.on(r,"mouseup",i),n.on(a,"mouseup",i)}function t(e){o();var t=e||window.event;b=t.pageX||a.documentElement.scrollLeft+t.clientX,y=t.pageY||a.documentElement.scrollTop+t.clientY,v=b-g.x,w=y-g.y,v>=f&&(h=!0,m.style.width=v+"px"),w>=p&&(h=!0,m.style.height=w+"px")}function i(){h&&(h=!1,s.ui._actualFrameWidth=m.offsetWidth-2,l.style.width=s.ui._actualFrameWidth+"px",s.setHeight(m.offsetHeight-c.offsetHeight-d.offsetHeight-2,!0)),m&&(m.style.display="none"),o(),n.un(a,"mousemove",t),n.un(r,"mouseup",i),n.un(a,"mouseup",i)}function o(){browser.ie?a.selection.clear():window.getSelection().removeAllRanges()}var a=document,s=this.editor,l=s.container,r=s.document,d=this.getDom("toolbarbox"),c=this.getDom("bottombar"),u=this.getDom("scale"),m=this.getDom("scalelayer"),h=!1,g=null,p=0,f=s.options.minFrameWidth,b=0,y=0,v=0,w=0,_=this;this.editor.addListener("fullscreenchanged",function(e,t){if(t)_.disableScale();else if(_.editor.options.scaleEnabled){_.enableScale();var i=_.editor.document.createElement("span");_.editor.body.appendChild(i),_.editor.body.style.height=Math.max(n.getXY(i).y,_.editor.iframe.offsetHeight-20)+"px",n.remove(i)}}),this.enableScale=function(){1!=s.queryCommandState("source")&&(u.style.display="",this.scaleEnabled=!0,n.on(u,"mousedown",e))},this.disableScale=function(){u.style.display="none",this.scaleEnabled=!1,n.un(u,"mousedown",e)}},isFullScreen:function(){return this._fullscreen},postRender:function(){o.prototype.postRender.call(this);for(var e=0;e<this.toolbars.length;e++)this.toolbars[e].postRender();var t,i=this,n=baidu.editor.dom.domUtils,a=function(){clearTimeout(t),t=setTimeout(function(){i._updateFullScreen()})};n.on(window,"resize",a),i.addListener("destroy",function(){n.un(window,"resize",a),clearTimeout(t)})},showToolbarMsg:function(e,t){if(this.getDom("toolbarmsg_label").innerHTML=e,this.getDom("toolbarmsg").style.display="",!t){var i=this.getDom("upload_dialog");i.style.display="none"}},hideToolbarMsg:function(){this.getDom("toolbarmsg").style.display="none"},mapUrl:function(e){return e?e.replace("~/",this.editor.options.UEDITOR_HOME_URL||""):""},triggerLayout:function(){var e=this.getDom();e.style.zoom="1"==e.style.zoom?"100%":"1"}},t.inherits(e,baidu.editor.ui.UIBase);var s={};UE.ui.Editor=function(i){var o=new UE.Editor(i);o.options.editor=o,t.loadFile(document,{href:o.options.themePath+o.options.theme+"/_css/ueditor.css",tag:"link",type:"text/css",rel:"stylesheet"});var a=o.render;return o.render=function(i){i.constructor===String&&(o.key=i,s[i]=o),t.domReady(function(){function t(){if(o.setOpt({labelMap:o.options.labelMap||o.getLang("labelMap")}),new e(o.options),i&&(i.constructor===String&&(i=document.getElementById(i)),i&&i.getAttribute("name")&&(o.options.textarea=i.getAttribute("name")),i&&/script|textarea/gi.test(i.tagName))){var t=document.createElement("div");i.parentNode.insertBefore(t,i);var s=i.value||i.innerHTML;o.options.initialContent=/^[\t\r\n ]*$/.test(s)?o.options.initialContent:s.replace(/>[\n\r\t]+([ ]{4})+/g,">").replace(/[\n\r\t]+([ ]{4})+</g,"<").replace(/>[\n\r\t]+</g,"><"),i.className&&(t.className=i.className),i.style.cssText&&(t.style.cssText=i.style.cssText),/textarea/i.test(i.tagName)?(o.textarea=i,o.textarea.style.display="none"):i.parentNode.removeChild(i),i.id&&(t.id=i.id,n.removeAttributes(i,"id")),i=t,i.innerHTML=""}n.addClass(i,"edui-"+o.options.theme),o.ui.render(i);var l=o.options;o.container=o.ui.getDom();for(var r,d=n.findParents(i,!0),c=[],u=0;r=d[u];u++)c[u]=r.style.display,r.style.display="block";if(l.initialFrameWidth)l.minFrameWidth=l.initialFrameWidth;else{l.minFrameWidth=l.initialFrameWidth=i.offsetWidth;var m=i.style.width;/%$/.test(m)&&(l.initialFrameWidth=m)}l.initialFrameHeight?l.minFrameHeight=l.initialFrameHeight:l.initialFrameHeight=l.minFrameHeight=i.offsetHeight;for(var r,u=0;r=d[u];u++)r.style.display=c[u];i.style.height&&(i.style.height=""),o.container.style.width=l.initialFrameWidth+(/%$/.test(l.initialFrameWidth)?"":"px"),o.container.style.zIndex=l.zIndex,a.call(o,o.ui.getDom("iframeholder")),o.fireEvent("afteruiready")}o.langIsReady?t():o.addListener("langReady",t)})},o},UE.getEditor=function(e,t){var i=s[e];return i||(i=s[e]=new UE.ui.Editor(t),i.render(e)),i},UE.delEditor=function(e){var t;(t=s[e])&&(t.key&&t.destroy(),delete s[e])},UE.registerUI=function(e,i,o,n){t.each(e.split(/\s+/),function(e){UE._customizeUI[e]={id:n,execFn:i,index:o}})}}();
UE.registerUI("message",function(e){function t(){var e=r.ui.getDom("toolbarbox");e&&(n.style.top=e.offsetHeight+3+"px"),n.style.zIndex=Math.max(r.options.zIndex,r.iframe.style.zIndex)+1}var n,i=baidu.editor.ui,s=i.Message,o=[],r=e;r.addListener("ready",function(){n=document.getElementById(r.ui.id+"_message_holder"),t(),setTimeout(function(){t()},500)}),r.addListener("showmessage",function(e,i){i=utils.isString(i)?{content:i}:i;var d=new s({timeout:i.timeout,type:i.type,content:i.content,keepshow:i.keepshow,editor:r}),a=i.id||"msg_"+(+new Date).toString(36);return d.render(n),o[a]=d,d.reset(i),t(),a}),r.addListener("updatemessage",function(e,t,i){i=utils.isString(i)?{content:i}:i;var s=o[t];s.render(n),s&&s.reset(i)}),r.addListener("hidemessage",function(e,t){var n=o[t];n&&n.hide()})});
UE.registerUI("autosave",function(e){var t=null,s=null;e.on("afterautosave",function(){clearTimeout(t),t=setTimeout(function(){s&&e.trigger("hidemessage",s),s=e.trigger("showmessage",{content:e.getLang("autosave.success"),timeout:2e3})},2e3)})});